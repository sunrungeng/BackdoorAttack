current path: saved_models/model_mnist_Feb.17_15.47.28
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43, 46, 37, 21, 35, 61, 64, 28, 67, 22, 82].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0240, Accuracy: 353/606 (58.2508%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0115, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0065, Accuracy: 540/606 (89.1089%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0040, Accuracy: 551/606 (90.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0035, Accuracy: 563/606 (92.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0028, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0027, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0024, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0026, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0019, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.86615527034883. Distance: 4.736987913129581
Total norm for 4 adversaries is: 16.86615527034883. distance: 4.736987913129581
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0511, Accuracy: 8822/8968 (98.3720%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0220, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0125, Accuracy: 383/591 (64.8054%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0048, Accuracy: 528/591 (89.3401%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0036, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0031, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0022, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0019, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0014, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0013, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0014, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.826522708363665. Distance: 4.157871245636171
Total norm for 4 adversaries is: 16.826522708363665. distance: 4.157871245636171
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0661, Accuracy: 8746/8968 (97.5245%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0226, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0097, Accuracy: 460/568 (80.9859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0053, Accuracy: 509/568 (89.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0048, Accuracy: 509/568 (89.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0038, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0036, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0030, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0023, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0021, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0023, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.74675571280291. Distance: 4.406835638857023
Total norm for 4 adversaries is: 16.74675571280291. distance: 4.406835638857023
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0507, Accuracy: 8813/8968 (98.2716%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0234, Accuracy: 321/557 (57.6302%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0105, Accuracy: 417/557 (74.8654%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0049, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0040, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0032, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0031, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0026, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.78991407362198. Distance: 4.071922525639402
Total norm for 4 adversaries is: 16.78991407362198. distance: 4.071922525639402
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1010, Accuracy: 8567/8968 (95.5285%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1451, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0020, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0878, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0021, Accuracy: 856/889 (96.2880%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1288, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 632/645 (97.9845%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2495, Accuracy: 9193/10000 (91.9300%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0014, Accuracy: 664/686 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1555, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.7507, Accuracy: 8522/10000 (85.2200%)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0020, Accuracy: 680/710 (95.7746%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5128, Accuracy: 8358/10000 (83.5800%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 837/860 (97.3256%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1592, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 302/312 (96.7949%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2513, Accuracy: 9241/10000 (92.4100%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2571, Accuracy: 9236/10000 (92.3600%)
___Train Local_Simple,  epoch  11, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 679/699 (97.1388%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5908, Accuracy: 8573/10000 (85.7300%)
___Train Local_Simple,  epoch  11, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 782/813 (96.1870%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4025, Accuracy: 8529/10000 (85.2900%)
___Train Local_Simple,  epoch  11, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 485/501 (96.8064%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1165, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  11, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 960/998 (96.1924%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2075, Accuracy: 9364/10000 (93.6400%)
___Train Local_Simple,  epoch  11, local model 22, internal_epoch   1,  Average loss: 0.0018, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2773, Accuracy: 9148/10000 (91.4800%)
___Train Local_Simple,  epoch  11, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 697/713 (97.7560%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4680, Accuracy: 8460/10000 (84.6000%)
time spent on training: 347.286208152771
[rfa agg] training data poison_ratio: 0.19335498376217836  data num: [606, 591, 568, 557, 293, 78, 889, 645, 686, 408, 710, 860, 312, 499, 699, 813, 501, 998, 583, 713]
[rfa agg] considering poison per batch poison_fraction: 0.06042343242568074
[rfa agg] init. name: [41, 73, 51, 74, 23, 76, 63, 11, 75, 43, 46, 37, 21, 35, 61, 64, 28, 67, 22, 82], weight: tensor([0.0505, 0.0492, 0.0473, 0.0464, 0.0244, 0.0065, 0.0740, 0.0537, 0.0571,
        0.0340, 0.0591, 0.0716, 0.0260, 0.0416, 0.0582, 0.0677, 0.0417, 0.0831,
        0.0485, 0.0594])
[rfa agg] iter:  0, prev_obj_val: 1.6443300247192383, obj_val: 1.553789496421814, abs dis: 0.09054052829742432
[rfa agg] iter:  0, weight: tensor([0.0155, 0.0176, 0.0160, 0.0168, 0.0353, 0.0106, 0.0787, 0.0579, 0.0657,
        0.0441, 0.0595, 0.0852, 0.0361, 0.0568, 0.0658, 0.0705, 0.0585, 0.0815,
        0.0592, 0.0687])
[rfa agg] iter:  1, prev_obj_val: 1.553789496421814, obj_val: 1.5518838167190552, abs dis: 0.001905679702758789
[rfa agg] iter:  1, weight: tensor([0.0119, 0.0133, 0.0121, 0.0127, 0.0460, 0.0149, 0.0741, 0.0574, 0.0676,
        0.0490, 0.0549, 0.0811, 0.0434, 0.0637, 0.0644, 0.0655, 0.0645, 0.0748,
        0.0596, 0.0693])
[rfa agg] iter:  2, prev_obj_val: 1.5518838167190552, obj_val: 1.5518555641174316, abs dis: 2.8252601623535156e-05
[rfa agg] iter:  2, weight: tensor([0.0115, 0.0129, 0.0117, 0.0124, 0.0486, 0.0159, 0.0728, 0.0573, 0.0679,
        0.0499, 0.0540, 0.0798, 0.0448, 0.0650, 0.0638, 0.0644, 0.0655, 0.0732,
        0.0595, 0.0691])
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0810, Accuracy: 9756/10000 (97.5600%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 9.3711, Accuracy: 37/8968 (0.4126%)
saving model
Done in 362.57043623924255 sec.
Server Epoch:12 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63, 77, 18, 43, 91, 52, 28, 37, 96, 99, 80].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0223, Accuracy: 350/606 (57.7558%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0094, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0038, Accuracy: 549/606 (90.5941%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0028, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0020, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0018, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0016, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0016, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0014, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Global model norm: 16.48267819317971.
Norm before scaling: 16.77823002242927. Distance: 4.061086555496012
Total norm for 4 adversaries is: 16.77823002242927. distance: 4.061086555496012
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0474, Accuracy: 8807/8968 (98.2047%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0244, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0165, Accuracy: 317/591 (53.6379%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0067, Accuracy: 518/591 (87.6481%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0053, Accuracy: 517/591 (87.4788%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0043, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0032, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0030, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0023, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0024, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Global model norm: 16.48267819317971.
Norm before scaling: 16.789334244834297. Distance: 4.178706030721296
Total norm for 4 adversaries is: 16.789334244834297. distance: 4.178706030721296
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0423, Accuracy: 8828/8968 (98.4389%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0167, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0071, Accuracy: 483/568 (85.0352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.48267819317971.
Norm before scaling: 16.69832828400702. Distance: 3.4370151524635677
Total norm for 4 adversaries is: 16.69832828400702. distance: 3.4370151524635677
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0704, Accuracy: 8716/8968 (97.1900%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0217, Accuracy: 321/557 (57.6302%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0084, Accuracy: 447/557 (80.2513%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0035, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.48267819317971.
Norm before scaling: 16.694960623046647. Distance: 3.7494507705299243
Total norm for 4 adversaries is: 16.694960623046647. distance: 3.7494507705299243
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0559, Accuracy: 8756/8968 (97.6360%)
___Train Local_Simple,  epoch  12, local model 60, internal_epoch   1,  Average loss: 0.0019, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1287, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0014, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0911, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch  12, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1652, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch  12, local model 56, internal_epoch   1,  Average loss: 0.0013, Accuracy: 865/880 (98.2955%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1701, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch  12, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1673, Accuracy: 9471/10000 (94.7100%)
___Train Local_Simple,  epoch  12, local model 63, internal_epoch   1,  Average loss: 0.0017, Accuracy: 857/889 (96.4004%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0986, Accuracy: 9716/10000 (97.1600%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 571/589 (96.9440%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0820, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch  12, local model 18, internal_epoch   1,  Average loss: 0.0020, Accuracy: 444/459 (96.7320%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3374, Accuracy: 8889/10000 (88.8900%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1327, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch  12, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0929, Accuracy: 9728/10000 (97.2800%)
___Train Local_Simple,  epoch  12, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1173, Accuracy: 9635/10000 (96.3500%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 489/501 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0929, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 836/860 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2790, Accuracy: 9233/10000 (92.3300%)
___Train Local_Simple,  epoch  12, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 658/672 (97.9167%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1753, Accuracy: 9473/10000 (94.7300%)
___Train Local_Simple,  epoch  12, local model 99, internal_epoch   1,  Average loss: 0.0010, Accuracy: 371/377 (98.4085%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1062, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  12, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1576, Accuracy: 9534/10000 (95.3400%)
time spent on training: 320.48499155044556
[rfa agg] training data poison_ratio: 0.22664714494875549  data num: [606, 591, 568, 557, 338, 236, 431, 880, 343, 889, 589, 459, 408, 256, 253, 501, 860, 672, 377, 431]
[rfa agg] considering poison per batch poison_fraction: 0.07082723279648609
[rfa agg] init. name: [41, 73, 51, 74, 60, 42, 85, 56, 57, 63, 77, 18, 43, 91, 52, 28, 37, 96, 99, 80], weight: tensor([0.0592, 0.0577, 0.0554, 0.0544, 0.0330, 0.0230, 0.0421, 0.0859, 0.0335,
        0.0868, 0.0575, 0.0448, 0.0398, 0.0250, 0.0247, 0.0489, 0.0839, 0.0656,
        0.0368, 0.0421])
[rfa agg] iter:  0, prev_obj_val: 1.4966636896133423, obj_val: 1.366435170173645, abs dis: 0.13022851943969727
[rfa agg] iter:  0, weight: tensor([0.0181, 0.0171, 0.0205, 0.0180, 0.0449, 0.0333, 0.0553, 0.0817, 0.0453,
        0.0893, 0.0647, 0.0497, 0.0541, 0.0384, 0.0371, 0.0649, 0.0834, 0.0741,
        0.0527, 0.0573])
[rfa agg] iter:  1, prev_obj_val: 1.366435170173645, obj_val: 1.3605873584747314, abs dis: 0.005847811698913574
[rfa agg] iter:  1, weight: tensor([0.0114, 0.0108, 0.0128, 0.0114, 0.0456, 0.0429, 0.0637, 0.0680, 0.0465,
        0.0776, 0.0617, 0.0458, 0.0606, 0.0537, 0.0477, 0.0741, 0.0665, 0.0700,
        0.0656, 0.0637])
[rfa agg] iter:  2, prev_obj_val: 1.3605873584747314, obj_val: 1.3604201078414917, abs dis: 0.0001672506332397461
[rfa agg] iter:  2, weight: tensor([0.0105, 0.0100, 0.0117, 0.0105, 0.0446, 0.0459, 0.0658, 0.0640, 0.0455,
        0.0736, 0.0601, 0.0443, 0.0619, 0.0594, 0.0511, 0.0762, 0.0615, 0.0683,
        0.0695, 0.0655])
[rfa agg] iter:  3, prev_obj_val: 1.3604201078414917, obj_val: 1.360414981842041, abs dis: 5.125999450683594e-06
[rfa agg] iter:  3, weight: tensor([0.0104, 0.0099, 0.0116, 0.0104, 0.0444, 0.0465, 0.0660, 0.0632, 0.0452,
        0.0727, 0.0597, 0.0440, 0.0621, 0.0606, 0.0520, 0.0765, 0.0605, 0.0679,
        0.0703, 0.0659])
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0768, Accuracy: 9765/10000 (97.6500%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 9.0112, Accuracy: 39/8968 (0.4349%)
saving model
Done in 335.11584520339966 sec.
Server Epoch:13 choose agents : [41, 73, 51, 74, 13, 98, 78, 46, 45, 62, 50, 67, 14, 36, 24, 7, 4, 80, 39, 26].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0207, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0071, Accuracy: 502/606 (82.8383%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0038, Accuracy: 560/606 (92.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0030, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0025, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0024, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0024, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0023, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0020, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0025, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Global model norm: 16.471765578689396.
Norm before scaling: 16.712350008968386. Distance: 3.9332090945477467
Total norm for 4 adversaries is: 16.712350008968386. distance: 3.9332090945477467
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0278, Accuracy: 8892/8968 (99.1525%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0225, Accuracy: 373/591 (63.1134%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0135, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0052, Accuracy: 530/591 (89.6785%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0039, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0039, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0029, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0024, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0021, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0018, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0018, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Global model norm: 16.471765578689396.
Norm before scaling: 16.825399108959683. Distance: 4.260260593879063
Total norm for 4 adversaries is: 16.825399108959683. distance: 4.260260593879063
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0197, Accuracy: 8907/8968 (99.3198%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0171, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0050, Accuracy: 520/568 (91.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0017, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.471765578689396.
Norm before scaling: 16.729087414520144. Distance: 3.530435924035544
Total norm for 4 adversaries is: 16.729087414520144. distance: 3.530435924035544
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0697, Accuracy: 8703/8968 (97.0450%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0192, Accuracy: 344/557 (61.7594%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0082, Accuracy: 446/557 (80.0718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.471765578689396.
Norm before scaling: 16.69950886078409. Distance: 3.5648587098017797
Total norm for 4 adversaries is: 16.69950886078409. distance: 3.5648587098017797
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0299, Accuracy: 8870/8968 (98.9072%)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 719/734 (97.9564%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1778, Accuracy: 9451/10000 (94.5100%)
___Train Local_Simple,  epoch  13, local model 98, internal_epoch   1,  Average loss: 0.0013, Accuracy: 793/818 (96.9438%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4470, Accuracy: 8558/10000 (85.5800%)
___Train Local_Simple,  epoch  13, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1247, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  13, local model 46, internal_epoch   1,  Average loss: 0.0018, Accuracy: 687/710 (96.7606%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2495, Accuracy: 9186/10000 (91.8600%)
___Train Local_Simple,  epoch  13, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 612/628 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2765, Accuracy: 9043/10000 (90.4300%)
___Train Local_Simple,  epoch  13, local model 62, internal_epoch   1,  Average loss: 0.0010, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1181, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1449, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 978/998 (97.9960%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2977, Accuracy: 9053/10000 (90.5300%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1336, Accuracy: 9603/10000 (96.0300%)
___Train Local_Simple,  epoch  13, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 985/1005 (98.0100%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1940, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1102, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 406/418 (97.1292%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1301, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 643/658 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2364, Accuracy: 9201/10000 (92.0100%)
___Train Local_Simple,  epoch  13, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1401, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  13, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.0935, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  13, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 540/554 (97.4729%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1201, Accuracy: 9620/10000 (96.2000%)
time spent on training: 320.98258805274963
[rfa agg] training data poison_ratio: 0.20212395543175488  data num: [606, 591, 568, 557, 734, 818, 303, 710, 628, 423, 474, 998, 376, 1005, 379, 418, 658, 431, 257, 554]
[rfa agg] considering poison per batch poison_fraction: 0.0631637360724234
[rfa agg] init. name: [41, 73, 51, 74, 13, 98, 78, 46, 45, 62, 50, 67, 14, 36, 24, 7, 4, 80, 39, 26], weight: tensor([0.0528, 0.0514, 0.0494, 0.0485, 0.0639, 0.0712, 0.0264, 0.0618, 0.0547,
        0.0368, 0.0413, 0.0869, 0.0327, 0.0875, 0.0330, 0.0364, 0.0573, 0.0375,
        0.0224, 0.0482])
[rfa agg] iter:  0, prev_obj_val: 1.4627715349197388, obj_val: 1.3680070638656616, abs dis: 0.09476447105407715
[rfa agg] iter:  0, weight: tensor([0.0162, 0.0146, 0.0174, 0.0165, 0.0650, 0.0659, 0.0378, 0.0640, 0.0679,
        0.0549, 0.0542, 0.0807, 0.0436, 0.0864, 0.0489, 0.0475, 0.0640, 0.0571,
        0.0365, 0.0610])
[rfa agg] iter:  1, prev_obj_val: 1.3680070638656616, obj_val: 1.3659236431121826, abs dis: 0.002083420753479004
[rfa agg] iter:  1, weight: tensor([0.0116, 0.0105, 0.0123, 0.0119, 0.0594, 0.0600, 0.0445, 0.0572, 0.0663,
        0.0641, 0.0577, 0.0716, 0.0448, 0.0785, 0.0578, 0.0510, 0.0612, 0.0692,
        0.0485, 0.0617])
[rfa agg] iter:  2, prev_obj_val: 1.3659236431121826, obj_val: 1.3658939599990845, abs dis: 2.968311309814453e-05
[rfa agg] iter:  2, weight: tensor([0.0112, 0.0101, 0.0118, 0.0114, 0.0585, 0.0588, 0.0461, 0.0556, 0.0655,
        0.0656, 0.0579, 0.0697, 0.0449, 0.0768, 0.0592, 0.0517, 0.0602, 0.0717,
        0.0513, 0.0619])
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0745, Accuracy: 9774/10000 (97.7400%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 8.9286, Accuracy: 51/8968 (0.5687%)
saving model
Done in 335.8599271774292 sec.
Server Epoch:14 choose agents : [41, 73, 51, 74, 29, 4, 42, 69, 95, 80, 8, 25, 68, 70, 61, 64, 31, 10, 23, 7].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0185, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0077, Accuracy: 482/606 (79.5380%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0028, Accuracy: 574/606 (94.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0020, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0021, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0016, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Global model norm: 16.458213837910083.
Norm before scaling: 16.788904358841066. Distance: 4.0107487264449375
Total norm for 4 adversaries is: 16.788904358841066. distance: 4.0107487264449375
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0274, Accuracy: 8872/8968 (98.9295%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0209, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0107, Accuracy: 438/591 (74.1117%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0051, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0050, Accuracy: 536/591 (90.6937%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0044, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0036, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0035, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0029, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0032, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0028, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Global model norm: 16.458213837910083.
Norm before scaling: 16.86700114243971. Distance: 4.8408712384791
Total norm for 4 adversaries is: 16.86700114243971. distance: 4.8408712384791
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0269, Accuracy: 8879/8968 (99.0076%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0180, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0067, Accuracy: 498/568 (87.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0025, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0019, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0016, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.458213837910083.
Norm before scaling: 16.708569658975243. Distance: 3.708488475397458
Total norm for 4 adversaries is: 16.708569658975243. distance: 3.708488475397458
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0314, Accuracy: 8850/8968 (98.6842%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0209, Accuracy: 337/557 (60.5027%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0081, Accuracy: 457/557 (82.0467%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0034, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.458213837910083.
Norm before scaling: 16.69561593079434. Distance: 3.6380888000270586
Total norm for 4 adversaries is: 16.69561593079434. distance: 3.6380888000270586
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0418, Accuracy: 8814/8968 (98.2828%)
___Train Local_Simple,  epoch  14, local model 29, internal_epoch   1,  Average loss: 0.0010, Accuracy: 983/1002 (98.1038%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2406, Accuracy: 9211/10000 (92.1100%)
___Train Local_Simple,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 646/658 (98.1763%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1774, Accuracy: 9417/10000 (94.1700%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 233/236 (98.7288%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1023, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  14, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 245/256 (95.7031%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1547, Accuracy: 9500/10000 (95.0000%)
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4066, Accuracy: 8692/10000 (86.9200%)
___Train Local_Simple,  epoch  14, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1623, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 613/633 (96.8404%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1481, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0015, Accuracy: 630/647 (97.3725%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2682, Accuracy: 9138/10000 (91.3800%)
___Train Local_Simple,  epoch  14, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 484/494 (97.9757%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1299, Accuracy: 9565/10000 (95.6500%)
___Train Local_Simple,  epoch  14, local model 70, internal_epoch   1,  Average loss: 0.0016, Accuracy: 699/724 (96.5470%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1434, Accuracy: 9519/10000 (95.1900%)
___Train Local_Simple,  epoch  14, local model 61, internal_epoch   1,  Average loss: 0.0013, Accuracy: 682/699 (97.5680%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2081, Accuracy: 9338/10000 (93.3800%)
___Train Local_Simple,  epoch  14, local model 64, internal_epoch   1,  Average loss: 0.0014, Accuracy: 795/813 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1700, Accuracy: 9428/10000 (94.2800%)
___Train Local_Simple,  epoch  14, local model 31, internal_epoch   1,  Average loss: 0.0012, Accuracy: 816/835 (97.7246%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1343, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 862/892 (96.6368%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3371, Accuracy: 8910/10000 (89.1000%)
___Train Local_Simple,  epoch  14, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1101, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 408/418 (97.6077%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1239, Accuracy: 9595/10000 (95.9500%)
time spent on training: 322.09533524513245
[rfa agg] training data poison_ratio: 0.19422835633626098  data num: [606, 591, 568, 557, 1002, 658, 236, 256, 602, 431, 633, 647, 494, 724, 699, 813, 835, 892, 293, 418]
[rfa agg] considering poison per batch poison_fraction: 0.06069636135508156
[rfa agg] init. name: [41, 73, 51, 74, 29, 4, 42, 69, 95, 80, 8, 25, 68, 70, 61, 64, 31, 10, 23, 7], weight: tensor([0.0507, 0.0494, 0.0475, 0.0466, 0.0838, 0.0550, 0.0197, 0.0214, 0.0504,
        0.0361, 0.0529, 0.0541, 0.0413, 0.0606, 0.0585, 0.0680, 0.0698, 0.0746,
        0.0245, 0.0350])
[rfa agg] iter:  0, prev_obj_val: 1.5047811269760132, obj_val: 1.4008347988128662, abs dis: 0.10394632816314697
[rfa agg] iter:  0, weight: tensor([0.0159, 0.0128, 0.0165, 0.0162, 0.0853, 0.0669, 0.0310, 0.0331, 0.0638,
        0.0507, 0.0630, 0.0566, 0.0523, 0.0632, 0.0714, 0.0760, 0.0764, 0.0642,
        0.0381, 0.0469])
[rfa agg] iter:  1, prev_obj_val: 1.4008347988128662, obj_val: 1.3984228372573853, abs dis: 0.002411961555480957
[rfa agg] iter:  1, weight: tensor([0.0113, 0.0091, 0.0116, 0.0115, 0.0769, 0.0706, 0.0416, 0.0423, 0.0660,
        0.0569, 0.0615, 0.0505, 0.0544, 0.0590, 0.0707, 0.0758, 0.0737, 0.0530,
        0.0517, 0.0521])
[rfa agg] iter:  2, prev_obj_val: 1.3984228372573853, obj_val: 1.3983919620513916, abs dis: 3.0875205993652344e-05
[rfa agg] iter:  2, weight: tensor([0.0109, 0.0088, 0.0111, 0.0111, 0.0750, 0.0716, 0.0436, 0.0437, 0.0663,
        0.0579, 0.0608, 0.0491, 0.0548, 0.0581, 0.0698, 0.0757, 0.0728, 0.0511,
        0.0549, 0.0528])
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0730, Accuracy: 9781/10000 (97.8100%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 8.1761, Accuracy: 60/8968 (0.6690%)
saving model
Done in 336.9417428970337 sec.
Server Epoch:15 choose agents : [41, 73, 51, 74, 46, 65, 57, 83, 9, 64, 58, 12, 96, 90, 28, 33, 75, 13, 32, 80].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0162, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0063, Accuracy: 512/606 (84.4884%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0027, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0027, Accuracy: 567/606 (93.5644%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0021, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0020, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0017, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0015, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0014, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.44487640455037.
Norm before scaling: 16.774971183376888. Distance: 3.984908722678121
Total norm for 4 adversaries is: 16.774971183376888. distance: 3.984908722678121
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0111, Accuracy: 8934/8968 (99.6209%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0191, Accuracy: 389/591 (65.8206%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0071, Accuracy: 480/591 (81.2183%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0024, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0023, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0017, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0018, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0016, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.44487640455037.
Norm before scaling: 16.78683384463383. Distance: 3.766715877065213
Total norm for 4 adversaries is: 16.78683384463383. distance: 3.766715877065213
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0285, Accuracy: 8869/8968 (98.8961%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0151, Accuracy: 403/568 (70.9507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0048, Accuracy: 522/568 (91.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0026, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.44487640455037.
Norm before scaling: 16.713405432244446. Distance: 3.576422540368498
Total norm for 4 adversaries is: 16.713405432244446. distance: 3.576422540368498
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0202, Accuracy: 8891/8968 (99.1414%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0188, Accuracy: 359/557 (64.4524%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 475/557 (85.2783%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.44487640455037.
Norm before scaling: 16.663368407368527. Distance: 3.274966081050497
Total norm for 4 adversaries is: 16.663368407368527. distance: 3.274966081050497
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0479, Accuracy: 8794/8968 (98.0598%)
___Train Local_Simple,  epoch  15, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1663, Accuracy: 9476/10000 (94.7600%)
___Train Local_Simple,  epoch  15, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1112, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  15, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1580, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  15, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 426/433 (98.3834%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0902, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 427/436 (97.9358%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1488, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch  15, local model 64, internal_epoch   1,  Average loss: 0.0013, Accuracy: 790/813 (97.1710%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3728, Accuracy: 8719/10000 (87.1900%)
___Train Local_Simple,  epoch  15, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1322, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1113/1160 (95.9483%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1839, Accuracy: 9410/10000 (94.1000%)
___Train Local_Simple,  epoch  15, local model 96, internal_epoch   1,  Average loss: 0.0016, Accuracy: 659/672 (98.0655%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1186, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  15, local model 90, internal_epoch   1,  Average loss: 0.0016, Accuracy: 668/683 (97.8038%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3903, Accuracy: 8697/10000 (86.9700%)
___Train Local_Simple,  epoch  15, local model 28, internal_epoch   1,  Average loss: 0.0012, Accuracy: 487/501 (97.2056%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1069, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  15, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1538, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  15, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 671/686 (97.8134%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1199, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 718/734 (97.8202%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1875, Accuracy: 9449/10000 (94.4900%)
___Train Local_Simple,  epoch  15, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 953/977 (97.5435%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2795, Accuracy: 9054/10000 (90.5400%)
___Train Local_Simple,  epoch  15, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2553, Accuracy: 9245/10000 (92.4500%)
time spent on training: 321.8607859611511
[rfa agg] training data poison_ratio: 0.19078136554104017  data num: [606, 591, 568, 557, 710, 371, 343, 433, 436, 813, 276, 1160, 672, 683, 501, 623, 686, 734, 977, 431]
[rfa agg] considering poison per batch poison_fraction: 0.05961917673157505
[rfa agg] init. name: [41, 73, 51, 74, 46, 65, 57, 83, 9, 64, 58, 12, 96, 90, 28, 33, 75, 13, 32, 80], weight: tensor([0.0498, 0.0486, 0.0467, 0.0458, 0.0583, 0.0305, 0.0282, 0.0356, 0.0358,
        0.0668, 0.0227, 0.0953, 0.0552, 0.0561, 0.0412, 0.0512, 0.0564, 0.0603,
        0.0803, 0.0354])
[rfa agg] iter:  0, prev_obj_val: 1.435556173324585, obj_val: 1.35538911819458, abs dis: 0.08016705513000488
[rfa agg] iter:  0, weight: tensor([0.0153, 0.0159, 0.0162, 0.0173, 0.0637, 0.0469, 0.0397, 0.0564, 0.0505,
        0.0674, 0.0314, 0.0671, 0.0693, 0.0605, 0.0578, 0.0625, 0.0669, 0.0676,
        0.0786, 0.0492])
[rfa agg] iter:  1, prev_obj_val: 1.35538911819458, obj_val: 1.3535829782485962, abs dis: 0.0018061399459838867
[rfa agg] iter:  1, weight: tensor([0.0114, 0.0118, 0.0119, 0.0128, 0.0616, 0.0567, 0.0420, 0.0690, 0.0573,
        0.0640, 0.0333, 0.0552, 0.0722, 0.0571, 0.0644, 0.0610, 0.0687, 0.0637,
        0.0722, 0.0538])
[rfa agg] iter:  2, prev_obj_val: 1.3535829782485962, obj_val: 1.3535610437393188, abs dis: 2.193450927734375e-05
[rfa agg] iter:  2, weight: tensor([0.0110, 0.0114, 0.0115, 0.0124, 0.0610, 0.0586, 0.0421, 0.0712, 0.0584,
        0.0634, 0.0334, 0.0535, 0.0726, 0.0565, 0.0655, 0.0604, 0.0689, 0.0627,
        0.0710, 0.0545])
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.0708, Accuracy: 9772/10000 (97.7200%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 8.9393, Accuracy: 40/8968 (0.4460%)
saving model
Done in 336.5047571659088 sec.
Server Epoch:16 choose agents : [41, 73, 51, 74, 23, 25, 12, 58, 19, 11, 13, 82, 50, 34, 14, 55, 53, 36, 6, 47].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0172, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0049, Accuracy: 547/606 (90.2640%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0021, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0019, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0019, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Global model norm: 16.438871029145847.
Norm before scaling: 16.835045655032577. Distance: 4.08459473933098
Total norm for 4 adversaries is: 16.835045655032577. distance: 4.08459473933098
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0132, Accuracy: 8925/8968 (99.5205%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0203, Accuracy: 383/591 (64.8054%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0068, Accuracy: 487/591 (82.4027%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0030, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0022, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0022, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0015, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0015, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0013, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0014, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.438871029145847.
Norm before scaling: 16.841223249429046. Distance: 4.358899381116438
Total norm for 4 adversaries is: 16.841223249429046. distance: 4.358899381116438
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0437, Accuracy: 8821/8968 (98.3608%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0151, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Global model norm: 16.438871029145847.
Norm before scaling: 16.755607918798876. Distance: 3.6001510005647925
Total norm for 4 adversaries is: 16.755607918798876. distance: 3.6001510005647925
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0331, Accuracy: 8844/8968 (98.6173%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0179, Accuracy: 348/557 (62.4776%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0077, Accuracy: 481/557 (86.3555%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0029, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.438871029145847.
Norm before scaling: 16.687030914228625. Distance: 3.706059190749899
Total norm for 4 adversaries is: 16.687030914228625. distance: 3.706059190749899
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0270, Accuracy: 8875/8968 (98.9630%)
___Train Local_Simple,  epoch  16, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1347, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3923, Accuracy: 8717/10000 (87.1700%)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1124/1160 (96.8966%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2955, Accuracy: 9090/10000 (90.9000%)
___Train Local_Simple,  epoch  16, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1135, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  16, local model 19, internal_epoch   1,  Average loss: 0.0013, Accuracy: 199/205 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.0963, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 627/645 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1603, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 720/734 (98.0926%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3162, Accuracy: 9096/10000 (90.9600%)
___Train Local_Simple,  epoch  16, local model 82, internal_epoch   1,  Average loss: 0.0013, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4355, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  16, local model 50, internal_epoch   1,  Average loss: 0.0017, Accuracy: 455/474 (95.9916%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2091, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  16, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 408/413 (98.7893%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2169, Accuracy: 9330/10000 (93.3000%)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 365/376 (97.0745%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1161, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  16, local model 55, internal_epoch   1,  Average loss: 0.0014, Accuracy: 344/354 (97.1751%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2114, Accuracy: 9294/10000 (92.9400%)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2403, Accuracy: 9287/10000 (92.8700%)
___Train Local_Simple,  epoch  16, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 980/1005 (97.5124%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3285, Accuracy: 8940/10000 (89.4000%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3057, Accuracy: 9037/10000 (90.3700%)
___Train Local_Simple,  epoch  16, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 766/776 (98.7113%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2079, Accuracy: 9374/10000 (93.7400%)
time spent on training: 334.52194356918335
[rfa agg] training data poison_ratio: 0.19766748957180558  data num: [606, 591, 568, 557, 293, 647, 1160, 276, 205, 645, 734, 713, 474, 413, 376, 354, 739, 1005, 615, 776]
[rfa agg] considering poison per batch poison_fraction: 0.06177109049118924
[rfa agg] init. name: [41, 73, 51, 74, 23, 25, 12, 58, 19, 11, 13, 82, 50, 34, 14, 55, 53, 36, 6, 47], weight: tensor([0.0516, 0.0503, 0.0484, 0.0474, 0.0249, 0.0551, 0.0987, 0.0235, 0.0175,
        0.0549, 0.0625, 0.0607, 0.0404, 0.0352, 0.0320, 0.0301, 0.0629, 0.0856,
        0.0524, 0.0661])
[rfa agg] iter:  0, prev_obj_val: 1.538278341293335, obj_val: 1.4506627321243286, abs dis: 0.08761560916900635
[rfa agg] iter:  0, weight: tensor([0.0163, 0.0149, 0.0177, 0.0167, 0.0398, 0.0613, 0.0801, 0.0349, 0.0297,
        0.0606, 0.0703, 0.0623, 0.0532, 0.0507, 0.0490, 0.0429, 0.0793, 0.0782,
        0.0640, 0.0780])
[rfa agg] iter:  1, prev_obj_val: 1.4506627321243286, obj_val: 1.4486825466156006, abs dis: 0.0019801855087280273
[rfa agg] iter:  1, weight: tensor([0.0121, 0.0111, 0.0130, 0.0123, 0.0525, 0.0587, 0.0672, 0.0398, 0.0398,
        0.0599, 0.0677, 0.0578, 0.0544, 0.0555, 0.0544, 0.0454, 0.0822, 0.0692,
        0.0651, 0.0818])
[rfa agg] iter:  2, prev_obj_val: 1.4486825466156006, obj_val: 1.448654294013977, abs dis: 2.8252601623535156e-05
[rfa agg] iter:  2, weight: tensor([0.0117, 0.0107, 0.0125, 0.0119, 0.0557, 0.0582, 0.0649, 0.0405, 0.0419,
        0.0598, 0.0670, 0.0568, 0.0542, 0.0560, 0.0551, 0.0454, 0.0824, 0.0675,
        0.0652, 0.0824])
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.0727, Accuracy: 9766/10000 (97.6600%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 7.9414, Accuracy: 83/8968 (0.9255%)
saving model
Done in 349.7767884731293 sec.
Server Epoch:17 choose agents : [41, 73, 51, 74, 92, 37, 43, 17, 2, 66, 6, 38, 45, 81, 4, 24, 54, 10, 11, 80].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0156, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 553/606 (91.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0027, Accuracy: 575/606 (94.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0021, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0019, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.42537389878367.
Norm before scaling: 16.790032218097902. Distance: 3.9941635466946193
Total norm for 4 adversaries is: 16.790032218097902. distance: 3.9941635466946193
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0040, Accuracy: 8959/8968 (99.8996%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0148, Accuracy: 434/591 (73.4349%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 519/591 (87.8173%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0023, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0019, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0010, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.42537389878367.
Norm before scaling: 16.81042603814622. Distance: 3.806283478988962
Total norm for 4 adversaries is: 16.81042603814622. distance: 3.806283478988962
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0332, Accuracy: 8843/8968 (98.6062%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0113, Accuracy: 458/568 (80.6338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0016, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.42537389878367.
Norm before scaling: 16.62629132526018. Distance: 2.9625545705927907
Total norm for 4 adversaries is: 16.62629132526018. distance: 2.9625545705927907
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0312, Accuracy: 8848/8968 (98.6619%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0150, Accuracy: 397/557 (71.2747%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0060, Accuracy: 483/557 (86.7145%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.42537389878367.
Norm before scaling: 16.66303142321161. Distance: 3.2597982451839256
Total norm for 4 adversaries is: 16.66303142321161. distance: 3.2597982451839256
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0399, Accuracy: 8817/8968 (98.3162%)
___Train Local_Simple,  epoch  17, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 913/937 (97.4386%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2280, Accuracy: 9251/10000 (92.5100%)
___Train Local_Simple,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3480, Accuracy: 8965/10000 (89.6500%)
___Train Local_Simple,  epoch  17, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1836, Accuracy: 9383/10000 (93.8300%)
___Train Local_Simple,  epoch  17, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1333, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1424, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0010, Accuracy: 645/660 (97.7273%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3152, Accuracy: 8878/10000 (88.7800%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2092, Accuracy: 9310/10000 (93.1000%)
___Train Local_Simple,  epoch  17, local model 38, internal_epoch   1,  Average loss: 0.0014, Accuracy: 866/895 (96.7598%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0260, Accuracy: 8096/10000 (80.9600%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5466, Accuracy: 8044/10000 (80.4400%)
___Train Local_Simple,  epoch  17, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1210/1227 (98.6145%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1831, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 645/658 (98.0243%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1217, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch  17, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1071, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  17, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 506/519 (97.4952%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2666, Accuracy: 9169/10000 (91.6900%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 874/892 (97.9821%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4274, Accuracy: 8787/10000 (87.8700%)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 633/645 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1972, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch  17, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1455, Accuracy: 9581/10000 (95.8100%)
time spent on training: 334.10552501678467
[rfa agg] training data poison_ratio: 0.17532467532467533  data num: [606, 591, 568, 557, 937, 860, 408, 620, 548, 660, 615, 895, 628, 1227, 658, 379, 519, 892, 645, 431]
[rfa agg] considering poison per batch poison_fraction: 0.05478896103896104
[rfa agg] init. name: [41, 73, 51, 74, 92, 37, 43, 17, 2, 66, 6, 38, 45, 81, 4, 24, 54, 10, 11, 80], weight: tensor([0.0458, 0.0446, 0.0429, 0.0421, 0.0707, 0.0649, 0.0308, 0.0468, 0.0414,
        0.0498, 0.0464, 0.0676, 0.0474, 0.0926, 0.0497, 0.0286, 0.0392, 0.0674,
        0.0487, 0.0325])
[rfa agg] iter:  0, prev_obj_val: 1.3450757265090942, obj_val: 1.283368706703186, abs dis: 0.0617070198059082
[rfa agg] iter:  0, weight: tensor([0.0132, 0.0136, 0.0170, 0.0152, 0.0748, 0.0765, 0.0486, 0.0546, 0.0549,
        0.0533, 0.0586, 0.0504, 0.0482, 0.0936, 0.0647, 0.0447, 0.0439, 0.0695,
        0.0569, 0.0479])
[rfa agg] iter:  1, prev_obj_val: 1.283368706703186, obj_val: 1.2826141119003296, abs dis: 0.0007545948028564453
[rfa agg] iter:  1, weight: tensor([0.0105, 0.0109, 0.0134, 0.0120, 0.0721, 0.0735, 0.0548, 0.0545, 0.0583,
        0.0526, 0.0625, 0.0450, 0.0469, 0.0929, 0.0695, 0.0509, 0.0436, 0.0656,
        0.0581, 0.0524])
[rfa agg] iter:  2, prev_obj_val: 1.2826141119003296, obj_val: 1.282609462738037, abs dis: 4.649162292480469e-06
[rfa agg] iter:  2, weight: tensor([0.0104, 0.0107, 0.0131, 0.0118, 0.0715, 0.0729, 0.0555, 0.0544, 0.0587,
        0.0526, 0.0630, 0.0445, 0.0468, 0.0929, 0.0702, 0.0515, 0.0435, 0.0650,
        0.0582, 0.0530])
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.0678, Accuracy: 9783/10000 (97.8300%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 8.6564, Accuracy: 35/8968 (0.3903%)
saving model
Done in 349.2013750076294 sec.
Server Epoch:18 choose agents : [41, 73, 51, 74, 7, 72, 14, 99, 12, 93, 25, 34, 57, 69, 58, 2, 4, 1, 20, 49].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 442/606 (72.9373%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0054, Accuracy: 545/606 (89.9340%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0026, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0025, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0018, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0020, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0016, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0015, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Global model norm: 16.409689929550296.
Norm before scaling: 16.737311724400833. Distance: 3.7969894077976103
Total norm for 4 adversaries is: 16.737311724400833. distance: 3.7969894077976103
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0065, Accuracy: 8944/8968 (99.7324%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0169, Accuracy: 415/591 (70.2200%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 534/591 (90.3553%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0024, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0018, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0014, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.409689929550296.
Norm before scaling: 16.80910800906898. Distance: 4.023400523191736
Total norm for 4 adversaries is: 16.80910800906898. distance: 4.023400523191736
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0273, Accuracy: 8876/8968 (98.9741%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0134, Accuracy: 425/568 (74.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0022, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0019, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0014, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.409689929550296.
Norm before scaling: 16.67160957790125. Distance: 3.352744296487126
Total norm for 4 adversaries is: 16.67160957790125. distance: 3.352744296487126
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0171, Accuracy: 8898/8968 (99.2194%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0166, Accuracy: 381/557 (68.4022%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 497/557 (89.2280%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.409689929550296.
Norm before scaling: 16.654151999084004. Distance: 3.2571669563319743
Total norm for 4 adversaries is: 16.654151999084004. distance: 3.2571669563319743
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0237, Accuracy: 8884/8968 (99.0633%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 411/418 (98.3254%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1509, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch  18, local model 72, internal_epoch   1,  Average loss: 0.0008, Accuracy: 717/731 (98.0848%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2913, Accuracy: 9015/10000 (90.1500%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 365/376 (97.0745%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0994, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  18, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0905, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1133/1160 (97.6724%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2239, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1930, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch  18, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8001, Accuracy: 7680/10000 (76.8000%)
___Train Local_Simple,  epoch  18, local model 34, internal_epoch   1,  Average loss: 0.0006, Accuracy: 408/413 (98.7893%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1573, Accuracy: 9507/10000 (95.0700%)
___Train Local_Simple,  epoch  18, local model 57, internal_epoch   1,  Average loss: 0.0021, Accuracy: 329/343 (95.9184%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1742, Accuracy: 9430/10000 (94.3000%)
___Train Local_Simple,  epoch  18, local model 69, internal_epoch   1,  Average loss: 0.0013, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1074, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1109, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1589, Accuracy: 9469/10000 (94.6900%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 649/658 (98.6322%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1674, Accuracy: 9458/10000 (94.5800%)
___Train Local_Simple,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0013, Accuracy: 744/760 (97.8947%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2111, Accuracy: 9260/10000 (92.6000%)
___Train Local_Simple,  epoch  18, local model 20, internal_epoch   1,  Average loss: 0.0016, Accuracy: 415/429 (96.7366%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1705, Accuracy: 9449/10000 (94.4900%)
___Train Local_Simple,  epoch  18, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 500/506 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1468, Accuracy: 9528/10000 (95.2800%)
time spent on training: 333.20199370384216
[rfa agg] training data poison_ratio: 0.214147376187402  data num: [606, 591, 568, 557, 418, 731, 376, 377, 1160, 623, 647, 413, 343, 256, 276, 548, 658, 760, 429, 506]
[rfa agg] considering poison per batch poison_fraction: 0.06692105505856313
[rfa agg] init. name: [41, 73, 51, 74, 7, 72, 14, 99, 12, 93, 25, 34, 57, 69, 58, 2, 4, 1, 20, 49], weight: tensor([0.0559, 0.0545, 0.0524, 0.0514, 0.0386, 0.0674, 0.0347, 0.0348, 0.1070,
        0.0575, 0.0597, 0.0381, 0.0316, 0.0236, 0.0255, 0.0505, 0.0607, 0.0701,
        0.0396, 0.0467])
[rfa agg] iter:  0, prev_obj_val: 1.4369109869003296, obj_val: 1.337285041809082, abs dis: 0.09962594509124756
[rfa agg] iter:  0, weight: tensor([0.0181, 0.0165, 0.0194, 0.0194, 0.0538, 0.0752, 0.0470, 0.0537, 0.0856,
        0.0695, 0.0540, 0.0529, 0.0459, 0.0356, 0.0353, 0.0653, 0.0735, 0.0676,
        0.0495, 0.0622])
[rfa agg] iter:  1, prev_obj_val: 1.337285041809082, obj_val: 1.3341119289398193, abs dis: 0.0031731128692626953
[rfa agg] iter:  1, weight: tensor([0.0125, 0.0114, 0.0133, 0.0134, 0.0603, 0.0716, 0.0508, 0.0694, 0.0709,
        0.0699, 0.0457, 0.0587, 0.0488, 0.0456, 0.0391, 0.0666, 0.0783, 0.0614,
        0.0475, 0.0647])
[rfa agg] iter:  2, prev_obj_val: 1.3341119289398193, obj_val: 1.3340585231781006, abs dis: 5.340576171875e-05
[rfa agg] iter:  2, weight: tensor([0.0119, 0.0109, 0.0127, 0.0128, 0.0609, 0.0707, 0.0512, 0.0736, 0.0680,
        0.0701, 0.0441, 0.0592, 0.0485, 0.0481, 0.0396, 0.0660, 0.0801, 0.0602,
        0.0466, 0.0649])
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.0650, Accuracy: 9791/10000 (97.9100%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 7.2281, Accuracy: 116/8968 (1.2935%)
saving model
Done in 348.47871351242065 sec.
Server Epoch:19 choose agents : [41, 73, 51, 74, 57, 27, 43, 49, 0, 45, 25, 8, 12, 55, 26, 62, 65, 54, 94, 68].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0123, Accuracy: 477/606 (78.7129%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0031, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0014, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0013, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.40089012149474.
Norm before scaling: 16.730659820441744. Distance: 3.70829778647084
Total norm for 4 adversaries is: 16.730659820441744. distance: 3.70829778647084
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0251, Accuracy: 8878/8968 (98.9964%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0151, Accuracy: 440/591 (74.4501%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 534/591 (90.3553%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0020, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.40089012149474.
Norm before scaling: 16.865415210560617. Distance: 4.16062181043739
Total norm for 4 adversaries is: 16.865415210560617. distance: 4.16062181043739
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0121, Accuracy: 8927/8968 (99.5428%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0105, Accuracy: 457/568 (80.4577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0008, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Global model norm: 16.40089012149474.
Norm before scaling: 16.779655053977383. Distance: 3.748071556149195
Total norm for 4 adversaries is: 16.779655053977383. distance: 3.748071556149195
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0106, Accuracy: 8925/8968 (99.5205%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0130, Accuracy: 424/557 (76.1221%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.40089012149474.
Norm before scaling: 16.60702483667021. Distance: 2.868906778942496
Total norm for 4 adversaries is: 16.60702483667021. distance: 2.868906778942496
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0206, Accuracy: 8888/8968 (99.1079%)
___Train Local_Simple,  epoch  19, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1511, Accuracy: 9507/10000 (95.0700%)
___Train Local_Simple,  epoch  19, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2308, Accuracy: 9230/10000 (92.3000%)
___Train Local_Simple,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1016, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  19, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 497/506 (98.2213%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1485, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0014, Accuracy: 423/435 (97.2414%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1339, Accuracy: 9572/10000 (95.7200%)
___Train Local_Simple,  epoch  19, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2858, Accuracy: 9034/10000 (90.3400%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2301, Accuracy: 9265/10000 (92.6500%)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 610/633 (96.3665%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1128, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1131/1160 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3391, Accuracy: 9067/10000 (90.6700%)
___Train Local_Simple,  epoch  19, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 346/354 (97.7401%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1706, Accuracy: 9458/10000 (94.5800%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 544/554 (98.1949%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1063, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  19, local model 62, internal_epoch   1,  Average loss: 0.0007, Accuracy: 417/423 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0881, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  19, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0890, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  19, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 508/519 (97.8805%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2227, Accuracy: 9310/10000 (93.1000%)
___Train Local_Simple,  epoch  19, local model 94, internal_epoch   1,  Average loss: 0.0014, Accuracy: 147/150 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1035, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  19, local model 68, internal_epoch   1,  Average loss: 0.0010, Accuracy: 486/494 (98.3806%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1129, Accuracy: 9617/10000 (96.1700%)
time spent on training: 329.3936586380005
[rfa agg] training data poison_ratio: 0.22288347091572278  data num: [606, 591, 568, 557, 343, 471, 408, 506, 435, 628, 647, 633, 1160, 354, 554, 423, 371, 519, 150, 494]
[rfa agg] considering poison per batch poison_fraction: 0.06965108466116336
[rfa agg] init. name: [41, 73, 51, 74, 57, 27, 43, 49, 0, 45, 25, 8, 12, 55, 26, 62, 65, 54, 94, 68], weight: tensor([0.0582, 0.0567, 0.0545, 0.0535, 0.0329, 0.0452, 0.0392, 0.0486, 0.0418,
        0.0603, 0.0621, 0.0608, 0.1113, 0.0340, 0.0532, 0.0406, 0.0356, 0.0498,
        0.0144, 0.0474])
[rfa agg] iter:  0, prev_obj_val: 1.4333046674728394, obj_val: 1.3215848207473755, abs dis: 0.11171984672546387
[rfa agg] iter:  0, weight: tensor([0.0193, 0.0165, 0.0179, 0.0234, 0.0443, 0.0520, 0.0556, 0.0647, 0.0516,
        0.0642, 0.0647, 0.0663, 0.0949, 0.0467, 0.0693, 0.0596, 0.0509, 0.0543,
        0.0220, 0.0618])
[rfa agg] iter:  1, prev_obj_val: 1.3215848207473755, obj_val: 1.3173118829727173, abs dis: 0.004272937774658203
[rfa agg] iter:  1, weight: tensor([0.0128, 0.0111, 0.0119, 0.0153, 0.0478, 0.0491, 0.0639, 0.0676, 0.0538,
        0.0591, 0.0578, 0.0597, 0.0778, 0.0476, 0.0776, 0.0777, 0.0629, 0.0511,
        0.0303, 0.0652])
[rfa agg] iter:  2, prev_obj_val: 1.3173118829727173, obj_val: 1.31723153591156, abs dis: 8.034706115722656e-05
[rfa agg] iter:  2, weight: tensor([0.0120, 0.0104, 0.0111, 0.0143, 0.0480, 0.0480, 0.0650, 0.0675, 0.0541,
        0.0578, 0.0561, 0.0578, 0.0740, 0.0470, 0.0796, 0.0831, 0.0659, 0.0500,
        0.0329, 0.0653])
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0676, Accuracy: 9782/10000 (97.8200%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 7.0986, Accuracy: 120/8968 (1.3381%)
saving model
Done in 344.73154306411743 sec.
Server Epoch:20 choose agents : [41, 73, 51, 74, 33, 58, 10, 13, 81, 37, 94, 61, 57, 60, 92, 23, 39, 79, 86, 63].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0119, Accuracy: 483/606 (79.7030%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 563/606 (92.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0019, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.395142259134737.
Norm before scaling: 16.74491509075171. Distance: 3.577346917055406
Total norm for 4 adversaries is: 16.74491509075171. distance: 3.577346917055406
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0059, Accuracy: 8948/8968 (99.7770%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0155, Accuracy: 453/591 (76.6497%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 527/591 (89.1709%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0025, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0020, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0017, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0016, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.395142259134737.
Norm before scaling: 16.88690985969236. Distance: 4.059761885251573
Total norm for 4 adversaries is: 16.88690985969236. distance: 4.059761885251573
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0172, Accuracy: 8906/8968 (99.3087%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0109, Accuracy: 451/568 (79.4014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0029, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.395142259134737.
Norm before scaling: 16.720212041797087. Distance: 3.4273259193960053
Total norm for 4 adversaries is: 16.720212041797087. distance: 3.4273259193960053
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0102, Accuracy: 8925/8968 (99.5205%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0119, Accuracy: 436/557 (78.2765%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.395142259134737.
Norm before scaling: 16.654680646928416. Distance: 2.9369553405982285
Total norm for 4 adversaries is: 16.654680646928416. distance: 2.9369553405982285
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0127, Accuracy: 8912/8968 (99.3756%)
___Train Local_Simple,  epoch  20, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 606/623 (97.2713%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1797, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  20, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1056, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 872/892 (97.7578%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2496, Accuracy: 9139/10000 (91.3900%)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 723/734 (98.5014%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1550, Accuracy: 9519/10000 (95.1900%)
___Train Local_Simple,  epoch  20, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1212/1227 (98.7775%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1844, Accuracy: 9400/10000 (94.0000%)
___Train Local_Simple,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0013, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3144, Accuracy: 9052/10000 (90.5200%)
___Train Local_Simple,  epoch  20, local model 94, internal_epoch   1,  Average loss: 0.0014, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1041, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  20, local model 61, internal_epoch   1,  Average loss: 0.0013, Accuracy: 683/699 (97.7110%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1465, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  20, local model 57, internal_epoch   1,  Average loss: 0.0026, Accuracy: 325/343 (94.7522%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2869, Accuracy: 9092/10000 (90.9200%)
___Train Local_Simple,  epoch  20, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1027, Accuracy: 9692/10000 (96.9200%)
___Train Local_Simple,  epoch  20, local model 92, internal_epoch   1,  Average loss: 0.0009, Accuracy: 921/937 (98.2924%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2541, Accuracy: 9156/10000 (91.5600%)
___Train Local_Simple,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1006, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  20, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 251/257 (97.6654%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1091, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  20, local model 79, internal_epoch   1,  Average loss: 0.0016, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0776, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch  20, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0770, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch  20, local model 63, internal_epoch   1,  Average loss: 0.0015, Accuracy: 867/889 (97.5253%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1273, Accuracy: 9599/10000 (95.9900%)
time spent on training: 327.4103467464447
[rfa agg] training data poison_ratio: 0.2059971611071682  data num: [606, 591, 568, 557, 623, 276, 892, 734, 1227, 860, 150, 699, 343, 338, 937, 293, 257, 182, 250, 889]
[rfa agg] considering poison per batch poison_fraction: 0.06437411284599007
[rfa agg] init. name: [41, 73, 51, 74, 33, 58, 10, 13, 81, 37, 94, 61, 57, 60, 92, 23, 39, 79, 86, 63], weight: tensor([0.0538, 0.0524, 0.0504, 0.0494, 0.0553, 0.0245, 0.0791, 0.0651, 0.1089,
        0.0763, 0.0133, 0.0620, 0.0304, 0.0300, 0.0831, 0.0260, 0.0228, 0.0161,
        0.0222, 0.0789])
[rfa agg] iter:  0, prev_obj_val: 1.3890708684921265, obj_val: 1.3077019453048706, abs dis: 0.08136892318725586
[rfa agg] iter:  0, weight: tensor([0.0183, 0.0154, 0.0179, 0.0207, 0.0631, 0.0344, 0.0852, 0.0672, 0.1114,
        0.0826, 0.0210, 0.0805, 0.0356, 0.0441, 0.0857, 0.0397, 0.0356, 0.0280,
        0.0346, 0.0793])
[rfa agg] iter:  1, prev_obj_val: 1.3077019453048706, obj_val: 1.3055647611618042, abs dis: 0.0021371841430664062
[rfa agg] iter:  1, weight: tensor([0.0133, 0.0114, 0.0130, 0.0150, 0.0615, 0.0382, 0.0777, 0.0621, 0.1020,
        0.0764, 0.0263, 0.0832, 0.0343, 0.0490, 0.0822, 0.0517, 0.0435, 0.0411,
        0.0449, 0.0732])
[rfa agg] iter:  2, prev_obj_val: 1.3055647611618042, obj_val: 1.3055193424224854, abs dis: 4.5418739318847656e-05
[rfa agg] iter:  2, weight: tensor([0.0128, 0.0109, 0.0125, 0.0144, 0.0611, 0.0388, 0.0756, 0.0610, 0.0990,
        0.0745, 0.0275, 0.0831, 0.0341, 0.0498, 0.0813, 0.0551, 0.0449, 0.0447,
        0.0477, 0.0715])
[rfa agg] iter:  3, prev_obj_val: 1.3055193424224854, obj_val: 1.3055180311203003, abs dis: 1.3113021850585938e-06
[rfa agg] iter:  3, weight: tensor([0.0127, 0.0109, 0.0124, 0.0143, 0.0611, 0.0389, 0.0752, 0.0608, 0.0983,
        0.0741, 0.0277, 0.0830, 0.0340, 0.0500, 0.0811, 0.0557, 0.0451, 0.0453,
        0.0483, 0.0711])
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0733, Accuracy: 9782/10000 (97.8200%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 7.1514, Accuracy: 102/8968 (1.1374%)
saving model
Done in 342.63197350502014 sec.
Server Epoch:21 choose agents : [41, 73, 51, 74, 99, 97, 37, 44, 52, 88, 25, 28, 8, 16, 6, 3, 23, 27, 86, 35].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0113, Accuracy: 492/606 (81.1881%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 565/606 (93.2343%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0023, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0021, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0018, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0016, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0014, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.38188387777076.
Norm before scaling: 16.70252754134928. Distance: 3.401479057161186
Total norm for 4 adversaries is: 16.70252754134928. distance: 3.401479057161186
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0013, Accuracy: 8962/8968 (99.9331%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0121, Accuracy: 461/591 (78.0034%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0013, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0009, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.38188387777076.
Norm before scaling: 16.792992828983667. Distance: 3.6486398122105785
Total norm for 4 adversaries is: 16.792992828983667. distance: 3.6486398122105785
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0150, Accuracy: 8910/8968 (99.3533%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0097, Accuracy: 462/568 (81.3380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0016, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0011, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0009, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.38188387777076.
Norm before scaling: 16.688794718032366. Distance: 3.0471917403473983
Total norm for 4 adversaries is: 16.688794718032366. distance: 3.0471917403473983
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0278, Accuracy: 8871/8968 (98.9184%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0131, Accuracy: 424/557 (76.1221%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.38188387777076.
Norm before scaling: 16.66559068385507. Distance: 3.113641160481586
Total norm for 4 adversaries is: 16.66559068385507. distance: 3.113641160481586
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0107, Accuracy: 8922/8968 (99.4871%)
___Train Local_Simple,  epoch  21, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0828, Accuracy: 9740/10000 (97.4000%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0012, Accuracy: 475/487 (97.5359%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2013, Accuracy: 9328/10000 (93.2800%)
___Train Local_Simple,  epoch  21, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3431, Accuracy: 9057/10000 (90.5700%)
___Train Local_Simple,  epoch  21, local model 44, internal_epoch   1,  Average loss: 0.0014, Accuracy: 503/517 (97.2921%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1860, Accuracy: 9387/10000 (93.8700%)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1206, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch  21, local model 88, internal_epoch   1,  Average loss: 0.0012, Accuracy: 519/530 (97.9245%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1410, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  21, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 637/647 (98.4544%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3776, Accuracy: 8804/10000 (88.0400%)
___Train Local_Simple,  epoch  21, local model 28, internal_epoch   1,  Average loss: 0.0010, Accuracy: 492/501 (98.2036%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1080, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 614/633 (96.9984%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1504, Accuracy: 9531/10000 (95.3100%)
___Train Local_Simple,  epoch  21, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 899/915 (98.2514%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0930, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 605/615 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1357, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 898/923 (97.2914%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1985, Accuracy: 9405/10000 (94.0500%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0975, Accuracy: 9678/10000 (96.7800%)
___Train Local_Simple,  epoch  21, local model 27, internal_epoch   1,  Average loss: 0.0014, Accuracy: 459/471 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1464, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0886, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  21, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1456, Accuracy: 9531/10000 (95.3100%)
time spent on training: 327.5158030986786
[rfa agg] training data poison_ratio: 0.20932119354547912  data num: [606, 591, 568, 557, 377, 487, 860, 517, 253, 530, 647, 501, 633, 915, 615, 923, 293, 471, 250, 499]
[rfa agg] considering poison per batch poison_fraction: 0.06541287298296222
[rfa agg] init. name: [41, 73, 51, 74, 99, 97, 37, 44, 52, 88, 25, 28, 8, 16, 6, 3, 23, 27, 86, 35], weight: tensor([0.0546, 0.0533, 0.0512, 0.0502, 0.0340, 0.0439, 0.0775, 0.0466, 0.0228,
        0.0478, 0.0583, 0.0452, 0.0571, 0.0825, 0.0554, 0.0832, 0.0264, 0.0425,
        0.0225, 0.0450])
[rfa agg] iter:  0, prev_obj_val: 1.306152582168579, obj_val: 1.2223867177963257, abs dis: 0.08376586437225342
[rfa agg] iter:  0, weight: tensor([0.0175, 0.0158, 0.0186, 0.0178, 0.0548, 0.0527, 0.0776, 0.0498, 0.0355,
        0.0598, 0.0601, 0.0630, 0.0658, 0.0876, 0.0621, 0.0662, 0.0428, 0.0541,
        0.0347, 0.0636])
[rfa agg] iter:  1, prev_obj_val: 1.2223867177963257, obj_val: 1.2201275825500488, abs dis: 0.0022591352462768555
[rfa agg] iter:  1, weight: tensor([0.0124, 0.0113, 0.0131, 0.0125, 0.0742, 0.0515, 0.0682, 0.0463, 0.0409,
        0.0563, 0.0554, 0.0723, 0.0636, 0.0812, 0.0603, 0.0561, 0.0572, 0.0550,
        0.0409, 0.0712])
[rfa agg] iter:  2, prev_obj_val: 1.2201275825500488, obj_val: 1.2200841903686523, abs dis: 4.3392181396484375e-05
[rfa agg] iter:  2, weight: tensor([0.0119, 0.0108, 0.0125, 0.0120, 0.0797, 0.0509, 0.0660, 0.0456, 0.0416,
        0.0547, 0.0540, 0.0748, 0.0625, 0.0793, 0.0595, 0.0543, 0.0611, 0.0547,
        0.0422, 0.0720])
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0630, Accuracy: 9792/10000 (97.9200%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 6.4033, Accuracy: 252/8968 (2.8100%)
saving model
Done in 342.7191231250763 sec.
Server Epoch:22 choose agents : [41, 73, 51, 74, 29, 48, 11, 43, 33, 12, 97, 15, 42, 20, 90, 56, 54, 24, 38, 32].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0094, Accuracy: 496/606 (81.8482%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0027, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.381168514021386.
Norm before scaling: 16.711539223329808. Distance: 3.5253041941015115
Total norm for 4 adversaries is: 16.711539223329808. distance: 3.5253041941015115
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0046, Accuracy: 8951/8968 (99.8104%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0105, Accuracy: 491/591 (83.0795%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0015, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.381168514021386.
Norm before scaling: 16.755081544664574. Distance: 3.5519304587541805
Total norm for 4 adversaries is: 16.755081544664574. distance: 3.5519304587541805
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0195, Accuracy: 8912/8968 (99.3756%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0082, Accuracy: 485/568 (85.3873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0012, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0008, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0009, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Global model norm: 16.381168514021386.
Norm before scaling: 16.625856305778377. Distance: 2.9097175830772724
Total norm for 4 adversaries is: 16.625856305778377. distance: 2.9097175830772724
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0130, Accuracy: 8916/8968 (99.4202%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0101, Accuracy: 461/557 (82.7648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.381168514021386.
Norm before scaling: 16.636267952186667. Distance: 3.0305975772295906
Total norm for 4 adversaries is: 16.636267952186667. distance: 3.0305975772295906
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0065, Accuracy: 8944/8968 (99.7324%)
___Train Local_Simple,  epoch  22, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 986/1002 (98.4032%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1894, Accuracy: 9391/10000 (93.9100%)
___Train Local_Simple,  epoch  22, local model 48, internal_epoch   1,  Average loss: 0.0006, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0698, Accuracy: 9781/10000 (97.8100%)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 631/645 (97.8295%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1400, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  22, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0978, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch  22, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 607/623 (97.4318%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1257, Accuracy: 9581/10000 (95.8100%)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1133/1160 (97.6724%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1851, Accuracy: 9370/10000 (93.7000%)
___Train Local_Simple,  epoch  22, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 480/487 (98.5626%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1447, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch  22, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 395/401 (98.5037%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0905, Accuracy: 9692/10000 (96.9200%)
___Train Local_Simple,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 233/236 (98.7288%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0726, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch  22, local model 20, internal_epoch   1,  Average loss: 0.0012, Accuracy: 418/429 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2991, Accuracy: 9122/10000 (91.2200%)
___Train Local_Simple,  epoch  22, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 670/683 (98.0966%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2776, Accuracy: 9056/10000 (90.5600%)
___Train Local_Simple,  epoch  22, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 865/880 (98.2955%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0902, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch  22, local model 54, internal_epoch   1,  Average loss: 0.0010, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2843, Accuracy: 9102/10000 (91.0200%)
___Train Local_Simple,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 368/379 (97.0976%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0994, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 872/895 (97.4302%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5304, Accuracy: 8403/10000 (84.0300%)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 950/977 (97.2364%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2080, Accuracy: 9339/10000 (93.3900%)
time spent on training: 327.0267376899719
[rfa agg] training data poison_ratio: 0.18584920761965742  data num: [606, 591, 568, 557, 1002, 448, 645, 408, 623, 1160, 487, 401, 236, 429, 683, 880, 519, 379, 895, 977]
[rfa agg] considering poison per batch poison_fraction: 0.058077877381142944
[rfa agg] init. name: [41, 73, 51, 74, 29, 48, 11, 43, 33, 12, 97, 15, 42, 20, 90, 56, 54, 24, 38, 32], weight: tensor([0.0485, 0.0473, 0.0455, 0.0446, 0.0802, 0.0359, 0.0516, 0.0327, 0.0499,
        0.0928, 0.0390, 0.0321, 0.0189, 0.0343, 0.0547, 0.0704, 0.0415, 0.0303,
        0.0716, 0.0782])
[rfa agg] iter:  0, prev_obj_val: 1.3168936967849731, obj_val: 1.259861946105957, abs dis: 0.05703175067901611
[rfa agg] iter:  0, weight: tensor([0.0159, 0.0152, 0.0185, 0.0173, 0.0822, 0.0601, 0.0617, 0.0502, 0.0592,
        0.0798, 0.0553, 0.0452, 0.0321, 0.0434, 0.0661, 0.0778, 0.0436, 0.0477,
        0.0614, 0.0673])
[rfa agg] iter:  1, prev_obj_val: 1.259861946105957, obj_val: 1.2586451768875122, abs dis: 0.0012167692184448242
[rfa agg] iter:  1, weight: tensor([0.0124, 0.0120, 0.0142, 0.0134, 0.0773, 0.0756, 0.0621, 0.0549, 0.0581,
        0.0708, 0.0620, 0.0505, 0.0409, 0.0426, 0.0651, 0.0748, 0.0420, 0.0559,
        0.0544, 0.0611])
[rfa agg] iter:  2, prev_obj_val: 1.2586451768875122, obj_val: 1.25862455368042, abs dis: 2.0623207092285156e-05
[rfa agg] iter:  2, weight: tensor([0.0121, 0.0116, 0.0138, 0.0130, 0.0760, 0.0792, 0.0619, 0.0555, 0.0576,
        0.0692, 0.0631, 0.0514, 0.0428, 0.0424, 0.0645, 0.0738, 0.0417, 0.0574,
        0.0532, 0.0599])
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0630, Accuracy: 9808/10000 (98.0800%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 6.7989, Accuracy: 154/8968 (1.7172%)
saving model
Done in 342.239559173584 sec.
Server Epoch:23 choose agents : [41, 73, 51, 74, 62, 8, 35, 96, 27, 58, 86, 89, 17, 80, 63, 26, 90, 93, 79, 36].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0094, Accuracy: 509/606 (83.9934%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0026, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0021, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.366262652867828.
Norm before scaling: 16.664599074225805. Distance: 3.182203941988282
Total norm for 4 adversaries is: 16.664599074225805. distance: 3.182203941988282
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0029, Accuracy: 8957/8968 (99.8773%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0107, Accuracy: 483/591 (81.7259%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0014, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0008, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Global model norm: 16.366262652867828.
Norm before scaling: 16.754938564751402. Distance: 3.3212146924560946
Total norm for 4 adversaries is: 16.754938564751402. distance: 3.3212146924560946
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0085, Accuracy: 8932/8968 (99.5986%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0091, Accuracy: 489/568 (86.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Global model norm: 16.366262652867828.
Norm before scaling: 16.618181938685883. Distance: 2.758378184281396
Total norm for 4 adversaries is: 16.618181938685883. distance: 2.758378184281396
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0243, Accuracy: 8885/8968 (99.0745%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0099, Accuracy: 454/557 (81.5081%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0028, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0013, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0008, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.366262652867828.
Norm before scaling: 16.60686404320844. Distance: 2.639616914900338
Total norm for 4 adversaries is: 16.60686404320844. distance: 2.639616914900338
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0080, Accuracy: 8937/8968 (99.6543%)
___Train Local_Simple,  epoch  23, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 417/423 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1094, Accuracy: 9625/10000 (96.2500%)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 609/633 (96.2085%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1688, Accuracy: 9450/10000 (94.5000%)
___Train Local_Simple,  epoch  23, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1483, Accuracy: 9509/10000 (95.0900%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 656/672 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1374, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch  23, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 464/471 (98.5138%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1186, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1002, Accuracy: 9681/10000 (96.8100%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 246/250 (98.4000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0713, Accuracy: 9774/10000 (97.7400%)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 484/492 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1056, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1002, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch  23, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1776, Accuracy: 9463/10000 (94.6300%)
___Train Local_Simple,  epoch  23, local model 63, internal_epoch   1,  Average loss: 0.0015, Accuracy: 864/889 (97.1879%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1034, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0893, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0013, Accuracy: 669/683 (97.9502%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3235, Accuracy: 8868/10000 (88.6800%)
___Train Local_Simple,  epoch  23, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1653, Accuracy: 9462/10000 (94.6200%)
___Train Local_Simple,  epoch  23, local model 79, internal_epoch   1,  Average loss: 0.0016, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0693, Accuracy: 9789/10000 (97.8900%)
___Train Local_Simple,  epoch  23, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 986/1005 (98.1095%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3267, Accuracy: 8991/10000 (89.9100%)
time spent on training: 327.9722812175751
[rfa agg] training data poison_ratio: 0.21061224489795918  data num: [606, 591, 568, 557, 423, 633, 499, 672, 471, 276, 250, 492, 620, 431, 889, 554, 683, 623, 182, 1005]
[rfa agg] considering poison per batch poison_fraction: 0.06581632653061224
[rfa agg] init. name: [41, 73, 51, 74, 62, 8, 35, 96, 27, 58, 86, 89, 17, 80, 63, 26, 90, 93, 79, 36], weight: tensor([0.0550, 0.0536, 0.0515, 0.0505, 0.0384, 0.0574, 0.0453, 0.0610, 0.0427,
        0.0250, 0.0227, 0.0446, 0.0562, 0.0391, 0.0806, 0.0502, 0.0620, 0.0565,
        0.0165, 0.0912])
[rfa agg] iter:  0, prev_obj_val: 1.217164158821106, obj_val: 1.1491992473602295, abs dis: 0.06796491146087646
[rfa agg] iter:  0, weight: tensor([0.0182, 0.0168, 0.0200, 0.0206, 0.0577, 0.0610, 0.0618, 0.0659, 0.0556,
        0.0338, 0.0365, 0.0594, 0.0654, 0.0515, 0.0742, 0.0628, 0.0601, 0.0729,
        0.0284, 0.0773])
[rfa agg] iter:  1, prev_obj_val: 1.1491992473602295, obj_val: 1.1474064588546753, abs dis: 0.0017927885055541992
[rfa agg] iter:  1, weight: tensor([0.0135, 0.0125, 0.0146, 0.0151, 0.0670, 0.0583, 0.0677, 0.0643, 0.0599,
        0.0363, 0.0459, 0.0602, 0.0649, 0.0550, 0.0663, 0.0650, 0.0548, 0.0747,
        0.0379, 0.0663])
[rfa agg] iter:  2, prev_obj_val: 1.1474064588546753, obj_val: 1.1473791599273682, abs dis: 2.7298927307128906e-05
[rfa agg] iter:  2, weight: tensor([0.0130, 0.0121, 0.0141, 0.0145, 0.0686, 0.0576, 0.0690, 0.0641, 0.0608,
        0.0366, 0.0476, 0.0598, 0.0646, 0.0555, 0.0645, 0.0651, 0.0538, 0.0748,
        0.0399, 0.0642])
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0581, Accuracy: 9816/10000 (98.1600%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 5.6565, Accuracy: 413/8968 (4.6053%)
saving model
Done in 343.0887007713318 sec.
Server Epoch:24 choose agents : [41, 73, 51, 74, 67, 87, 65, 30, 98, 25, 54, 52, 46, 6, 35, 17, 20, 77, 44, 8].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0093, Accuracy: 513/606 (84.6535%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0010, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Global model norm: 16.36137463901261.
Norm before scaling: 16.66349202756536. Distance: 3.258039068672757
Total norm for 4 adversaries is: 16.66349202756536. distance: 3.258039068672757
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0020, Accuracy: 8960/8968 (99.9108%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0100, Accuracy: 480/591 (81.2183%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0020, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.36137463901261.
Norm before scaling: 16.807516614482157. Distance: 3.814403121472048
Total norm for 4 adversaries is: 16.807516614482157. distance: 3.814403121472048
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0088, Accuracy: 8937/8968 (99.6543%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0019, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0007, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0007, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0005, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.36137463901261.
Norm before scaling: 16.575126930544812. Distance: 2.46081281073625
Total norm for 4 adversaries is: 16.575126930544812. distance: 2.46081281073625
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0204, Accuracy: 8895/8968 (99.1860%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0087, Accuracy: 473/557 (84.9192%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0032, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.36137463901261.
Norm before scaling: 16.60235016513805. Distance: 2.6911440252336516
Total norm for 4 adversaries is: 16.60235016513805. distance: 2.6911440252336516
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0080, Accuracy: 8934/8968 (99.6209%)
___Train Local_Simple,  epoch  24, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 980/998 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1930, Accuracy: 9371/10000 (93.7100%)
___Train Local_Simple,  epoch  24, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 460/470 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0925, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0007, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0969, Accuracy: 9678/10000 (96.7800%)
___Train Local_Simple,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 391/400 (97.7500%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1246, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch  24, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 798/818 (97.5550%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2059, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2664, Accuracy: 9098/10000 (90.9800%)
___Train Local_Simple,  epoch  24, local model 54, internal_epoch   1,  Average loss: 0.0017, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2273, Accuracy: 9272/10000 (92.7200%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0858, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch  24, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2443, Accuracy: 9178/10000 (91.7800%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 606/615 (98.5366%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1370, Accuracy: 9555/10000 (95.5500%)
___Train Local_Simple,  epoch  24, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/499 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1491, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  24, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 609/620 (98.2258%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1022, Accuracy: 9682/10000 (96.8200%)
___Train Local_Simple,  epoch  24, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2259, Accuracy: 9287/10000 (92.8700%)
___Train Local_Simple,  epoch  24, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1262, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  24, local model 44, internal_epoch   1,  Average loss: 0.0013, Accuracy: 504/517 (97.4855%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1258, Accuracy: 9597/10000 (95.9700%)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 617/633 (97.4724%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1279, Accuracy: 9626/10000 (96.2600%)
time spent on training: 325.14497113227844
[rfa agg] training data poison_ratio: 0.2035056967572305  data num: [606, 591, 568, 557, 998, 470, 371, 400, 818, 647, 519, 253, 710, 615, 499, 620, 429, 589, 517, 633]
[rfa agg] considering poison per batch poison_fraction: 0.06359553023663453
[rfa agg] init. name: [41, 73, 51, 74, 67, 87, 65, 30, 98, 25, 54, 52, 46, 6, 35, 17, 20, 77, 44, 8], weight: tensor([0.0531, 0.0518, 0.0498, 0.0488, 0.0875, 0.0412, 0.0325, 0.0351, 0.0717,
        0.0567, 0.0455, 0.0222, 0.0622, 0.0539, 0.0437, 0.0543, 0.0376, 0.0516,
        0.0453, 0.0555])
[rfa agg] iter:  0, prev_obj_val: 1.2466026544570923, obj_val: 1.1823375225067139, abs dis: 0.06426513195037842
[rfa agg] iter:  0, weight: tensor([0.0176, 0.0145, 0.0228, 0.0200, 0.0794, 0.0602, 0.0496, 0.0473, 0.0701,
        0.0556, 0.0465, 0.0394, 0.0604, 0.0648, 0.0635, 0.0641, 0.0470, 0.0577,
        0.0538, 0.0655])
[rfa agg] iter:  1, prev_obj_val: 1.1823375225067139, obj_val: 1.1809664964675903, abs dis: 0.0013710260391235352
[rfa agg] iter:  1, weight: tensor([0.0135, 0.0112, 0.0170, 0.0151, 0.0723, 0.0668, 0.0565, 0.0514, 0.0646,
        0.0529, 0.0428, 0.0521, 0.0556, 0.0673, 0.0719, 0.0635, 0.0481, 0.0565,
        0.0541, 0.0668])
[rfa agg] iter:  2, prev_obj_val: 1.1809664964675903, obj_val: 1.1809501647949219, abs dis: 1.633167266845703e-05
[rfa agg] iter:  2, weight: tensor([0.0131, 0.0109, 0.0164, 0.0146, 0.0709, 0.0674, 0.0575, 0.0522, 0.0635,
        0.0524, 0.0422, 0.0540, 0.0546, 0.0676, 0.0738, 0.0632, 0.0484, 0.0561,
        0.0540, 0.0670])
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0591, Accuracy: 9826/10000 (98.2600%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 5.1993, Accuracy: 525/8968 (5.8541%)
saving model
Done in 340.3904230594635 sec.
Server Epoch:25 choose agents : [41, 73, 51, 74, 78, 3, 39, 14, 32, 4, 30, 65, 23, 98, 88, 71, 2, 43, 25, 17].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0077, Accuracy: 515/606 (84.9835%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0023, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.354537175672956.
Norm before scaling: 16.66499187955707. Distance: 3.1099472669442205
Total norm for 4 adversaries is: 16.66499187955707. distance: 3.1099472669442205
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0012, Accuracy: 8965/8968 (99.9665%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0070, Accuracy: 511/591 (86.4636%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0019, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0006, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Global model norm: 16.354537175672956.
Norm before scaling: 16.66389126875223. Distance: 3.0295868076316257
Total norm for 4 adversaries is: 16.66389126875223. distance: 3.0295868076316257
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0054, Accuracy: 8949/8968 (99.7881%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 509/568 (89.6127%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0018, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0010, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0007, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.354537175672956.
Norm before scaling: 16.605505965466413. Distance: 2.478106381513543
Total norm for 4 adversaries is: 16.605505965466413. distance: 2.478106381513543
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0263, Accuracy: 8882/8968 (99.0410%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0079, Accuracy: 470/557 (84.3806%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0033, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.354537175672956.
Norm before scaling: 16.59269616180471. Distance: 2.6118293229869654
Total norm for 4 adversaries is: 16.59269616180471. distance: 2.6118293229869654
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0058, Accuracy: 8944/8968 (99.7324%)
___Train Local_Simple,  epoch  25, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1268, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0010, Accuracy: 904/923 (97.9415%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1408, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  25, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0704, Accuracy: 9781/10000 (97.8100%)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1051, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  25, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 951/977 (97.3388%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1266, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 647/658 (98.3283%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1210, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch  25, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 394/400 (98.5000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1366, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  25, local model 65, internal_epoch   1,  Average loss: 0.0006, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0879, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0872, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch  25, local model 98, internal_epoch   1,  Average loss: 0.0009, Accuracy: 805/818 (98.4108%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2836, Accuracy: 9163/10000 (91.6300%)
___Train Local_Simple,  epoch  25, local model 88, internal_epoch   1,  Average loss: 0.0007, Accuracy: 525/530 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0927, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  25, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1367/1384 (98.7717%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4935, Accuracy: 8654/10000 (86.5400%)
___Train Local_Simple,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1663, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1158, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 637/647 (98.4544%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2523, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1064, Accuracy: 9671/10000 (96.7100%)
time spent on training: 325.69749569892883
[rfa agg] training data poison_ratio: 0.1961977186311787  data num: [606, 591, 568, 557, 303, 923, 257, 376, 977, 658, 400, 371, 293, 818, 530, 1384, 548, 408, 647, 620]
[rfa agg] considering poison per batch poison_fraction: 0.06131178707224335
[rfa agg] init. name: [41, 73, 51, 74, 78, 3, 39, 14, 32, 4, 30, 65, 23, 98, 88, 71, 2, 43, 25, 17], weight: tensor([0.0512, 0.0499, 0.0480, 0.0471, 0.0256, 0.0780, 0.0217, 0.0318, 0.0826,
        0.0556, 0.0338, 0.0313, 0.0248, 0.0691, 0.0448, 0.1169, 0.0463, 0.0345,
        0.0547, 0.0524])
[rfa agg] iter:  0, prev_obj_val: 1.1949821710586548, obj_val: 1.145383358001709, abs dis: 0.0495988130569458
[rfa agg] iter:  0, weight: tensor([0.0169, 0.0168, 0.0200, 0.0187, 0.0387, 0.0708, 0.0394, 0.0446, 0.0716,
        0.0698, 0.0490, 0.0507, 0.0424, 0.0676, 0.0651, 0.0918, 0.0549, 0.0524,
        0.0552, 0.0637])
[rfa agg] iter:  1, prev_obj_val: 1.145383358001709, obj_val: 1.1443454027175903, abs dis: 0.0010379552841186523
[rfa agg] iter:  1, weight: tensor([0.0132, 0.0132, 0.0156, 0.0145, 0.0424, 0.0651, 0.0457, 0.0491, 0.0641,
        0.0719, 0.0548, 0.0591, 0.0524, 0.0643, 0.0707, 0.0811, 0.0545, 0.0539,
        0.0521, 0.0624])
[rfa agg] iter:  2, prev_obj_val: 1.1443454027175903, obj_val: 1.144327998161316, abs dis: 1.7404556274414062e-05
[rfa agg] iter:  2, weight: tensor([0.0128, 0.0128, 0.0151, 0.0141, 0.0428, 0.0640, 0.0464, 0.0500, 0.0627,
        0.0718, 0.0561, 0.0608, 0.0546, 0.0636, 0.0718, 0.0791, 0.0544, 0.0537,
        0.0515, 0.0620])
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0559, Accuracy: 9817/10000 (98.1700%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 4.9456, Accuracy: 705/8968 (7.8613%)
saving model
Saving model on epoch 25
Done in 340.8660817146301 sec.
Saving all the graphs.
This run has a label: Feb.17_15.47.28. Visdom environment: mnist_DBA

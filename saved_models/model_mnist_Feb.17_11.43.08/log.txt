current path: saved_models/model_mnist_Feb.17_11.43.08
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43, 46, 37, 21, 35, 61, 64, 28, 67, 22, 82].
___adversary_clean___Train Local_Simple,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 579/591 (97.9695%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 555/568 (97.7113%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0015, ___adversary_clean___Accuracy: 544/557 (97.6661%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0228, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0121, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0073, Accuracy: 534/606 (88.1188%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0045, Accuracy: 554/606 (91.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0042, Accuracy: 557/606 (91.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0032, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0032, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0027, Accuracy: 575/606 (94.8845%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0026, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0023, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.81740387938006. Distance: 4.714817454747511
Total norm for 4 adversaries is: 16.81740387938006. distance: 4.714817454747511
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0629, Accuracy: 8814/8968 (98.2828%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0261, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0135, Accuracy: 375/591 (63.4518%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0072, Accuracy: 498/591 (84.2640%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0060, Accuracy: 500/591 (84.6024%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0052, Accuracy: 522/591 (88.3249%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0041, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0034, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0031, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0027, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.80606307567348. Distance: 4.568340795641462
Total norm for 4 adversaries is: 16.80606307567348. distance: 4.568340795641462
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0515, Accuracy: 8852/8968 (98.7065%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0236, Accuracy: 337/568 (59.3310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0102, Accuracy: 454/568 (79.9296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0049, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0046, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0037, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0033, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0025, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0023, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0023, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0023, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.759785540899774. Distance: 4.586053954015437
Total norm for 4 adversaries is: 16.759785540899774. distance: 4.586053954015437
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0644, Accuracy: 8764/8968 (97.7252%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0240, Accuracy: 313/557 (56.1939%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0113, Accuracy: 381/557 (68.4022%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0053, Accuracy: 502/557 (90.1257%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0039, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0036, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0028, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0021, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.84416218042758. Distance: 4.542233959546967
Total norm for 4 adversaries is: 16.84416218042758. distance: 4.542233959546967
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0832, Accuracy: 8634/8968 (96.2756%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1545, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0016, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0853, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 853/889 (95.9505%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1665, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 623/645 (96.5891%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2816, Accuracy: 9074/10000 (90.7400%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 670/686 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1550, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2867, Accuracy: 9062/10000 (90.6200%)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0019, Accuracy: 682/710 (96.0563%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3995, Accuracy: 8679/10000 (86.7900%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 837/860 (97.3256%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3147, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 304/312 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2001, Accuracy: 9383/10000 (93.8300%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2008, Accuracy: 9416/10000 (94.1600%)
___Train Local_Simple,  epoch  11, local model 61, internal_epoch   1,  Average loss: 0.0017, Accuracy: 673/699 (96.2804%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4396, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  11, local model 64, internal_epoch   1,  Average loss: 0.0022, Accuracy: 781/813 (96.0640%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5151, Accuracy: 8166/10000 (81.6600%)
___Train Local_Simple,  epoch  11, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 482/501 (96.2076%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1038, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  11, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2293, Accuracy: 9262/10000 (92.6200%)
___Train Local_Simple,  epoch  11, local model 22, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3431, Accuracy: 8993/10000 (89.9300%)
___Train Local_Simple,  epoch  11, local model 82, internal_epoch   1,  Average loss: 0.0016, Accuracy: 689/713 (96.6339%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2847, Accuracy: 9066/10000 (90.6600%)
time spent on training: 357.1898295879364
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.8968, Accuracy: 7059/10000 (70.5900%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.0508, Accuracy: 8893/8968 (99.1637%)
saving model
Done in 371.37664246559143 sec.
Server Epoch:12 choose agents : [41, 51, 73, 74, 57, 63, 77, 18, 43, 91, 42, 52, 28, 37, 96, 99, 80, 13, 98, 78].
___adversary_clean___Train Local_Simple,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0045, ___adversary_clean___Accuracy: 563/606 (92.9043%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0041, ___adversary_clean___Accuracy: 530/568 (93.3099%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0039, ___adversary_clean___Accuracy: 554/591 (93.7394%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0062, ___adversary_clean___Accuracy: 491/557 (88.1508%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 561/606 (92.5743%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0023, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0015, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0011, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.55016676712145.
Norm before scaling: 16.763861087894362. Distance: 1.6606615441967034
Total norm for 4 adversaries is: 16.763861087894362. distance: 1.6606615441967034
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0366, Accuracy: 8845/8968 (98.6285%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0013, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0007, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Global model norm: 16.55016676712145.
Norm before scaling: 16.725833597207775. Distance: 1.3317691847226956
Total norm for 4 adversaries is: 16.725833597207775. distance: 1.3317691847226956
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0127, Accuracy: 8917/8968 (99.4313%)
poison local model 73 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0016, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0007, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.55016676712145.
Norm before scaling: 16.757764240897878. Distance: 1.5522965491711316
Total norm for 4 adversaries is: 16.757764240897878. distance: 1.5522965491711316
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0441, Accuracy: 8827/8968 (98.4277%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0019, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.55016676712145.
Norm before scaling: 16.792650268118603. Distance: 1.7326773505655113
Total norm for 4 adversaries is: 16.792650268118603. distance: 1.7326773505655113
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0079, Accuracy: 8942/8968 (99.7101%)
___Train Local_Simple,  epoch  12, local model 57, internal_epoch   1,  Average loss: 0.0081, Accuracy: 286/343 (83.3819%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4378, Accuracy: 8404/10000 (84.0400%)
___Train Local_Simple,  epoch  12, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 810/889 (91.1136%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2336, Accuracy: 9294/10000 (92.9400%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 522/589 (88.6248%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2724, Accuracy: 9225/10000 (92.2500%)
___Train Local_Simple,  epoch  12, local model 18, internal_epoch   1,  Average loss: 0.0079, Accuracy: 400/459 (87.1460%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0384, Accuracy: 7477/10000 (74.7700%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0062, Accuracy: 367/408 (89.9510%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6814, Accuracy: 7945/10000 (79.4500%)
___Train Local_Simple,  epoch  12, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 229/256 (89.4531%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9979, Accuracy: 6760/10000 (67.6000%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0125, Accuracy: 184/236 (77.9661%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7339, Accuracy: 7174/10000 (71.7400%)
___Train Local_Simple,  epoch  12, local model 52, internal_epoch   1,  Average loss: 0.0077, Accuracy: 214/253 (84.5850%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0905, Accuracy: 6528/10000 (65.2800%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0077, Accuracy: 425/501 (84.8303%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3975, Accuracy: 8818/10000 (88.1800%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 810/860 (94.1860%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4534, Accuracy: 8559/10000 (85.5900%)
___Train Local_Simple,  epoch  12, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 609/672 (90.6250%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1200, Accuracy: 7317/10000 (73.1700%)
___Train Local_Simple,  epoch  12, local model 99, internal_epoch   1,  Average loss: 0.0071, Accuracy: 325/377 (86.2069%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3612, Accuracy: 6751/10000 (67.5100%)
___Train Local_Simple,  epoch  12, local model 80, internal_epoch   1,  Average loss: 0.0066, Accuracy: 372/431 (86.3109%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8099, Accuracy: 7194/10000 (71.9400%)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 677/734 (92.2343%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6136, Accuracy: 8099/10000 (80.9900%)
___Train Local_Simple,  epoch  12, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 756/818 (92.4205%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9948, Accuracy: 7406/10000 (74.0600%)
___Train Local_Simple,  epoch  12, local model 78, internal_epoch   1,  Average loss: 0.0068, Accuracy: 266/303 (87.7888%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4388, Accuracy: 6200/10000 (62.0000%)
time spent on training: 370.0601589679718
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.2259, Accuracy: 9311/10000 (93.1100%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 2.2092, Accuracy: 5573/8968 (62.1432%)
saving model
Done in 384.0665867328644 sec.
Server Epoch:13 choose agents : [41, 74, 51, 73, 50, 67, 14, 36, 24, 7, 4, 80, 39, 26, 29, 42, 69, 95, 8, 25].
___adversary_clean___Train Local_Simple,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0026, ___adversary_clean___Accuracy: 580/606 (95.7096%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0030, ___adversary_clean___Accuracy: 523/557 (93.8959%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0019, ___adversary_clean___Accuracy: 542/568 (95.4225%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0019, ___adversary_clean___Accuracy: 571/591 (96.6159%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0031, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0015, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.875265839919937.
Norm before scaling: 16.962742987447612. Distance: 2.128361903601029
Total norm for 4 adversaries is: 16.962742987447612. distance: 2.128361903601029
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0170, Accuracy: 8910/8968 (99.3533%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.875265839919937.
Norm before scaling: 16.974686569443907. Distance: 1.890000232212113
Total norm for 4 adversaries is: 16.974686569443907. distance: 1.890000232212113
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0050, Accuracy: 8948/8968 (99.7770%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0007, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.875265839919937.
Norm before scaling: 16.971398022263166. Distance: 1.8973820896228588
Total norm for 4 adversaries is: 16.971398022263166. distance: 1.8973820896228588
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0147, Accuracy: 8908/8968 (99.3310%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.875265839919937.
Norm before scaling: 16.964345005476744. Distance: 1.7340416115296533
Total norm for 4 adversaries is: 16.964345005476744. distance: 1.7340416115296533
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0247, Accuracy: 8903/8968 (99.2752%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 451/474 (95.1477%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3841, Accuracy: 8816/10000 (88.1600%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 936/998 (93.7876%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3441, Accuracy: 8830/10000 (88.3000%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 332/376 (88.2979%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3174, Accuracy: 9030/10000 (90.3000%)
___Train Local_Simple,  epoch  13, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 950/1005 (94.5274%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7330, Accuracy: 7898/10000 (78.9800%)
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0025, Accuracy: 362/379 (95.5145%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2730, Accuracy: 9094/10000 (90.9400%)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 393/418 (94.0191%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2979, Accuracy: 9101/10000 (91.0100%)
___Train Local_Simple,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0020, Accuracy: 634/658 (96.3526%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5670, Accuracy: 8457/10000 (84.5700%)
___Train Local_Simple,  epoch  13, local model 80, internal_epoch   1,  Average loss: 0.0017, Accuracy: 415/431 (96.2877%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3263, Accuracy: 8954/10000 (89.5400%)
___Train Local_Simple,  epoch  13, local model 39, internal_epoch   1,  Average loss: 0.0019, Accuracy: 246/257 (95.7198%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5958, Accuracy: 8435/10000 (84.3500%)
___Train Local_Simple,  epoch  13, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 503/554 (90.7942%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3648, Accuracy: 8894/10000 (88.9400%)
___Train Local_Simple,  epoch  13, local model 29, internal_epoch   1,  Average loss: 0.0018, Accuracy: 966/1002 (96.4072%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3925, Accuracy: 8762/10000 (87.6200%)
___Train Local_Simple,  epoch  13, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 220/236 (93.2203%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5663, Accuracy: 8179/10000 (81.7900%)
___Train Local_Simple,  epoch  13, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 239/256 (93.3594%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6987, Accuracy: 7737/10000 (77.3700%)
___Train Local_Simple,  epoch  13, local model 95, internal_epoch   1,  Average loss: 0.0015, Accuracy: 583/602 (96.8439%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 3.5298, Accuracy: 6400/10000 (64.0000%)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 568/633 (89.7314%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5976, Accuracy: 8551/10000 (85.5100%)
___Train Local_Simple,  epoch  13, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 605/647 (93.5085%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4146, Accuracy: 8661/10000 (86.6100%)
time spent on training: 355.0209891796112
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.2305, Accuracy: 9427/10000 (94.2700%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.0175, Accuracy: 8901/8968 (99.2529%)
saving model
Done in 368.6233334541321 sec.
Server Epoch:14 choose agents : [51, 41, 74, 73, 10, 23, 7, 46, 65, 57, 83, 9, 64, 58, 12, 96, 90, 28, 33, 75].
___adversary_clean___Train Local_Simple,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 554/568 (97.5352%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0015, ___adversary_clean___Accuracy: 592/606 (97.6898%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0015, ___adversary_clean___Accuracy: 543/557 (97.4865%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 580/591 (98.1387%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.930043511196764.
Norm before scaling: 16.968232036293585. Distance: 0.7272840219265456
Total norm for 4 adversaries is: 16.968232036293585. distance: 0.7272840219265456
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0173, Accuracy: 8909/8968 (99.3421%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.930043511196764.
Norm before scaling: 16.966833635169397. Distance: 0.7418819400813035
Total norm for 4 adversaries is: 16.966833635169397. distance: 0.7418819400813035
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0282, Accuracy: 8888/8968 (99.1079%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.930043511196764.
Norm before scaling: 16.98803918472632. Distance: 0.8443768962779519
Total norm for 4 adversaries is: 16.98803918472632. distance: 0.8443768962779519
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0023, Accuracy: 8958/8968 (99.8885%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0014, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.930043511196764.
Norm before scaling: 16.967652006085267. Distance: 0.92228553811872
Total norm for 4 adversaries is: 16.967652006085267. distance: 0.92228553811872
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0117, Accuracy: 8932/8968 (99.5986%)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 864/892 (96.8610%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6639, Accuracy: 8121/10000 (81.2100%)
___Train Local_Simple,  epoch  14, local model 23, internal_epoch   1,  Average loss: 0.0017, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2522, Accuracy: 9178/10000 (91.7800%)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0033, Accuracy: 400/418 (95.6938%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2654, Accuracy: 9123/10000 (91.2300%)
___Train Local_Simple,  epoch  14, local model 46, internal_epoch   1,  Average loss: 0.0027, Accuracy: 673/710 (94.7887%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5914, Accuracy: 8259/10000 (82.5900%)
___Train Local_Simple,  epoch  14, local model 65, internal_epoch   1,  Average loss: 0.0025, Accuracy: 360/371 (97.0350%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2722, Accuracy: 9098/10000 (90.9800%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0024, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2009, Accuracy: 9385/10000 (93.8500%)
___Train Local_Simple,  epoch  14, local model 83, internal_epoch   1,  Average loss: 0.0032, Accuracy: 410/433 (94.6882%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1643, Accuracy: 9490/10000 (94.9000%)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 415/436 (95.1835%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1834, Accuracy: 9455/10000 (94.5500%)
___Train Local_Simple,  epoch  14, local model 64, internal_epoch   1,  Average loss: 0.0030, Accuracy: 770/813 (94.7109%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3074, Accuracy: 9033/10000 (90.3300%)
___Train Local_Simple,  epoch  14, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 263/276 (95.2899%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2923, Accuracy: 9135/10000 (91.3500%)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1122/1160 (96.7241%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1572, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch  14, local model 96, internal_epoch   1,  Average loss: 0.0023, Accuracy: 647/672 (96.2798%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3634, Accuracy: 8893/10000 (88.9300%)
___Train Local_Simple,  epoch  14, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 642/683 (93.9971%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8296, Accuracy: 7392/10000 (73.9200%)
___Train Local_Simple,  epoch  14, local model 28, internal_epoch   1,  Average loss: 0.0023, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1708, Accuracy: 9450/10000 (94.5000%)
___Train Local_Simple,  epoch  14, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 601/623 (96.4687%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2991, Accuracy: 9030/10000 (90.3000%)
___Train Local_Simple,  epoch  14, local model 75, internal_epoch   1,  Average loss: 0.0027, Accuracy: 655/686 (95.4810%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2817, Accuracy: 9145/10000 (91.4500%)
time spent on training: 333.95983481407166
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.1216, Accuracy: 9621/10000 (96.2100%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.0365, Accuracy: 8880/8968 (99.0187%)
saving model
Done in 347.6316456794739 sec.
Server Epoch:15 choose agents : [73, 74, 41, 51, 80, 23, 25, 12, 58, 19, 11, 13, 82, 50, 34, 14, 55, 53, 36, 6].
___adversary_clean___Train Local_Simple,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 579/591 (97.9695%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0016, ___adversary_clean___Accuracy: 538/557 (96.5889%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 596/606 (98.3498%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 553/568 (97.3592%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 17.017317982811658.
Norm before scaling: 16.972658497554512. Distance: 0.6656219348030973
Total norm for 4 adversaries is: 16.972658497554512. distance: 0.6656219348030973
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0150, Accuracy: 8925/8968 (99.5205%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 17.017317982811658.
Norm before scaling: 16.987961938681114. Distance: 0.8054588842666518
Total norm for 4 adversaries is: 16.987961938681114. distance: 0.8054588842666518
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0029, Accuracy: 8958/8968 (99.8885%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 17.017317982811658.
Norm before scaling: 16.974549933915313. Distance: 0.6815905839537729
Total norm for 4 adversaries is: 16.974549933915313. distance: 0.6815905839537729
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0260, Accuracy: 8895/8968 (99.1860%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.017317982811658.
Norm before scaling: 16.97211817688518. Distance: 0.58436625571007
Total norm for 4 adversaries is: 16.97211817688518. distance: 0.58436625571007
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0091, Accuracy: 8941/8968 (99.6989%)
___Train Local_Simple,  epoch  15, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 420/431 (97.4478%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5804, Accuracy: 8596/10000 (85.9600%)
___Train Local_Simple,  epoch  15, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3722, Accuracy: 8891/10000 (88.9100%)
___Train Local_Simple,  epoch  15, local model 25, internal_epoch   1,  Average loss: 0.0022, Accuracy: 619/647 (95.6723%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.3701, Accuracy: 7039/10000 (70.3900%)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0021, Accuracy: 1119/1160 (96.4655%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3361, Accuracy: 8793/10000 (87.9300%)
___Train Local_Simple,  epoch  15, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 264/276 (95.6522%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1447, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  15, local model 19, internal_epoch   1,  Average loss: 0.0033, Accuracy: 199/205 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2430, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0018, Accuracy: 625/645 (96.8992%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2287, Accuracy: 9305/10000 (93.0500%)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 719/734 (97.9564%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4970, Accuracy: 8688/10000 (86.8800%)
___Train Local_Simple,  epoch  15, local model 82, internal_epoch   1,  Average loss: 0.0021, Accuracy: 687/713 (96.3534%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2922, Accuracy: 9002/10000 (90.0200%)
___Train Local_Simple,  epoch  15, local model 50, internal_epoch   1,  Average loss: 0.0023, Accuracy: 456/474 (96.2025%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2371, Accuracy: 9246/10000 (92.4600%)
___Train Local_Simple,  epoch  15, local model 34, internal_epoch   1,  Average loss: 0.0008, Accuracy: 404/413 (97.8208%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3540, Accuracy: 8986/10000 (89.8600%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 367/376 (97.6064%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2161, Accuracy: 9265/10000 (92.6500%)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 345/354 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2709, Accuracy: 9182/10000 (91.8200%)
___Train Local_Simple,  epoch  15, local model 53, internal_epoch   1,  Average loss: 0.0014, Accuracy: 720/739 (97.4290%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3301, Accuracy: 9037/10000 (90.3700%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 977/1005 (97.2139%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4087, Accuracy: 8647/10000 (86.4700%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 591/615 (96.0976%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1551, Accuracy: 9510/10000 (95.1000%)
time spent on training: 334.0859773159027
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.1112, Accuracy: 9661/10000 (96.6100%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.0288, Accuracy: 8885/8968 (99.0745%)
saving model
Done in 348.09127736091614 sec.
Server Epoch:16 choose agents : [73, 74, 51, 41, 43, 17, 2, 66, 6, 38, 37, 45, 81, 4, 24, 54, 10, 11, 80, 7].
___adversary_clean___Train Local_Simple,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 582/591 (98.4772%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 546/557 (98.0251%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 559/568 (98.4155%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 597/606 (98.5149%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.945353021217112.
Norm before scaling: 16.907981008309175. Distance: 0.46991886001596384
Total norm for 4 adversaries is: 16.907981008309175. distance: 0.46991886001596384
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0194, Accuracy: 8914/8968 (99.3979%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.945353021217112.
Norm before scaling: 16.92765944532424. Distance: 0.6124076939140622
Total norm for 4 adversaries is: 16.92765944532424. distance: 0.6124076939140622
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0018, Accuracy: 8962/8968 (99.9331%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.945353021217112.
Norm before scaling: 16.917142112828188. Distance: 0.48397161237562736
Total norm for 4 adversaries is: 16.917142112828188. distance: 0.48397161237562736
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0092, Accuracy: 8942/8968 (99.7101%)
poison local model 41 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.945353021217112.
Norm before scaling: 16.913640294961453. Distance: 0.4958917852483657
Total norm for 4 adversaries is: 16.913640294961453. distance: 0.4958917852483657
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0185, Accuracy: 8917/8968 (99.4313%)
___Train Local_Simple,  epoch  16, local model 43, internal_epoch   1,  Average loss: 0.0021, Accuracy: 394/408 (96.5686%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1227, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch  16, local model 17, internal_epoch   1,  Average loss: 0.0021, Accuracy: 599/620 (96.6129%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2048, Accuracy: 9357/10000 (93.5700%)
___Train Local_Simple,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2419, Accuracy: 9246/10000 (92.4600%)
___Train Local_Simple,  epoch  16, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 638/660 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6128, Accuracy: 8444/10000 (84.4400%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0018, Accuracy: 592/615 (96.2602%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4060, Accuracy: 8851/10000 (88.5100%)
___Train Local_Simple,  epoch  16, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 869/895 (97.0950%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4865, Accuracy: 8378/10000 (83.7800%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 842/860 (97.9070%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1564, Accuracy: 9515/10000 (95.1500%)
___Train Local_Simple,  epoch  16, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 612/628 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2979, Accuracy: 9015/10000 (90.1500%)
___Train Local_Simple,  epoch  16, local model 81, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1197/1227 (97.5550%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2658, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 637/658 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3484, Accuracy: 8822/10000 (88.2200%)
___Train Local_Simple,  epoch  16, local model 24, internal_epoch   1,  Average loss: 0.0018, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2259, Accuracy: 9233/10000 (92.3300%)
___Train Local_Simple,  epoch  16, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 500/519 (96.3391%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3096, Accuracy: 8976/10000 (89.7600%)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 862/892 (96.6368%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4327, Accuracy: 8680/10000 (86.8000%)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3192, Accuracy: 8922/10000 (89.2200%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2990, Accuracy: 9135/10000 (91.3500%)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 407/418 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2476, Accuracy: 9218/10000 (92.1800%)
time spent on training: 335.6576633453369
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.0926, Accuracy: 9713/10000 (97.1300%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.0205, Accuracy: 8913/8968 (99.3867%)
saving model
Done in 349.2547814846039 sec.
Server Epoch:17 choose agents : [74, 41, 51, 73, 93, 25, 34, 57, 69, 58, 2, 4, 1, 20, 49, 27, 43, 0, 45, 8].
___adversary_clean___Train Local_Simple,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 547/557 (98.2047%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 563/568 (99.1197%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 584/591 (98.8156%)
poison local model 74 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.897451427540595.
Norm before scaling: 16.87569985527915. Distance: 0.5837982289324324
Total norm for 4 adversaries is: 16.87569985527915. distance: 0.5837982289324324
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0028, Accuracy: 8958/8968 (99.8885%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.897451427540595.
Norm before scaling: 16.874538839184797. Distance: 0.7365002418331208
Total norm for 4 adversaries is: 16.874538839184797. distance: 0.7365002418331208
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0189, Accuracy: 8918/8968 (99.4425%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.897451427540595.
Norm before scaling: 16.85684606554096. Distance: 0.5025784349195965
Total norm for 4 adversaries is: 16.85684606554096. distance: 0.5025784349195965
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0051, Accuracy: 8952/8968 (99.8216%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.897451427540595.
Norm before scaling: 16.855289052489393. Distance: 0.49974812183437484
Total norm for 4 adversaries is: 16.855289052489393. distance: 0.49974812183437484
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0198, Accuracy: 8917/8968 (99.4313%)
___Train Local_Simple,  epoch  17, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2779, Accuracy: 9106/10000 (91.0600%)
___Train Local_Simple,  epoch  17, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 624/647 (96.4451%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4412, Accuracy: 8562/10000 (85.6200%)
___Train Local_Simple,  epoch  17, local model 34, internal_epoch   1,  Average loss: 0.0012, Accuracy: 405/413 (98.0630%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3252, Accuracy: 9070/10000 (90.7000%)
___Train Local_Simple,  epoch  17, local model 57, internal_epoch   1,  Average loss: 0.0022, Accuracy: 327/343 (95.3353%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2731, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  17, local model 69, internal_epoch   1,  Average loss: 0.0018, Accuracy: 246/256 (96.0938%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1709, Accuracy: 9432/10000 (94.3200%)
___Train Local_Simple,  epoch  17, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 263/276 (95.2899%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1238, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0020, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1609, Accuracy: 9494/10000 (94.9400%)
___Train Local_Simple,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 641/658 (97.4164%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2047, Accuracy: 9295/10000 (92.9500%)
___Train Local_Simple,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 726/760 (95.5263%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1831, Accuracy: 9420/10000 (94.2000%)
___Train Local_Simple,  epoch  17, local model 20, internal_epoch   1,  Average loss: 0.0015, Accuracy: 415/429 (96.7366%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3256, Accuracy: 9040/10000 (90.4000%)
___Train Local_Simple,  epoch  17, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 498/506 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1660, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  17, local model 27, internal_epoch   1,  Average loss: 0.0020, Accuracy: 455/471 (96.6030%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2924, Accuracy: 9061/10000 (90.6100%)
___Train Local_Simple,  epoch  17, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2301, Accuracy: 9264/10000 (92.6400%)
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0017, Accuracy: 421/435 (96.7816%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1964, Accuracy: 9379/10000 (93.7900%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 618/628 (98.4076%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3138, Accuracy: 8923/10000 (89.2300%)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 610/633 (96.3665%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1553, Accuracy: 9534/10000 (95.3400%)
time spent on training: 333.2220277786255
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.1027, Accuracy: 9697/10000 (96.9700%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.0120, Accuracy: 8936/8968 (99.6432%)
saving model
Done in 346.8515293598175 sec.
Server Epoch:18 choose agents : [51, 73, 41, 74, 62, 65, 54, 94, 68, 33, 58, 10, 13, 81, 37, 61, 57, 60, 92, 23].
___adversary_clean___Train Local_Simple,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 558/568 (98.2394%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 586/591 (99.1540%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 601/606 (99.1749%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 549/557 (98.5637%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.84757700175542.
Norm before scaling: 16.806330006027025. Distance: 0.4259618323716403
Total norm for 4 adversaries is: 16.806330006027025. distance: 0.4259618323716403
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0059, Accuracy: 8950/8968 (99.7993%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.84757700175542.
Norm before scaling: 16.811957254831494. Distance: 0.5679233097332533
Total norm for 4 adversaries is: 16.811957254831494. distance: 0.5679233097332533
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0152, Accuracy: 8930/8968 (99.5763%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.84757700175542.
Norm before scaling: 16.812308498270415. Distance: 0.4928612260792488
Total norm for 4 adversaries is: 16.812308498270415. distance: 0.4928612260792488
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0166, Accuracy: 8926/8968 (99.5317%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.84757700175542.
Norm before scaling: 16.817820334708863. Distance: 0.4232024395510915
Total norm for 4 adversaries is: 16.817820334708863. distance: 0.4232024395510915
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0026, Accuracy: 8959/8968 (99.8996%)
___Train Local_Simple,  epoch  18, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 415/423 (98.1087%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1152, Accuracy: 9649/10000 (96.4900%)
___Train Local_Simple,  epoch  18, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 359/371 (96.7655%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1778, Accuracy: 9417/10000 (94.1700%)
___Train Local_Simple,  epoch  18, local model 54, internal_epoch   1,  Average loss: 0.0020, Accuracy: 497/519 (95.7611%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2955, Accuracy: 9073/10000 (90.7300%)
___Train Local_Simple,  epoch  18, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 143/150 (95.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1692, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch  18, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 482/494 (97.5709%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2810, Accuracy: 9002/10000 (90.0200%)
___Train Local_Simple,  epoch  18, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2142, Accuracy: 9280/10000 (92.8000%)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 269/276 (97.4638%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1517, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 852/892 (95.5157%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3780, Accuracy: 8774/10000 (87.7400%)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 717/734 (97.6839%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2457, Accuracy: 9297/10000 (92.9700%)
___Train Local_Simple,  epoch  18, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1207/1227 (98.3700%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2967, Accuracy: 8959/10000 (89.5900%)
___Train Local_Simple,  epoch  18, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2895, Accuracy: 9098/10000 (90.9800%)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 682/699 (97.5680%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2276, Accuracy: 9267/10000 (92.6700%)
___Train Local_Simple,  epoch  18, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 334/343 (97.3761%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1996, Accuracy: 9396/10000 (93.9600%)
___Train Local_Simple,  epoch  18, local model 60, internal_epoch   1,  Average loss: 0.0015, Accuracy: 330/338 (97.6331%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1123, Accuracy: 9662/10000 (96.6200%)
___Train Local_Simple,  epoch  18, local model 92, internal_epoch   1,  Average loss: 0.0016, Accuracy: 899/937 (95.9445%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3652, Accuracy: 8818/10000 (88.1800%)
___Train Local_Simple,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1884, Accuracy: 9355/10000 (93.5500%)
time spent on training: 331.98315262794495
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.0973, Accuracy: 9674/10000 (96.7400%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.0238, Accuracy: 8900/8968 (99.2417%)
saving model
Done in 345.48520851135254 sec.
Server Epoch:19 choose agents : [51, 73, 74, 41, 99, 97, 37, 44, 52, 88, 25, 28, 8, 16, 6, 3, 23, 27, 86, 35].
___adversary_clean___Train Local_Simple,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 564/568 (99.2958%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 588/591 (99.4924%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 547/557 (98.2047%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 600/606 (99.0099%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.791404450722233.
Norm before scaling: 16.75650945545818. Distance: 0.4884600197645986
Total norm for 4 adversaries is: 16.75650945545818. distance: 0.4884600197645986
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0049, Accuracy: 8952/8968 (99.8216%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.791404450722233.
Norm before scaling: 16.744347372928946. Distance: 0.32428994603521344
Total norm for 4 adversaries is: 16.744347372928946. distance: 0.32428994603521344
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0186, Accuracy: 8916/8968 (99.4202%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.791404450722233.
Norm before scaling: 16.778598341479167. Distance: 0.6716312365459796
Total norm for 4 adversaries is: 16.778598341479167. distance: 0.6716312365459796
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0010, Accuracy: 8962/8968 (99.9331%)
poison local model 41 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.791404450722233.
Norm before scaling: 16.759499660115807. Distance: 0.45753920277714116
Total norm for 4 adversaries is: 16.759499660115807. distance: 0.45753920277714116
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0148, Accuracy: 8930/8968 (99.5763%)
___Train Local_Simple,  epoch  19, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 371/377 (98.4085%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1204, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch  19, local model 97, internal_epoch   1,  Average loss: 0.0016, Accuracy: 470/487 (96.5092%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2131, Accuracy: 9297/10000 (92.9700%)
___Train Local_Simple,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 842/860 (97.9070%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2675, Accuracy: 9184/10000 (91.8400%)
___Train Local_Simple,  epoch  19, local model 44, internal_epoch   1,  Average loss: 0.0020, Accuracy: 497/517 (96.1315%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1737, Accuracy: 9444/10000 (94.4400%)
___Train Local_Simple,  epoch  19, local model 52, internal_epoch   1,  Average loss: 0.0010, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1600, Accuracy: 9488/10000 (94.8800%)
___Train Local_Simple,  epoch  19, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 523/530 (98.6792%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1405, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3779, Accuracy: 8709/10000 (87.0900%)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 488/501 (97.4052%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0935, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 608/633 (96.0506%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2676, Accuracy: 9149/10000 (91.4900%)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 895/915 (97.8142%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1138, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 601/615 (97.7236%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1271, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 889/923 (96.3164%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2245, Accuracy: 9372/10000 (93.7200%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1385, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  19, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 458/471 (97.2399%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1554, Accuracy: 9488/10000 (94.8800%)
___Train Local_Simple,  epoch  19, local model 86, internal_epoch   1,  Average loss: 0.0015, Accuracy: 242/250 (96.8000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1072, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  19, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/499 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1531, Accuracy: 9519/10000 (95.1900%)
time spent on training: 332.0328712463379
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0876, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.0125, Accuracy: 8935/8968 (99.6320%)
saving model
Done in 345.653596162796 sec.
Server Epoch:20 choose agents : [74, 51, 41, 73, 43, 33, 12, 97, 15, 42, 20, 90, 56, 54, 24, 38, 32, 62, 8, 35].
___adversary_clean___Train Local_Simple,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 551/557 (98.9228%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 561/568 (98.7676%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 595/606 (98.1848%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 587/591 (99.3232%)
poison local model 74 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.74337500892377.
Norm before scaling: 16.713613587443938. Distance: 0.421593342466513
Total norm for 4 adversaries is: 16.713613587443938. distance: 0.421593342466513
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0003, Accuracy: 8967/8968 (99.9888%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.74337500892377.
Norm before scaling: 16.708993392932985. Distance: 0.49360333509759813
Total norm for 4 adversaries is: 16.708993392932985. distance: 0.49360333509759813
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0010, Accuracy: 8964/8968 (99.9554%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.74337500892377.
Norm before scaling: 16.716892602724215. Distance: 0.5577674836872807
Total norm for 4 adversaries is: 16.716892602724215. distance: 0.5577674836872807
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0176, Accuracy: 8926/8968 (99.5317%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.74337500892377.
Norm before scaling: 16.697630132769778. Distance: 0.46897251887525077
Total norm for 4 adversaries is: 16.697630132769778. distance: 0.46897251887525077
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0176, Accuracy: 8918/8968 (99.4425%)
___Train Local_Simple,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2638, Accuracy: 9228/10000 (92.2800%)
___Train Local_Simple,  epoch  20, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 605/623 (97.1108%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1720, Accuracy: 9419/10000 (94.1900%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1120/1160 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1900, Accuracy: 9438/10000 (94.3800%)
___Train Local_Simple,  epoch  20, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 478/487 (98.1520%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2308, Accuracy: 9231/10000 (92.3100%)
___Train Local_Simple,  epoch  20, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 391/401 (97.5062%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2123, Accuracy: 9339/10000 (93.3900%)
___Train Local_Simple,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0015, Accuracy: 227/236 (96.1864%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2352, Accuracy: 9224/10000 (92.2400%)
___Train Local_Simple,  epoch  20, local model 20, internal_epoch   1,  Average loss: 0.0019, Accuracy: 416/429 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2031, Accuracy: 9363/10000 (93.6300%)
___Train Local_Simple,  epoch  20, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 658/683 (96.3397%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7085, Accuracy: 7453/10000 (74.5300%)
___Train Local_Simple,  epoch  20, local model 56, internal_epoch   1,  Average loss: 0.0013, Accuracy: 860/880 (97.7273%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1242, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  20, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 504/519 (97.1098%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2272, Accuracy: 9218/10000 (92.1800%)
___Train Local_Simple,  epoch  20, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 368/379 (97.0976%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1538, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch  20, local model 38, internal_epoch   1,  Average loss: 0.0014, Accuracy: 868/895 (96.9832%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7545, Accuracy: 8278/10000 (82.7800%)
___Train Local_Simple,  epoch  20, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 934/977 (95.5988%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3064, Accuracy: 8958/10000 (89.5800%)
___Train Local_Simple,  epoch  20, local model 62, internal_epoch   1,  Average loss: 0.0010, Accuracy: 414/423 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1312, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 604/633 (95.4186%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1275, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 490/499 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2501, Accuracy: 9218/10000 (92.1800%)
time spent on training: 331.83487033843994
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0837, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.0150, Accuracy: 8925/8968 (99.5205%)
saving model
Done in 345.9254524707794 sec.
Server Epoch:21 choose agents : [41, 74, 73, 51, 80, 63, 58, 26, 90, 89, 93, 79, 36, 67, 87, 65, 30, 98, 25, 54].
___adversary_clean___Train Local_Simple,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 602/606 (99.3399%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 551/557 (98.9228%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 586/591 (99.1540%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 566/568 (99.6479%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.686617595759465.
Norm before scaling: 16.65444426920381. Distance: 0.44533485222650715
Total norm for 4 adversaries is: 16.65444426920381. distance: 0.44533485222650715
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0130, Accuracy: 8930/8968 (99.5763%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.686617595759465.
Norm before scaling: 16.667643302277412. Distance: 0.4968434173815126
Total norm for 4 adversaries is: 16.667643302277412. distance: 0.4968434173815126
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0013, Accuracy: 8962/8968 (99.9331%)
poison local model 73 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.686617595759465.
Norm before scaling: 16.648231279518196. Distance: 0.4150621654587845
Total norm for 4 adversaries is: 16.648231279518196. distance: 0.4150621654587845
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0186, Accuracy: 8919/8968 (99.4536%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.686617595759465.
Norm before scaling: 16.651401293556724. Distance: 0.4547745506617828
Total norm for 4 adversaries is: 16.651401293556724. distance: 0.4547745506617828
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0002, Accuracy: 8967/8968 (99.9888%)
___Train Local_Simple,  epoch  21, local model 80, internal_epoch   1,  Average loss: 0.0011, Accuracy: 420/431 (97.4478%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7974, Accuracy: 8371/10000 (83.7100%)
___Train Local_Simple,  epoch  21, local model 63, internal_epoch   1,  Average loss: 0.0017, Accuracy: 863/889 (97.0754%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0938, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch  21, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1150, Accuracy: 9635/10000 (96.3500%)
___Train Local_Simple,  epoch  21, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/554 (97.2924%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1849, Accuracy: 9461/10000 (94.6100%)
___Train Local_Simple,  epoch  21, local model 90, internal_epoch   1,  Average loss: 0.0014, Accuracy: 668/683 (97.8038%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2736, Accuracy: 9092/10000 (90.9200%)
___Train Local_Simple,  epoch  21, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 484/492 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1191, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2055, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  21, local model 79, internal_epoch   1,  Average loss: 0.0019, Accuracy: 175/182 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0919, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 985/1005 (98.0100%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4774, Accuracy: 8655/10000 (86.5500%)
___Train Local_Simple,  epoch  21, local model 67, internal_epoch   1,  Average loss: 0.0016, Accuracy: 964/998 (96.5932%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3782, Accuracy: 8723/10000 (87.2300%)
___Train Local_Simple,  epoch  21, local model 87, internal_epoch   1,  Average loss: 0.0010, Accuracy: 463/470 (98.5106%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1570, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch  21, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 362/371 (97.5741%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1450, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch  21, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 389/400 (97.2500%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1584, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  21, local model 98, internal_epoch   1,  Average loss: 0.0017, Accuracy: 790/818 (96.5770%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2854, Accuracy: 9105/10000 (91.0500%)
___Train Local_Simple,  epoch  21, local model 25, internal_epoch   1,  Average loss: 0.0014, Accuracy: 631/647 (97.5270%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4285, Accuracy: 8619/10000 (86.1900%)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3401, Accuracy: 8920/10000 (89.2000%)
time spent on training: 331.07428336143494
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0761, Accuracy: 9774/10000 (97.7400%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.0091, Accuracy: 8940/8968 (99.6878%)
saving model
Done in 344.689421415329 sec.
Server Epoch:22 choose agents : [73, 41, 74, 51, 6, 35, 17, 20, 77, 44, 8, 78, 3, 39, 14, 32, 4, 30, 65, 23].
___adversary_clean___Train Local_Simple,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 587/591 (99.3232%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 600/606 (99.0099%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 552/557 (99.1023%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 561/568 (98.7676%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.637897737192677.
Norm before scaling: 16.589491935432537. Distance: 0.471064369588682
Total norm for 4 adversaries is: 16.589491935432537. distance: 0.471064369588682
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0157, Accuracy: 8925/8968 (99.5205%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.637897737192677.
Norm before scaling: 16.610471874059034. Distance: 0.5105069787709472
Total norm for 4 adversaries is: 16.610471874059034. distance: 0.5105069787709472
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0087, Accuracy: 8942/8968 (99.7101%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.637897737192677.
Norm before scaling: 16.608185259893784. Distance: 0.3920041343339572
Total norm for 4 adversaries is: 16.608185259893784. distance: 0.3920041343339572
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0024, Accuracy: 8958/8968 (99.8885%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.637897737192677.
Norm before scaling: 16.608168722365114. Distance: 0.5169118947857341
Total norm for 4 adversaries is: 16.608168722365114. distance: 0.5169118947857341
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0002, Accuracy: 8967/8968 (99.9888%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 598/615 (97.2358%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2572, Accuracy: 9178/10000 (91.7800%)
___Train Local_Simple,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 487/499 (97.5952%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1300, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1735, Accuracy: 9450/10000 (94.5000%)
___Train Local_Simple,  epoch  22, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 419/429 (97.6690%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5759, Accuracy: 8415/10000 (84.1500%)
___Train Local_Simple,  epoch  22, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 575/589 (97.6231%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2197, Accuracy: 9307/10000 (93.0700%)
___Train Local_Simple,  epoch  22, local model 44, internal_epoch   1,  Average loss: 0.0019, Accuracy: 499/517 (96.5184%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2560, Accuracy: 9218/10000 (92.1800%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 613/633 (96.8404%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1215, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch  22, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 299/303 (98.6799%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1853, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0014, Accuracy: 900/923 (97.5081%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2399, Accuracy: 9090/10000 (90.9000%)
___Train Local_Simple,  epoch  22, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0900, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 366/376 (97.3404%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1203, Accuracy: 9639/10000 (96.3900%)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0022, Accuracy: 937/977 (95.9058%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2766, Accuracy: 9057/10000 (90.5700%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 646/658 (98.1763%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1977, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch  22, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 393/400 (98.2500%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1381, Accuracy: 9591/10000 (95.9100%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0850, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch  22, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1119, Accuracy: 9628/10000 (96.2800%)
time spent on training: 332.48223423957825
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0663, Accuracy: 9789/10000 (97.8900%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.0145, Accuracy: 8925/8968 (99.5205%)
saving model
Done in 346.2491307258606 sec.
Server Epoch:23 choose agents : [41, 51, 74, 73, 43, 25, 17, 37, 46, 56, 30, 0, 33, 53, 65, 6, 24, 86, 35, 84].
___adversary_clean___Train Local_Simple,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 602/606 (99.3399%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 563/568 (99.1197%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 553/557 (99.2819%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0002, ___adversary_clean___Accuracy: 589/591 (99.6616%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.587648581074376.
Norm before scaling: 16.55296655902793. Distance: 0.43670836420965664
Total norm for 4 adversaries is: 16.55296655902793. distance: 0.43670836420965664
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0079, Accuracy: 8943/8968 (99.7212%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.587648581074376.
Norm before scaling: 16.556673687776648. Distance: 0.6232906331092147
Total norm for 4 adversaries is: 16.556673687776648. distance: 0.6232906331092147
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.587648581074376.
Norm before scaling: 16.5625. Distance: 0.4312218062541799
Total norm for 4 adversaries is: 16.5625. distance: 0.4312218062541799
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0024, Accuracy: 8959/8968 (99.8996%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.587648581074376.
Norm before scaling: 16.54311679021718. Distance: 0.3027750295597919
Total norm for 4 adversaries is: 16.54311679021718. distance: 0.3027750295597919
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0141, Accuracy: 8930/8968 (99.5763%)
___Train Local_Simple,  epoch  23, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1511, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  23, local model 25, internal_epoch   1,  Average loss: 0.0014, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3903, Accuracy: 8705/10000 (87.0500%)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0019, Accuracy: 600/620 (96.7742%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1282, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch  23, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 840/860 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5941, Accuracy: 8373/10000 (83.7300%)
___Train Local_Simple,  epoch  23, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2574, Accuracy: 9181/10000 (91.8100%)
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0011, Accuracy: 859/880 (97.6136%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1030, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch  23, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2442, Accuracy: 9303/10000 (93.0300%)
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 426/435 (97.9310%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1444, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  23, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0914, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  23, local model 53, internal_epoch   1,  Average loss: 0.0012, Accuracy: 719/739 (97.2936%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2834, Accuracy: 9087/10000 (90.8700%)
___Train Local_Simple,  epoch  23, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1532, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 607/615 (98.6992%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2558, Accuracy: 9258/10000 (92.5800%)
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 367/379 (96.8338%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1075, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0009, Accuracy: 246/250 (98.4000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0844, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch  23, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 496/499 (99.3988%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1295, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch  23, local model 84, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1218/1246 (97.7528%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2012, Accuracy: 9388/10000 (93.8800%)
time spent on training: 340.9165539741516
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0873, Accuracy: 9740/10000 (97.4000%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.0041, Accuracy: 8953/8968 (99.8327%)
saving model
Done in 354.80646443367004 sec.
Server Epoch:24 choose agents : [51, 41, 74, 73, 76, 42, 25, 16, 95, 52, 59, 81, 77, 21, 10, 8, 40, 54, 46, 30].
___adversary_clean___Train Local_Simple,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 564/568 (99.2958%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 603/606 (99.5050%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 552/557 (99.1023%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 587/591 (99.3232%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.534603939659583.
Norm before scaling: 16.493455918477657. Distance: 0.3741006198858037
Total norm for 4 adversaries is: 16.493455918477657. distance: 0.3741006198858037
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0031, Accuracy: 8956/8968 (99.8662%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.534603939659583.
Norm before scaling: 16.49356786028174. Distance: 0.3949280810976879
Total norm for 4 adversaries is: 16.49356786028174. distance: 0.3949280810976879
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0093, Accuracy: 8941/8968 (99.6989%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.534603939659583.
Norm before scaling: 16.503621021943562. Distance: 0.29653183025794194
Total norm for 4 adversaries is: 16.503621021943562. distance: 0.29653183025794194
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0038, Accuracy: 8956/8968 (99.8662%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.534603939659583.
Norm before scaling: 16.488146599041517. Distance: 0.3962786098284281
Total norm for 4 adversaries is: 16.488146599041517. distance: 0.3962786098284281
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0131, Accuracy: 8931/8968 (99.5874%)
___Train Local_Simple,  epoch  24, local model 76, internal_epoch   1,  Average loss: 0.0015, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0691, Accuracy: 9789/10000 (97.8900%)
___Train Local_Simple,  epoch  24, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0787, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0008, Accuracy: 637/647 (98.4544%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2396, Accuracy: 9234/10000 (92.3400%)
___Train Local_Simple,  epoch  24, local model 16, internal_epoch   1,  Average loss: 0.0011, Accuracy: 896/915 (97.9235%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1035, Accuracy: 9675/10000 (96.7500%)
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5764, Accuracy: 8021/10000 (80.2100%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0007, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0999, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  24, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 741/760 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3834, Accuracy: 8757/10000 (87.5700%)
___Train Local_Simple,  epoch  24, local model 81, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1212/1227 (98.7775%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2835, Accuracy: 9129/10000 (91.2900%)
___Train Local_Simple,  epoch  24, local model 77, internal_epoch   1,  Average loss: 0.0021, Accuracy: 571/589 (96.9440%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1129, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  24, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 307/312 (98.3974%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1211, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 848/892 (95.0673%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3386, Accuracy: 8825/10000 (88.2500%)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 620/633 (97.9463%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1689, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch  24, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 759/772 (98.3161%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1510, Accuracy: 9568/10000 (95.6800%)
___Train Local_Simple,  epoch  24, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2937, Accuracy: 9117/10000 (91.1700%)
___Train Local_Simple,  epoch  24, local model 46, internal_epoch   1,  Average loss: 0.0031, Accuracy: 682/710 (96.0563%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4373, Accuracy: 8513/10000 (85.1300%)
___Train Local_Simple,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1385, Accuracy: 9554/10000 (95.5400%)
time spent on training: 361.6464991569519
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0666, Accuracy: 9781/10000 (97.8100%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.0162, Accuracy: 8922/8968 (99.4871%)
saving model
Done in 376.36158537864685 sec.
Server Epoch:25 choose agents : [41, 73, 74, 51, 11, 24, 43, 4, 23, 25, 97, 91, 57, 72, 15, 94, 95, 90, 69, 20].
___adversary_clean___Train Local_Simple,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 602/606 (99.3399%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 590/591 (99.8308%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 552/557 (99.1023%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0002, ___adversary_clean___Accuracy: 566/568 (99.6479%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.47790805464765.
Norm before scaling: 16.436966223807183. Distance: 0.34683584000802736
Total norm for 4 adversaries is: 16.436966223807183. distance: 0.34683584000802736
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0107, Accuracy: 8940/8968 (99.6878%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.47790805464765.
Norm before scaling: 16.428088144337583. Distance: 0.30268249067107267
Total norm for 4 adversaries is: 16.428088144337583. distance: 0.30268249067107267
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0138, Accuracy: 8928/8968 (99.5540%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.47790805464765.
Norm before scaling: 16.460778987430906. Distance: 0.5121865209322236
Total norm for 4 adversaries is: 16.460778987430906. distance: 0.5121865209322236
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.47790805464765.
Norm before scaling: 16.44049439515221. Distance: 0.35796808499990873
Total norm for 4 adversaries is: 16.44049439515221. distance: 0.35796808499990873
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0040, Accuracy: 8953/8968 (99.8327%)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 625/645 (96.8992%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2158, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  25, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 369/379 (97.3615%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1066, Accuracy: 9663/10000 (96.6300%)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2215, Accuracy: 9315/10000 (93.1500%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 645/658 (98.0243%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2258, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1200, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 634/647 (97.9907%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.5692, Accuracy: 6955/10000 (69.5500%)
___Train Local_Simple,  epoch  25, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 477/487 (97.9466%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2011, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  25, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0774, Accuracy: 9760/10000 (97.6000%)
___Train Local_Simple,  epoch  25, local model 57, internal_epoch   1,  Average loss: 0.0013, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1997, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch  25, local model 72, internal_epoch   1,  Average loss: 0.0010, Accuracy: 716/731 (97.9480%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4198, Accuracy: 8774/10000 (87.7400%)
___Train Local_Simple,  epoch  25, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 393/401 (98.0050%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1238, Accuracy: 9600/10000 (96.0000%)
___Train Local_Simple,  epoch  25, local model 94, internal_epoch   1,  Average loss: 0.0015, Accuracy: 147/150 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1227, Accuracy: 9610/10000 (96.1000%)
___Train Local_Simple,  epoch  25, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.7013, Accuracy: 7812/10000 (78.1200%)
___Train Local_Simple,  epoch  25, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 665/683 (97.3646%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3515, Accuracy: 8793/10000 (87.9300%)
___Train Local_Simple,  epoch  25, local model 69, internal_epoch   1,  Average loss: 0.0014, Accuracy: 246/256 (96.0938%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1451, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 420/429 (97.9021%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2007, Accuracy: 9369/10000 (93.6900%)
time spent on training: 380.35394501686096
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0571, Accuracy: 9816/10000 (98.1600%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.0045, Accuracy: 8952/8968 (99.8216%)
saving model
Saving model on epoch 25
Done in 395.0012674331665 sec.
Saving all the graphs.
This run has a label: Feb.17_11.43.08. Visdom environment: mnist_DBA

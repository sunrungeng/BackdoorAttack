current path: saved_models/model_mnist_Feb.18_08.40.09
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43, 46, 37, 21, 35, 61, 64, 28, 67, 22, 82].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0251, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0158, Accuracy: 348/606 (57.4257%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0129, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0122, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0118, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0118, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0111, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.771621641346098. Distance: 4.683462005874889
Total norm for 4 adversaries is: 16.771621641346098. distance: 4.683462005874889
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8783, Accuracy: 5914/8968 (65.9456%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0238, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0210, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0180, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0159, Accuracy: 319/591 (53.9763%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0152, Accuracy: 286/591 (48.3926%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0148, Accuracy: 315/591 (53.2995%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0143, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0133, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0133, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.648080966090824. Distance: 3.9427687498811115
Total norm for 4 adversaries is: 16.648080966090824. distance: 3.9427687498811115
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9113, Accuracy: 4837/8968 (53.9362%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0242, Accuracy: 324/568 (57.0423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0143, Accuracy: 341/568 (60.0352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0127, Accuracy: 361/568 (63.5563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0125, Accuracy: 354/568 (62.3239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0115, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0116, Accuracy: 370/568 (65.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0114, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0108, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0102, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0107, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.630505102105946. Distance: 4.355072632982119
Total norm for 4 adversaries is: 16.630505102105946. distance: 4.355072632982119
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.6460, Accuracy: 6832/8968 (76.1820%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0232, Accuracy: 320/557 (57.4506%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0115, Accuracy: 401/557 (71.9928%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0065, Accuracy: 479/557 (85.9964%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0054, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0044, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0043, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0036, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0028, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0027, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.78801637765714. Distance: 3.9842417975206827
Total norm for 4 adversaries is: 16.78801637765714. distance: 3.9842417975206827
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1691, Accuracy: 8297/8968 (92.5178%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1451, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0020, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0878, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0021, Accuracy: 856/889 (96.2880%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1288, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 632/645 (97.9845%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2495, Accuracy: 9193/10000 (91.9300%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0014, Accuracy: 664/686 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1555, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.7507, Accuracy: 8522/10000 (85.2200%)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0020, Accuracy: 680/710 (95.7746%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5128, Accuracy: 8358/10000 (83.5800%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 837/860 (97.3256%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1592, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 302/312 (96.7949%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2513, Accuracy: 9241/10000 (92.4100%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2571, Accuracy: 9236/10000 (92.3600%)
___Train Local_Simple,  epoch  11, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 679/699 (97.1388%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5908, Accuracy: 8573/10000 (85.7300%)
___Train Local_Simple,  epoch  11, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 782/813 (96.1870%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4025, Accuracy: 8529/10000 (85.2900%)
___Train Local_Simple,  epoch  11, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 485/501 (96.8064%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1165, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  11, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 960/998 (96.1924%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2075, Accuracy: 9364/10000 (93.6400%)
___Train Local_Simple,  epoch  11, local model 22, internal_epoch   1,  Average loss: 0.0018, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2773, Accuracy: 9148/10000 (91.4800%)
___Train Local_Simple,  epoch  11, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 697/713 (97.7560%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4680, Accuracy: 8460/10000 (84.6000%)
time spent on training: 301.1264052391052
[rfa agg] training data poison_ratio: 0.19335498376217836  data num: [606, 591, 568, 557, 293, 78, 889, 645, 686, 408, 710, 860, 312, 499, 699, 813, 501, 998, 583, 713]
[rfa agg] considering poison per batch poison_fraction: 0.06042343242568074
[rfa agg] init. name: [41, 73, 51, 74, 23, 76, 63, 11, 75, 43, 46, 37, 21, 35, 61, 64, 28, 67, 22, 82], weight: tensor([0.0505, 0.0492, 0.0473, 0.0464, 0.0244, 0.0065, 0.0740, 0.0537, 0.0571,
        0.0340, 0.0591, 0.0716, 0.0260, 0.0416, 0.0582, 0.0677, 0.0417, 0.0831,
        0.0485, 0.0594])
[rfa agg] iter:  0, prev_obj_val: 1.6152632236480713, obj_val: 1.533105492591858, abs dis: 0.08215773105621338
[rfa agg] iter:  0, weight: tensor([0.0154, 0.0183, 0.0158, 0.0165, 0.0355, 0.0108, 0.0793, 0.0574, 0.0652,
        0.0435, 0.0591, 0.0850, 0.0360, 0.0568, 0.0661, 0.0708, 0.0583, 0.0818,
        0.0597, 0.0686])
[rfa agg] iter:  1, prev_obj_val: 1.533105492591858, obj_val: 1.5314737558364868, abs dis: 0.0016317367553710938
[rfa agg] iter:  1, weight: tensor([0.0120, 0.0141, 0.0122, 0.0129, 0.0460, 0.0149, 0.0743, 0.0571, 0.0673,
        0.0485, 0.0548, 0.0809, 0.0431, 0.0635, 0.0645, 0.0657, 0.0642, 0.0749,
        0.0598, 0.0692])
[rfa agg] iter:  2, prev_obj_val: 1.5314737558364868, obj_val: 1.5314483642578125, abs dis: 2.5391578674316406e-05
[rfa agg] iter:  2, weight: tensor([0.0116, 0.0137, 0.0118, 0.0126, 0.0485, 0.0159, 0.0731, 0.0571, 0.0676,
        0.0495, 0.0540, 0.0797, 0.0445, 0.0648, 0.0640, 0.0645, 0.0652, 0.0733,
        0.0597, 0.0690])
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0811, Accuracy: 9759/10000 (97.5900%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 9.1747, Accuracy: 37/8968 (0.4126%)
saving model
Done in 312.7345128059387 sec.
Server Epoch:12 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63, 77, 18, 43, 91, 52, 28, 37, 96, 99, 80].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0230, Accuracy: 339/606 (55.9406%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0140, Accuracy: 346/606 (57.0957%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0112, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 386/606 (63.6964%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0105, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0103, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Global model norm: 16.478709038104288.
Norm before scaling: 16.650641608262333. Distance: 3.8188597368371924
Total norm for 4 adversaries is: 16.650641608262333. distance: 3.8188597368371924
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.0176, Accuracy: 3750/8968 (41.8153%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0252, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0236, Accuracy: 207/591 (35.0254%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0168, Accuracy: 318/591 (53.8071%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0158, Accuracy: 324/591 (54.8223%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0154, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0140, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0141, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0140, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0136, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Global model norm: 16.478709038104288.
Norm before scaling: 16.62358832998591. Distance: 3.838461486448285
Total norm for 4 adversaries is: 16.62358832998591. distance: 3.838461486448285
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8777, Accuracy: 5387/8968 (60.0691%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0183, Accuracy: 361/568 (63.5563%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0132, Accuracy: 344/568 (60.5634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0114, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0103, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0105, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0100, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0095, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0095, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0093, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0090, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Global model norm: 16.478709038104288.
Norm before scaling: 16.551036163808693. Distance: 3.1881342238214443
Total norm for 4 adversaries is: 16.551036163808693. distance: 3.1881342238214443
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.5790, Accuracy: 6629/8968 (73.9184%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0217, Accuracy: 314/557 (56.3734%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0100, Accuracy: 414/557 (74.3268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0048, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0047, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0039, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0032, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0027, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0029, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0020, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0023, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.478709038104288.
Norm before scaling: 16.670935020654678. Distance: 3.591113641090677
Total norm for 4 adversaries is: 16.670935020654678. distance: 3.591113641090677
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1236, Accuracy: 8487/8968 (94.6365%)
___Train Local_Simple,  epoch  12, local model 60, internal_epoch   1,  Average loss: 0.0019, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1271, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0014, Accuracy: 233/236 (98.7288%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0915, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch  12, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1628, Accuracy: 9489/10000 (94.8900%)
___Train Local_Simple,  epoch  12, local model 56, internal_epoch   1,  Average loss: 0.0013, Accuracy: 863/880 (98.0682%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1820, Accuracy: 9373/10000 (93.7300%)
___Train Local_Simple,  epoch  12, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1651, Accuracy: 9476/10000 (94.7600%)
___Train Local_Simple,  epoch  12, local model 63, internal_epoch   1,  Average loss: 0.0017, Accuracy: 856/889 (96.2880%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0980, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 571/589 (96.9440%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0816, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch  12, local model 18, internal_epoch   1,  Average loss: 0.0020, Accuracy: 445/459 (96.9499%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3273, Accuracy: 8918/10000 (89.1800%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1314, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch  12, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0933, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch  12, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1143, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 489/501 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0927, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 836/860 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2862, Accuracy: 9225/10000 (92.2500%)
___Train Local_Simple,  epoch  12, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 657/672 (97.7679%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1723, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  12, local model 99, internal_epoch   1,  Average loss: 0.0010, Accuracy: 372/377 (98.6737%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1060, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  12, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1579, Accuracy: 9531/10000 (95.3100%)
time spent on training: 299.4161615371704
[rfa agg] training data poison_ratio: 0.22664714494875549  data num: [606, 591, 568, 557, 338, 236, 431, 880, 343, 889, 589, 459, 408, 256, 253, 501, 860, 672, 377, 431]
[rfa agg] considering poison per batch poison_fraction: 0.07082723279648609
[rfa agg] init. name: [41, 73, 51, 74, 60, 42, 85, 56, 57, 63, 77, 18, 43, 91, 52, 28, 37, 96, 99, 80], weight: tensor([0.0592, 0.0577, 0.0554, 0.0544, 0.0330, 0.0230, 0.0421, 0.0859, 0.0335,
        0.0868, 0.0575, 0.0448, 0.0398, 0.0250, 0.0247, 0.0489, 0.0839, 0.0656,
        0.0368, 0.0421])
[rfa agg] iter:  0, prev_obj_val: 1.4194663763046265, obj_val: 1.3094466924667358, abs dis: 0.11001968383789062
[rfa agg] iter:  0, weight: tensor([0.0179, 0.0173, 0.0206, 0.0173, 0.0458, 0.0341, 0.0564, 0.0785, 0.0465,
        0.0883, 0.0640, 0.0494, 0.0549, 0.0397, 0.0382, 0.0652, 0.0812, 0.0726,
        0.0542, 0.0578])
[rfa agg] iter:  1, prev_obj_val: 1.3094466924667358, obj_val: 1.305265188217163, abs dis: 0.004181504249572754
[rfa agg] iter:  1, weight: tensor([0.0118, 0.0114, 0.0133, 0.0116, 0.0458, 0.0434, 0.0645, 0.0658, 0.0469,
        0.0766, 0.0609, 0.0455, 0.0608, 0.0550, 0.0485, 0.0740, 0.0653, 0.0687,
        0.0667, 0.0635])
[rfa agg] iter:  2, prev_obj_val: 1.305265188217163, obj_val: 1.3051562309265137, abs dis: 0.00010895729064941406
[rfa agg] iter:  2, weight: tensor([0.0110, 0.0107, 0.0124, 0.0108, 0.0449, 0.0459, 0.0662, 0.0626, 0.0458,
        0.0730, 0.0595, 0.0442, 0.0619, 0.0598, 0.0517, 0.0759, 0.0611, 0.0673,
        0.0702, 0.0649])
[rfa agg] iter:  3, prev_obj_val: 1.3051562309265137, obj_val: 1.3051531314849854, abs dis: 3.0994415283203125e-06
[rfa agg] iter:  3, weight: tensor([0.0109, 0.0106, 0.0123, 0.0107, 0.0447, 0.0464, 0.0664, 0.0620, 0.0456,
        0.0723, 0.0592, 0.0439, 0.0621, 0.0608, 0.0524, 0.0762, 0.0604, 0.0670,
        0.0708, 0.0653])
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0772, Accuracy: 9768/10000 (97.6800%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 8.8713, Accuracy: 39/8968 (0.4349%)
saving model
Done in 310.80259943008423 sec.
Server Epoch:13 choose agents : [41, 73, 51, 74, 13, 98, 78, 46, 45, 62, 50, 67, 14, 36, 24, 7, 4, 80, 39, 26].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0217, Accuracy: 355/606 (58.5809%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0130, Accuracy: 381/606 (62.8713%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 386/606 (63.6964%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0108, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0109, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0106, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0113, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Global model norm: 16.466280612718734.
Norm before scaling: 16.580084452120655. Distance: 3.6419147613538794
Total norm for 4 adversaries is: 16.580084452120655. distance: 3.6419147613538794
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8198, Accuracy: 5428/8968 (60.5263%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0241, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0232, Accuracy: 202/591 (34.1794%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0158, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0152, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0152, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0142, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0140, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0137, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0133, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Global model norm: 16.466280612718734.
Norm before scaling: 16.582474320494025. Distance: 3.6498433902534044
Total norm for 4 adversaries is: 16.582474320494025. distance: 3.6498433902534044
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8366, Accuracy: 5550/8968 (61.8867%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0194, Accuracy: 352/568 (61.9718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0121, Accuracy: 363/568 (63.9085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0102, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0105, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0102, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0099, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0099, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0094, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0091, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0094, Accuracy: 404/568 (71.1268%), train_poison_data_count: 180
Global model norm: 16.466280612718734.
Norm before scaling: 16.565011233559993. Distance: 3.276205927011317
Total norm for 4 adversaries is: 16.565011233559993. distance: 3.276205927011317
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.7415, Accuracy: 5595/8968 (62.3885%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0197, Accuracy: 338/557 (60.6822%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0103, Accuracy: 400/557 (71.8133%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0048, Accuracy: 501/557 (89.9461%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0035, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0024, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0027, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Global model norm: 16.466280612718734.
Norm before scaling: 16.674127256782906. Distance: 3.477667540758871
Total norm for 4 adversaries is: 16.674127256782906. distance: 3.477667540758871
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0853, Accuracy: 8659/8968 (96.5544%)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 719/734 (97.9564%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1808, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch  13, local model 98, internal_epoch   1,  Average loss: 0.0013, Accuracy: 793/818 (96.9438%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4453, Accuracy: 8568/10000 (85.6800%)
___Train Local_Simple,  epoch  13, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1263, Accuracy: 9603/10000 (96.0300%)
___Train Local_Simple,  epoch  13, local model 46, internal_epoch   1,  Average loss: 0.0018, Accuracy: 688/710 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2502, Accuracy: 9184/10000 (91.8400%)
___Train Local_Simple,  epoch  13, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 612/628 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2788, Accuracy: 9041/10000 (90.4100%)
___Train Local_Simple,  epoch  13, local model 62, internal_epoch   1,  Average loss: 0.0010, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1162, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1464, Accuracy: 9529/10000 (95.2900%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 978/998 (97.9960%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3008, Accuracy: 9051/10000 (90.5100%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1339, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch  13, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 985/1005 (98.0100%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1974, Accuracy: 9339/10000 (93.3900%)
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1102, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 406/418 (97.1292%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1304, Accuracy: 9571/10000 (95.7100%)
___Train Local_Simple,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2423, Accuracy: 9189/10000 (91.8900%)
___Train Local_Simple,  epoch  13, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1406, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  13, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.0926, Accuracy: 9710/10000 (97.1000%)
___Train Local_Simple,  epoch  13, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/554 (97.2924%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1194, Accuracy: 9625/10000 (96.2500%)
time spent on training: 307.7099401950836
[rfa agg] training data poison_ratio: 0.20212395543175488  data num: [606, 591, 568, 557, 734, 818, 303, 710, 628, 423, 474, 998, 376, 1005, 379, 418, 658, 431, 257, 554]
[rfa agg] considering poison per batch poison_fraction: 0.0631637360724234
[rfa agg] init. name: [41, 73, 51, 74, 13, 98, 78, 46, 45, 62, 50, 67, 14, 36, 24, 7, 4, 80, 39, 26], weight: tensor([0.0528, 0.0514, 0.0494, 0.0485, 0.0639, 0.0712, 0.0264, 0.0618, 0.0547,
        0.0368, 0.0413, 0.0869, 0.0327, 0.0875, 0.0330, 0.0364, 0.0573, 0.0375,
        0.0224, 0.0482])
[rfa agg] iter:  0, prev_obj_val: 1.3793619871139526, obj_val: 1.3059829473495483, abs dis: 0.0733790397644043
[rfa agg] iter:  0, weight: tensor([0.0163, 0.0159, 0.0174, 0.0155, 0.0630, 0.0642, 0.0388, 0.0619, 0.0668,
        0.0570, 0.0537, 0.0778, 0.0462, 0.0863, 0.0499, 0.0486, 0.0625, 0.0587,
        0.0385, 0.0612])
[rfa agg] iter:  1, prev_obj_val: 1.3059829473495483, obj_val: 1.3047107458114624, abs dis: 0.0012722015380859375
[rfa agg] iter:  1, weight: tensor([0.0123, 0.0120, 0.0129, 0.0118, 0.0585, 0.0591, 0.0448, 0.0561, 0.0651,
        0.0653, 0.0569, 0.0696, 0.0461, 0.0790, 0.0580, 0.0515, 0.0601, 0.0698,
        0.0497, 0.0617])
[rfa agg] iter:  2, prev_obj_val: 1.3047107458114624, obj_val: 1.3046952486038208, abs dis: 1.5497207641601562e-05
[rfa agg] iter:  2, weight: tensor([0.0119, 0.0116, 0.0125, 0.0115, 0.0578, 0.0582, 0.0461, 0.0548, 0.0645,
        0.0664, 0.0571, 0.0681, 0.0459, 0.0776, 0.0591, 0.0520, 0.0593, 0.0718,
        0.0519, 0.0617])
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0745, Accuracy: 9778/10000 (97.7800%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 8.7483, Accuracy: 42/8968 (0.4683%)
saving model
Done in 319.1760232448578 sec.
Server Epoch:14 choose agents : [41, 73, 51, 74, 29, 4, 42, 69, 95, 80, 8, 25, 68, 70, 61, 64, 31, 10, 23, 7].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0202, Accuracy: 359/606 (59.2409%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0145, Accuracy: 336/606 (55.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0115, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0108, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 460/606 (75.9076%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0103, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0106, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Global model norm: 16.450245140591274.
Norm before scaling: 16.59951090264503. Distance: 3.6692993220713968
Total norm for 4 adversaries is: 16.59951090264503. distance: 3.6692993220713968
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.0322, Accuracy: 4471/8968 (49.8550%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0249, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0232, Accuracy: 228/591 (38.5787%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0185, Accuracy: 205/591 (34.6870%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0171, Accuracy: 299/591 (50.5922%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0160, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0146, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0147, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0141, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0144, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0140, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Global model norm: 16.450245140591274.
Norm before scaling: 16.62365258285051. Distance: 4.464963575942929
Total norm for 4 adversaries is: 16.62365258285051. distance: 4.464963575942929
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.6795, Accuracy: 6741/8968 (75.1673%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0204, Accuracy: 336/568 (59.1549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0132, Accuracy: 364/568 (64.0845%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0116, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0115, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0107, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0101, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0103, Accuracy: 390/568 (68.6620%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0102, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0099, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0099, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Global model norm: 16.450245140591274.
Norm before scaling: 16.543777190252023. Distance: 3.5458068583688354
Total norm for 4 adversaries is: 16.543777190252023. distance: 3.5458068583688354
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.6432, Accuracy: 6248/8968 (69.6699%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0214, Accuracy: 327/557 (58.7074%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0101, Accuracy: 403/557 (72.3519%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0048, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0044, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0038, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0033, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0026, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0028, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Global model norm: 16.450245140591274.
Norm before scaling: 16.660866503764144. Distance: 3.4828216785363018
Total norm for 4 adversaries is: 16.660866503764144. distance: 3.4828216785363018
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1267, Accuracy: 8472/8968 (94.4692%)
___Train Local_Simple,  epoch  14, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 984/1002 (98.2036%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2371, Accuracy: 9228/10000 (92.2800%)
___Train Local_Simple,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 646/658 (98.1763%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1822, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 233/236 (98.7288%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1020, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  14, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 245/256 (95.7031%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1535, Accuracy: 9500/10000 (95.0000%)
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4278, Accuracy: 8629/10000 (86.2900%)
___Train Local_Simple,  epoch  14, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1633, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 614/633 (96.9984%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1418, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0015, Accuracy: 631/647 (97.5270%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2693, Accuracy: 9141/10000 (91.4100%)
___Train Local_Simple,  epoch  14, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 484/494 (97.9757%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1318, Accuracy: 9567/10000 (95.6700%)
___Train Local_Simple,  epoch  14, local model 70, internal_epoch   1,  Average loss: 0.0016, Accuracy: 701/724 (96.8232%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1471, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch  14, local model 61, internal_epoch   1,  Average loss: 0.0013, Accuracy: 681/699 (97.4249%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2043, Accuracy: 9344/10000 (93.4400%)
___Train Local_Simple,  epoch  14, local model 64, internal_epoch   1,  Average loss: 0.0014, Accuracy: 795/813 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1641, Accuracy: 9458/10000 (94.5800%)
___Train Local_Simple,  epoch  14, local model 31, internal_epoch   1,  Average loss: 0.0012, Accuracy: 814/835 (97.4850%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1309, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 862/892 (96.6368%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3187, Accuracy: 8960/10000 (89.6000%)
___Train Local_Simple,  epoch  14, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1110, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 408/418 (97.6077%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1242, Accuracy: 9596/10000 (95.9600%)
time spent on training: 306.51456809043884
[rfa agg] training data poison_ratio: 0.19422835633626098  data num: [606, 591, 568, 557, 1002, 658, 236, 256, 602, 431, 633, 647, 494, 724, 699, 813, 835, 892, 293, 418]
[rfa agg] considering poison per batch poison_fraction: 0.06069636135508156
[rfa agg] init. name: [41, 73, 51, 74, 29, 4, 42, 69, 95, 80, 8, 25, 68, 70, 61, 64, 31, 10, 23, 7], weight: tensor([0.0507, 0.0494, 0.0475, 0.0466, 0.0838, 0.0550, 0.0197, 0.0214, 0.0504,
        0.0361, 0.0529, 0.0541, 0.0413, 0.0606, 0.0585, 0.0680, 0.0698, 0.0746,
        0.0245, 0.0350])
[rfa agg] iter:  0, prev_obj_val: 1.43026864528656, obj_val: 1.3457512855529785, abs dis: 0.08451735973358154
[rfa agg] iter:  0, weight: tensor([0.0162, 0.0129, 0.0160, 0.0156, 0.0848, 0.0661, 0.0327, 0.0341, 0.0632,
        0.0517, 0.0628, 0.0571, 0.0523, 0.0606, 0.0714, 0.0756, 0.0752, 0.0634,
        0.0401, 0.0482])
[rfa agg] iter:  1, prev_obj_val: 1.3457512855529785, obj_val: 1.3442269563674927, abs dis: 0.0015243291854858398
[rfa agg] iter:  1, weight: tensor([0.0120, 0.0096, 0.0117, 0.0116, 0.0770, 0.0695, 0.0430, 0.0426, 0.0649,
        0.0570, 0.0614, 0.0507, 0.0541, 0.0571, 0.0704, 0.0752, 0.0728, 0.0534,
        0.0532, 0.0527])
[rfa agg] iter:  2, prev_obj_val: 1.3442269563674927, obj_val: 1.3442100286483765, abs dis: 1.6927719116210938e-05
[rfa agg] iter:  2, weight: tensor([0.0117, 0.0094, 0.0114, 0.0113, 0.0754, 0.0703, 0.0445, 0.0438, 0.0651,
        0.0578, 0.0608, 0.0495, 0.0544, 0.0566, 0.0697, 0.0751, 0.0722, 0.0520,
        0.0558, 0.0533])
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0735, Accuracy: 9782/10000 (97.8200%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 8.1147, Accuracy: 52/8968 (0.5798%)
saving model
Done in 317.897661447525 sec.
Server Epoch:15 choose agents : [41, 73, 51, 74, 46, 65, 57, 83, 9, 64, 58, 12, 96, 90, 28, 33, 75, 13, 32, 80].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0185, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 363/606 (59.9010%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0116, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 397/606 (65.5116%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0110, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0104, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0104, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0105, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Global model norm: 16.434683322716285.
Norm before scaling: 16.55034470674582. Distance: 3.5009243970573163
Total norm for 4 adversaries is: 16.55034470674582. distance: 3.5009243970573163
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.9281, Accuracy: 4468/8968 (49.8216%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0233, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0213, Accuracy: 240/591 (40.6091%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0148, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0145, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0136, Accuracy: 373/591 (63.1134%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0135, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0137, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0135, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0130, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0128, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Global model norm: 16.434683322716285.
Norm before scaling: 16.52506825581592. Distance: 3.231537979840083
Total norm for 4 adversaries is: 16.52506825581592. distance: 3.231537979840083
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.8978, Accuracy: 4547/8968 (50.7025%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0185, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0128, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0111, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0105, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0102, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0098, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0098, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0094, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0096, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0093, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Global model norm: 16.434683322716285.
Norm before scaling: 16.500525263893117. Distance: 3.13150857249924
Total norm for 4 adversaries is: 16.500525263893117. distance: 3.13150857249924
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.6230, Accuracy: 6664/8968 (74.3087%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0198, Accuracy: 340/557 (61.0413%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0094, Accuracy: 404/557 (72.5314%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0057, Accuracy: 486/557 (87.2531%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0038, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0037, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0028, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0025, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0022, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Global model norm: 16.434683322716285.
Norm before scaling: 16.603717690990454. Distance: 3.1102289148699436
Total norm for 4 adversaries is: 16.603717690990454. distance: 3.1102289148699436
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1780, Accuracy: 8242/8968 (91.9045%)
___Train Local_Simple,  epoch  15, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1758, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch  15, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1119, Accuracy: 9642/10000 (96.4200%)
___Train Local_Simple,  epoch  15, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1603, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  15, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 426/433 (98.3834%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0917, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 427/436 (97.9358%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1544, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  15, local model 64, internal_epoch   1,  Average loss: 0.0013, Accuracy: 792/813 (97.4170%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3668, Accuracy: 8730/10000 (87.3000%)
___Train Local_Simple,  epoch  15, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1293, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1114/1160 (96.0345%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1887, Accuracy: 9405/10000 (94.0500%)
___Train Local_Simple,  epoch  15, local model 96, internal_epoch   1,  Average loss: 0.0016, Accuracy: 659/672 (98.0655%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1180, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  15, local model 90, internal_epoch   1,  Average loss: 0.0016, Accuracy: 666/683 (97.5110%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4046, Accuracy: 8643/10000 (86.4300%)
___Train Local_Simple,  epoch  15, local model 28, internal_epoch   1,  Average loss: 0.0012, Accuracy: 490/501 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1080, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  15, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 603/623 (96.7897%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1626, Accuracy: 9454/10000 (94.5400%)
___Train Local_Simple,  epoch  15, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 673/686 (98.1050%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1223, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 717/734 (97.6839%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1941, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  15, local model 32, internal_epoch   1,  Average loss: 0.0015, Accuracy: 953/977 (97.5435%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2910, Accuracy: 9027/10000 (90.2700%)
___Train Local_Simple,  epoch  15, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2509, Accuracy: 9256/10000 (92.5600%)
time spent on training: 301.5405149459839
[rfa agg] training data poison_ratio: 0.19078136554104017  data num: [606, 591, 568, 557, 710, 371, 343, 433, 436, 813, 276, 1160, 672, 683, 501, 623, 686, 734, 977, 431]
[rfa agg] considering poison per batch poison_fraction: 0.05961917673157505
[rfa agg] init. name: [41, 73, 51, 74, 46, 65, 57, 83, 9, 64, 58, 12, 96, 90, 28, 33, 75, 13, 32, 80], weight: tensor([0.0498, 0.0486, 0.0467, 0.0458, 0.0583, 0.0305, 0.0282, 0.0356, 0.0358,
        0.0668, 0.0227, 0.0953, 0.0552, 0.0561, 0.0412, 0.0512, 0.0564, 0.0603,
        0.0803, 0.0354])
[rfa agg] iter:  0, prev_obj_val: 1.3395237922668457, obj_val: 1.2834558486938477, abs dis: 0.05606794357299805
[rfa agg] iter:  0, weight: tensor([0.0159, 0.0169, 0.0169, 0.0164, 0.0631, 0.0488, 0.0419, 0.0597, 0.0512,
        0.0667, 0.0330, 0.0630, 0.0701, 0.0591, 0.0588, 0.0598, 0.0663, 0.0657,
        0.0762, 0.0506])
[rfa agg] iter:  1, prev_obj_val: 1.2834558486938477, obj_val: 1.2825169563293457, abs dis: 0.0009388923645019531
[rfa agg] iter:  1, weight: tensor([0.0126, 0.0134, 0.0132, 0.0131, 0.0610, 0.0572, 0.0427, 0.0705, 0.0565,
        0.0641, 0.0341, 0.0532, 0.0726, 0.0561, 0.0644, 0.0588, 0.0687, 0.0625,
        0.0709, 0.0545])
[rfa agg] iter:  2, prev_obj_val: 1.2825169563293457, obj_val: 1.2825075387954712, abs dis: 9.417533874511719e-06
[rfa agg] iter:  2, weight: tensor([0.0123, 0.0131, 0.0129, 0.0128, 0.0606, 0.0586, 0.0425, 0.0721, 0.0572,
        0.0637, 0.0341, 0.0520, 0.0729, 0.0557, 0.0652, 0.0585, 0.0691, 0.0619,
        0.0700, 0.0550])
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.0711, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 8.8369, Accuracy: 32/8968 (0.3568%)
saving model
Done in 312.84476590156555 sec.
Server Epoch:16 choose agents : [41, 73, 51, 74, 23, 25, 12, 58, 19, 11, 13, 82, 50, 34, 14, 55, 53, 36, 6, 47].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0205, Accuracy: 356/606 (58.7459%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0143, Accuracy: 346/606 (57.0957%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0113, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0108, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0106, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0104, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0095, Accuracy: 448/606 (73.9274%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.424744040528456.
Norm before scaling: 16.586251211411422. Distance: 3.611860732172324
Total norm for 4 adversaries is: 16.586251211411422. distance: 3.611860732172324
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.9846, Accuracy: 4324/8968 (48.2159%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0247, Accuracy: 333/591 (56.3452%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0226, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0155, Accuracy: 322/591 (54.4839%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0153, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0147, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0138, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0136, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0133, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0125, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Global model norm: 16.424744040528456.
Norm before scaling: 16.60058085333067. Distance: 3.8555281150444793
Total norm for 4 adversaries is: 16.60058085333067. distance: 3.8555281150444793
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.9319, Accuracy: 4696/8968 (52.3640%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0194, Accuracy: 340/568 (59.8592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0125, Accuracy: 342/568 (60.2113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0106, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0105, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0100, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0096, Accuracy: 403/568 (70.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0094, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0092, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0090, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0089, Accuracy: 414/568 (72.8873%), train_poison_data_count: 180
Global model norm: 16.424744040528456.
Norm before scaling: 16.530473716118873. Distance: 3.3595192102041134
Total norm for 4 adversaries is: 16.530473716118873. distance: 3.3595192102041134
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.7722, Accuracy: 5374/8968 (59.9242%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0195, Accuracy: 328/557 (58.8869%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0105, Accuracy: 413/557 (74.1472%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0044, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0041, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0026, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0031, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0023, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Global model norm: 16.424744040528456.
Norm before scaling: 16.621640432402046. Distance: 3.5192287031362466
Total norm for 4 adversaries is: 16.621640432402046. distance: 3.5192287031362466
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1095, Accuracy: 8541/8968 (95.2386%)
___Train Local_Simple,  epoch  16, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1300, Accuracy: 9554/10000 (95.5400%)
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3805, Accuracy: 8742/10000 (87.4200%)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1125/1160 (96.9828%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2766, Accuracy: 9140/10000 (91.4000%)
___Train Local_Simple,  epoch  16, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1135, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch  16, local model 19, internal_epoch   1,  Average loss: 0.0014, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.0950, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 627/645 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1685, Accuracy: 9460/10000 (94.6000%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 720/734 (98.0926%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3230, Accuracy: 9070/10000 (90.7000%)
___Train Local_Simple,  epoch  16, local model 82, internal_epoch   1,  Average loss: 0.0013, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4120, Accuracy: 8717/10000 (87.1700%)
___Train Local_Simple,  epoch  16, local model 50, internal_epoch   1,  Average loss: 0.0017, Accuracy: 455/474 (95.9916%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2034, Accuracy: 9374/10000 (93.7400%)
___Train Local_Simple,  epoch  16, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 408/413 (98.7893%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2190, Accuracy: 9320/10000 (93.2000%)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 365/376 (97.0745%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1179, Accuracy: 9662/10000 (96.6200%)
___Train Local_Simple,  epoch  16, local model 55, internal_epoch   1,  Average loss: 0.0014, Accuracy: 344/354 (97.1751%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2132, Accuracy: 9285/10000 (92.8500%)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2392, Accuracy: 9295/10000 (92.9500%)
___Train Local_Simple,  epoch  16, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 978/1005 (97.3134%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3276, Accuracy: 8947/10000 (89.4700%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3010, Accuracy: 9060/10000 (90.6000%)
___Train Local_Simple,  epoch  16, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 766/776 (98.7113%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2109, Accuracy: 9366/10000 (93.6600%)
time spent on training: 318.8025712966919
[rfa agg] training data poison_ratio: 0.19766748957180558  data num: [606, 591, 568, 557, 293, 647, 1160, 276, 205, 645, 734, 713, 474, 413, 376, 354, 739, 1005, 615, 776]
[rfa agg] considering poison per batch poison_fraction: 0.06177109049118924
[rfa agg] init. name: [41, 73, 51, 74, 23, 25, 12, 58, 19, 11, 13, 82, 50, 34, 14, 55, 53, 36, 6, 47], weight: tensor([0.0516, 0.0503, 0.0484, 0.0474, 0.0249, 0.0551, 0.0987, 0.0235, 0.0175,
        0.0549, 0.0625, 0.0607, 0.0404, 0.0352, 0.0320, 0.0301, 0.0629, 0.0856,
        0.0524, 0.0661])
[rfa agg] iter:  0, prev_obj_val: 1.4414639472961426, obj_val: 1.3772929906845093, abs dis: 0.0641709566116333
[rfa agg] iter:  0, weight: tensor([0.0169, 0.0154, 0.0173, 0.0158, 0.0423, 0.0614, 0.0750, 0.0363, 0.0318,
        0.0592, 0.0687, 0.0620, 0.0527, 0.0518, 0.0523, 0.0432, 0.0800, 0.0759,
        0.0652, 0.0768])
[rfa agg] iter:  1, prev_obj_val: 1.3772929906845093, obj_val: 1.3762474060058594, abs dis: 0.0010455846786499023
[rfa agg] iter:  1, weight: tensor([0.0132, 0.0121, 0.0134, 0.0125, 0.0549, 0.0585, 0.0644, 0.0401, 0.0413,
        0.0589, 0.0667, 0.0579, 0.0536, 0.0556, 0.0556, 0.0448, 0.0827, 0.0681,
        0.0660, 0.0797])
[rfa agg] iter:  2, prev_obj_val: 1.3762474060058594, obj_val: 1.3762354850769043, abs dis: 1.1920928955078125e-05
[rfa agg] iter:  2, weight: tensor([0.0129, 0.0118, 0.0131, 0.0122, 0.0576, 0.0580, 0.0628, 0.0405, 0.0429,
        0.0589, 0.0662, 0.0572, 0.0535, 0.0559, 0.0558, 0.0448, 0.0829, 0.0669,
        0.0660, 0.0802])
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.0737, Accuracy: 9771/10000 (97.7100%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 8.0250, Accuracy: 58/8968 (0.6467%)
saving model
Done in 330.2024416923523 sec.
Server Epoch:17 choose agents : [41, 73, 51, 74, 92, 37, 43, 17, 2, 66, 6, 38, 45, 81, 4, 24, 54, 10, 11, 80].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0202, Accuracy: 345/606 (56.9307%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0143, Accuracy: 332/606 (54.7855%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0111, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0113, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0108, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0107, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Global model norm: 16.407791966228462.
Norm before scaling: 16.523833661031023. Distance: 3.5278852518152553
Total norm for 4 adversaries is: 16.523833661031023. distance: 3.5278852518152553
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.9741, Accuracy: 4599/8968 (51.2823%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0220, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0194, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0170, Accuracy: 296/591 (50.0846%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0148, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0145, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0133, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0132, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0126, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0129, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0125, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Global model norm: 16.407791966228462.
Norm before scaling: 16.527450384464554. Distance: 3.272773037937266
Total norm for 4 adversaries is: 16.527450384464554. distance: 3.272773037937266
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.8443, Accuracy: 4811/8968 (53.6463%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0168, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0123, Accuracy: 340/568 (59.8592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0106, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0104, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0098, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0092, Accuracy: 417/568 (73.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0090, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0089, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0084, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0085, Accuracy: 415/568 (73.0634%), train_poison_data_count: 180
Global model norm: 16.407791966228462.
Norm before scaling: 16.444211104745094. Distance: 2.801942294706258
Total norm for 4 adversaries is: 16.444211104745094. distance: 2.801942294706258
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.6165, Accuracy: 6606/8968 (73.6619%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0178, Accuracy: 359/557 (64.4524%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0098, Accuracy: 430/557 (77.1993%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0050, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0035, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0033, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0026, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0026, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.407791966228462.
Norm before scaling: 16.59599539010183. Distance: 3.140535875260983
Total norm for 4 adversaries is: 16.59599539010183. distance: 3.140535875260983
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0970, Accuracy: 8593/8968 (95.8185%)
___Train Local_Simple,  epoch  17, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 913/937 (97.4386%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2491, Accuracy: 9161/10000 (91.6100%)
___Train Local_Simple,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 848/860 (98.6047%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3736, Accuracy: 8891/10000 (88.9100%)
___Train Local_Simple,  epoch  17, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1877, Accuracy: 9374/10000 (93.7400%)
___Train Local_Simple,  epoch  17, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1353, Accuracy: 9585/10000 (95.8500%)
___Train Local_Simple,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1392, Accuracy: 9550/10000 (95.5000%)
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0010, Accuracy: 645/660 (97.7273%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3265, Accuracy: 8852/10000 (88.5200%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 602/615 (97.8862%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2125, Accuracy: 9294/10000 (92.9400%)
___Train Local_Simple,  epoch  17, local model 38, internal_epoch   1,  Average loss: 0.0014, Accuracy: 867/895 (96.8715%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0636, Accuracy: 8065/10000 (80.6500%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0015, Accuracy: 613/628 (97.6115%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5568, Accuracy: 8010/10000 (80.1000%)
___Train Local_Simple,  epoch  17, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1212/1227 (98.7775%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1940, Accuracy: 9382/10000 (93.8200%)
___Train Local_Simple,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 644/658 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1207, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  17, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 366/379 (96.5699%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1129, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  17, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2613, Accuracy: 9188/10000 (91.8800%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 875/892 (98.0942%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4641, Accuracy: 8723/10000 (87.2300%)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 633/645 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1957, Accuracy: 9356/10000 (93.5600%)
___Train Local_Simple,  epoch  17, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1443, Accuracy: 9579/10000 (95.7900%)
time spent on training: 318.90727043151855
[rfa agg] training data poison_ratio: 0.17532467532467533  data num: [606, 591, 568, 557, 937, 860, 408, 620, 548, 660, 615, 895, 628, 1227, 658, 379, 519, 892, 645, 431]
[rfa agg] considering poison per batch poison_fraction: 0.05478896103896104
[rfa agg] init. name: [41, 73, 51, 74, 92, 37, 43, 17, 2, 66, 6, 38, 45, 81, 4, 24, 54, 10, 11, 80], weight: tensor([0.0458, 0.0446, 0.0429, 0.0421, 0.0707, 0.0649, 0.0308, 0.0468, 0.0414,
        0.0498, 0.0464, 0.0676, 0.0474, 0.0926, 0.0497, 0.0286, 0.0392, 0.0674,
        0.0487, 0.0325])
[rfa agg] iter:  0, prev_obj_val: 1.2773042917251587, obj_val: 1.2353562116622925, abs dis: 0.04194808006286621
[rfa agg] iter:  0, weight: tensor([0.0139, 0.0147, 0.0164, 0.0144, 0.0721, 0.0762, 0.0501, 0.0551, 0.0582,
        0.0519, 0.0612, 0.0493, 0.0474, 0.0901, 0.0652, 0.0459, 0.0445, 0.0671,
        0.0561, 0.0503])
[rfa agg] iter:  1, prev_obj_val: 1.2353562116622925, obj_val: 1.2350326776504517, abs dis: 0.0003235340118408203
[rfa agg] iter:  1, weight: tensor([0.0117, 0.0124, 0.0137, 0.0122, 0.0699, 0.0729, 0.0549, 0.0550, 0.0601,
        0.0515, 0.0636, 0.0453, 0.0464, 0.0907, 0.0692, 0.0508, 0.0441, 0.0644,
        0.0579, 0.0535])
[rfa agg] iter:  2, prev_obj_val: 1.2350326776504517, obj_val: 1.235031008720398, abs dis: 1.6689300537109375e-06
[rfa agg] iter:  2, weight: tensor([0.0116, 0.0122, 0.0135, 0.0120, 0.0695, 0.0723, 0.0553, 0.0550, 0.0603,
        0.0515, 0.0638, 0.0449, 0.0463, 0.0909, 0.0697, 0.0512, 0.0440, 0.0640,
        0.0582, 0.0538])
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.0674, Accuracy: 9784/10000 (97.8400%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 8.7466, Accuracy: 22/8968 (0.2453%)
saving model
Done in 330.31811332702637 sec.
Server Epoch:18 choose agents : [41, 73, 51, 74, 7, 72, 14, 99, 12, 93, 25, 34, 57, 69, 58, 2, 4, 1, 20, 49].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0200, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0135, Accuracy: 355/606 (58.5809%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0114, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0108, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Global model norm: 16.387946449093594.
Norm before scaling: 16.479638685691427. Distance: 3.3785606251609845
Total norm for 4 adversaries is: 16.479638685691427. distance: 3.3785606251609845
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.7912, Accuracy: 5844/8968 (65.1650%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0240, Accuracy: 322/591 (54.4839%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0219, Accuracy: 236/591 (39.9323%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0157, Accuracy: 310/591 (52.4535%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0147, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0136, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0135, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0132, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0132, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0126, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0122, Accuracy: 388/591 (65.6514%), train_poison_data_count: 195
Global model norm: 16.387946449093594.
Norm before scaling: 16.508189625365684. Distance: 3.405653735127285
Total norm for 4 adversaries is: 16.508189625365684. distance: 3.405653735127285
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.7315, Accuracy: 5563/8968 (62.0317%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0184, Accuracy: 350/568 (61.6197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0125, Accuracy: 329/568 (57.9225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0112, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0100, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0097, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0092, Accuracy: 403/568 (70.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0088, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0085, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0083, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0079, Accuracy: 418/568 (73.5915%), train_poison_data_count: 180
Global model norm: 16.387946449093594.
Norm before scaling: 16.49083848402652. Distance: 3.276519562635929
Total norm for 4 adversaries is: 16.49083848402652. distance: 3.276519562635929
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.4379, Accuracy: 7590/8968 (84.6343%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0192, Accuracy: 341/557 (61.2208%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0092, Accuracy: 430/557 (77.1993%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0039, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0038, Accuracy: 507/557 (91.0233%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0031, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0023, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0021, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Global model norm: 16.387946449093594.
Norm before scaling: 16.56116131824651. Distance: 3.1604756687786564
Total norm for 4 adversaries is: 16.56116131824651. distance: 3.1604756687786564
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1198, Accuracy: 8505/8968 (94.8372%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0008, Accuracy: 412/418 (98.5646%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1507, Accuracy: 9498/10000 (94.9800%)
___Train Local_Simple,  epoch  18, local model 72, internal_epoch   1,  Average loss: 0.0008, Accuracy: 717/731 (98.0848%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2809, Accuracy: 9058/10000 (90.5800%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 366/376 (97.3404%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0968, Accuracy: 9704/10000 (97.0400%)
___Train Local_Simple,  epoch  18, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0909, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1133/1160 (97.6724%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2014, Accuracy: 9392/10000 (93.9200%)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1989, Accuracy: 9340/10000 (93.4000%)
___Train Local_Simple,  epoch  18, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 631/647 (97.5270%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7548, Accuracy: 7777/10000 (77.7700%)
___Train Local_Simple,  epoch  18, local model 34, internal_epoch   1,  Average loss: 0.0006, Accuracy: 409/413 (99.0315%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1546, Accuracy: 9525/10000 (95.2500%)
___Train Local_Simple,  epoch  18, local model 57, internal_epoch   1,  Average loss: 0.0021, Accuracy: 329/343 (95.9184%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1667, Accuracy: 9448/10000 (94.4800%)
___Train Local_Simple,  epoch  18, local model 69, internal_epoch   1,  Average loss: 0.0014, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1063, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1104, Accuracy: 9662/10000 (96.6200%)
___Train Local_Simple,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 541/548 (98.7226%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1591, Accuracy: 9474/10000 (94.7400%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 648/658 (98.4802%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1877, Accuracy: 9399/10000 (93.9900%)
___Train Local_Simple,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0013, Accuracy: 744/760 (97.8947%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2064, Accuracy: 9275/10000 (92.7500%)
___Train Local_Simple,  epoch  18, local model 20, internal_epoch   1,  Average loss: 0.0016, Accuracy: 416/429 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1763, Accuracy: 9432/10000 (94.3200%)
___Train Local_Simple,  epoch  18, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 497/506 (98.2213%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1439, Accuracy: 9542/10000 (95.4200%)
time spent on training: 321.9402358531952
[rfa agg] training data poison_ratio: 0.214147376187402  data num: [606, 591, 568, 557, 418, 731, 376, 377, 1160, 623, 647, 413, 343, 256, 276, 548, 658, 760, 429, 506]
[rfa agg] considering poison per batch poison_fraction: 0.06692105505856313
[rfa agg] init. name: [41, 73, 51, 74, 7, 72, 14, 99, 12, 93, 25, 34, 57, 69, 58, 2, 4, 1, 20, 49], weight: tensor([0.0559, 0.0545, 0.0524, 0.0514, 0.0386, 0.0674, 0.0347, 0.0348, 0.1070,
        0.0575, 0.0597, 0.0381, 0.0316, 0.0236, 0.0255, 0.0505, 0.0607, 0.0701,
        0.0396, 0.0467])
[rfa agg] iter:  0, prev_obj_val: 1.3357130289077759, obj_val: 1.2595155239105225, abs dis: 0.07619750499725342
[rfa agg] iter:  0, weight: tensor([0.0185, 0.0178, 0.0179, 0.0177, 0.0557, 0.0726, 0.0509, 0.0555, 0.0820,
        0.0667, 0.0527, 0.0544, 0.0485, 0.0358, 0.0364, 0.0684, 0.0720, 0.0669,
        0.0495, 0.0601])
[rfa agg] iter:  1, prev_obj_val: 1.2595155239105225, obj_val: 1.2577375173568726, abs dis: 0.0017780065536499023
[rfa agg] iter:  1, weight: tensor([0.0135, 0.0130, 0.0130, 0.0132, 0.0617, 0.0694, 0.0541, 0.0698, 0.0699,
        0.0671, 0.0454, 0.0599, 0.0498, 0.0452, 0.0396, 0.0689, 0.0761, 0.0610,
        0.0473, 0.0622])
[rfa agg] iter:  2, prev_obj_val: 1.2577375173568726, obj_val: 1.257711410522461, abs dis: 2.6106834411621094e-05
[rfa agg] iter:  2, weight: tensor([0.0130, 0.0125, 0.0126, 0.0127, 0.0621, 0.0689, 0.0540, 0.0730, 0.0679,
        0.0676, 0.0442, 0.0603, 0.0492, 0.0473, 0.0399, 0.0681, 0.0775, 0.0600,
        0.0465, 0.0626])
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.0668, Accuracy: 9791/10000 (97.9100%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 7.4749, Accuracy: 63/8968 (0.7025%)
saving model
Done in 334.06192111968994 sec.
Server Epoch:19 choose agents : [41, 73, 51, 74, 57, 27, 43, 49, 0, 45, 25, 8, 12, 55, 26, 62, 65, 54, 94, 68].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0174, Accuracy: 391/606 (64.5215%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0127, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0118, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Global model norm: 16.37468876433706.
Norm before scaling: 16.459633202063902. Distance: 3.2145039227002314
Total norm for 4 adversaries is: 16.459633202063902. distance: 3.2145039227002314
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8564, Accuracy: 5004/8968 (55.7984%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0242, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0232, Accuracy: 189/591 (31.9797%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0164, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0152, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0140, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0141, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0130, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0121, Accuracy: 397/591 (67.1743%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0109, Accuracy: 426/591 (72.0812%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0110, Accuracy: 419/591 (70.8968%), train_poison_data_count: 195
Global model norm: 16.37468876433706.
Norm before scaling: 16.55867898878155. Distance: 3.769099994558639
Total norm for 4 adversaries is: 16.55867898878155. distance: 3.769099994558639
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4286, Accuracy: 8024/8968 (89.4737%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0165, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0108, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0102, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0101, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0095, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0091, Accuracy: 408/568 (71.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0087, Accuracy: 413/568 (72.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0087, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0082, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0079, Accuracy: 420/568 (73.9437%), train_poison_data_count: 180
Global model norm: 16.37468876433706.
Norm before scaling: 16.501544302139383. Distance: 3.2480868063540616
Total norm for 4 adversaries is: 16.501544302139383. distance: 3.2480868063540616
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4468, Accuracy: 8102/8968 (90.3434%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0170, Accuracy: 365/557 (65.5296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0072, Accuracy: 463/557 (83.1239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.37468876433706.
Norm before scaling: 16.524571474091054. Distance: 2.8280896769472696
Total norm for 4 adversaries is: 16.524571474091054. distance: 2.8280896769472696
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0799, Accuracy: 8658/8968 (96.5433%)
___Train Local_Simple,  epoch  19, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1494, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch  19, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 457/471 (97.0276%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2327, Accuracy: 9217/10000 (92.1700%)
___Train Local_Simple,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1043, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch  19, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 497/506 (98.2213%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1598, Accuracy: 9496/10000 (94.9600%)
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 421/435 (96.7816%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1378, Accuracy: 9557/10000 (95.5700%)
___Train Local_Simple,  epoch  19, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3158, Accuracy: 8884/10000 (88.8400%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2197, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 611/633 (96.5245%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1110, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1131/1160 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3645, Accuracy: 9047/10000 (90.4700%)
___Train Local_Simple,  epoch  19, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 346/354 (97.7401%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1818, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 544/554 (98.1949%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1039, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch  19, local model 62, internal_epoch   1,  Average loss: 0.0007, Accuracy: 417/423 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0844, Accuracy: 9730/10000 (97.3000%)
___Train Local_Simple,  epoch  19, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0908, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch  19, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 506/519 (97.4952%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2150, Accuracy: 9333/10000 (93.3300%)
___Train Local_Simple,  epoch  19, local model 94, internal_epoch   1,  Average loss: 0.0015, Accuracy: 148/150 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1039, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  19, local model 68, internal_epoch   1,  Average loss: 0.0010, Accuracy: 487/494 (98.5830%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1138, Accuracy: 9616/10000 (96.1600%)
time spent on training: 301.59333539009094
[rfa agg] training data poison_ratio: 0.22288347091572278  data num: [606, 591, 568, 557, 343, 471, 408, 506, 435, 628, 647, 633, 1160, 354, 554, 423, 371, 519, 150, 494]
[rfa agg] considering poison per batch poison_fraction: 0.06965108466116336
[rfa agg] init. name: [41, 73, 51, 74, 57, 27, 43, 49, 0, 45, 25, 8, 12, 55, 26, 62, 65, 54, 94, 68], weight: tensor([0.0582, 0.0567, 0.0545, 0.0535, 0.0329, 0.0452, 0.0392, 0.0486, 0.0418,
        0.0603, 0.0621, 0.0608, 0.1113, 0.0340, 0.0532, 0.0406, 0.0356, 0.0498,
        0.0144, 0.0474])
[rfa agg] iter:  0, prev_obj_val: 1.3203428983688354, obj_val: 1.243577003479004, abs dis: 0.07676589488983154
[rfa agg] iter:  0, weight: tensor([0.0192, 0.0158, 0.0178, 0.0199, 0.0481, 0.0505, 0.0563, 0.0630, 0.0520,
        0.0606, 0.0662, 0.0656, 0.0888, 0.0462, 0.0723, 0.0641, 0.0523, 0.0546,
        0.0244, 0.0622])
[rfa agg] iter:  1, prev_obj_val: 1.243577003479004, obj_val: 1.241883635520935, abs dis: 0.0016933679580688477
[rfa agg] iter:  1, weight: tensor([0.0139, 0.0116, 0.0130, 0.0146, 0.0496, 0.0478, 0.0632, 0.0651, 0.0526,
        0.0559, 0.0606, 0.0595, 0.0745, 0.0458, 0.0793, 0.0823, 0.0628, 0.0509,
        0.0328, 0.0642])
[rfa agg] iter:  2, prev_obj_val: 1.241883635520935, obj_val: 1.2418617010116577, abs dis: 2.193450927734375e-05
[rfa agg] iter:  2, weight: tensor([0.0134, 0.0112, 0.0125, 0.0141, 0.0492, 0.0473, 0.0641, 0.0652, 0.0526,
        0.0552, 0.0595, 0.0583, 0.0721, 0.0454, 0.0804, 0.0862, 0.0646, 0.0500,
        0.0343, 0.0643])
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0686, Accuracy: 9780/10000 (97.8000%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 7.5190, Accuracy: 53/8968 (0.5910%)
saving model
Done in 313.1326766014099 sec.
Server Epoch:20 choose agents : [41, 73, 51, 74, 33, 58, 10, 13, 81, 37, 94, 61, 57, 60, 92, 23, 39, 79, 86, 63].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0183, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0146, Accuracy: 342/606 (56.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Global model norm: 16.364282260054022.
Norm before scaling: 16.410378014896455. Distance: 2.9439376738833927
Total norm for 4 adversaries is: 16.410378014896455. distance: 2.9439376738833927
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.9248, Accuracy: 4610/8968 (51.4050%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0261, Accuracy: 321/591 (54.3147%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0198, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0149, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0147, Accuracy: 320/591 (54.1455%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0137, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0136, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0129, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0125, Accuracy: 399/591 (67.5127%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0123, Accuracy: 389/591 (65.8206%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0120, Accuracy: 395/591 (66.8359%), train_poison_data_count: 195
Global model norm: 16.364282260054022.
Norm before scaling: 16.56007960645919. Distance: 3.6586172151597096
Total norm for 4 adversaries is: 16.56007960645919. distance: 3.6586172151597096
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.8458, Accuracy: 5034/8968 (56.1329%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0179, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0127, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0117, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0114, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0096, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0098, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0089, Accuracy: 415/568 (73.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0083, Accuracy: 431/568 (75.8803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0077, Accuracy: 453/568 (79.7535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0076, Accuracy: 466/568 (82.0423%), train_poison_data_count: 180
Global model norm: 16.364282260054022.
Norm before scaling: 16.419493352807528. Distance: 3.07203234000866
Total norm for 4 adversaries is: 16.419493352807528. distance: 3.07203234000866
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2546, Accuracy: 8612/8968 (96.0303%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0166, Accuracy: 372/557 (66.7864%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0074, Accuracy: 458/557 (82.2262%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0037, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.364282260054022.
Norm before scaling: 16.54892943454916. Distance: 2.967898276773383
Total norm for 4 adversaries is: 16.54892943454916. distance: 2.967898276773383
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0784, Accuracy: 8658/8968 (96.5433%)
___Train Local_Simple,  epoch  20, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/623 (97.2713%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1876, Accuracy: 9349/10000 (93.4900%)
___Train Local_Simple,  epoch  20, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1046, Accuracy: 9681/10000 (96.8100%)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 873/892 (97.8700%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2608, Accuracy: 9101/10000 (91.0100%)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 722/734 (98.3651%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1669, Accuracy: 9486/10000 (94.8600%)
___Train Local_Simple,  epoch  20, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1210/1227 (98.6145%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1928, Accuracy: 9365/10000 (93.6500%)
___Train Local_Simple,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2818, Accuracy: 9141/10000 (91.4100%)
___Train Local_Simple,  epoch  20, local model 94, internal_epoch   1,  Average loss: 0.0014, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1054, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch  20, local model 61, internal_epoch   1,  Average loss: 0.0013, Accuracy: 683/699 (97.7110%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1500, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  20, local model 57, internal_epoch   1,  Average loss: 0.0027, Accuracy: 326/343 (95.0437%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2892, Accuracy: 9088/10000 (90.8800%)
___Train Local_Simple,  epoch  20, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 328/338 (97.0414%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1030, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  20, local model 92, internal_epoch   1,  Average loss: 0.0010, Accuracy: 920/937 (98.1857%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2479, Accuracy: 9180/10000 (91.8000%)
___Train Local_Simple,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1048, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  20, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 251/257 (97.6654%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1051, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  20, local model 79, internal_epoch   1,  Average loss: 0.0016, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0768, Accuracy: 9769/10000 (97.6900%)
___Train Local_Simple,  epoch  20, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0772, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch  20, local model 63, internal_epoch   1,  Average loss: 0.0015, Accuracy: 866/889 (97.4128%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1188, Accuracy: 9619/10000 (96.1900%)
time spent on training: 300.5706226825714
[rfa agg] training data poison_ratio: 0.2059971611071682  data num: [606, 591, 568, 557, 623, 276, 892, 734, 1227, 860, 150, 699, 343, 338, 937, 293, 257, 182, 250, 889]
[rfa agg] considering poison per batch poison_fraction: 0.06437411284599007
[rfa agg] init. name: [41, 73, 51, 74, 33, 58, 10, 13, 81, 37, 94, 61, 57, 60, 92, 23, 39, 79, 86, 63], weight: tensor([0.0538, 0.0524, 0.0504, 0.0494, 0.0553, 0.0245, 0.0791, 0.0651, 0.1089,
        0.0763, 0.0133, 0.0620, 0.0304, 0.0300, 0.0831, 0.0260, 0.0228, 0.0161,
        0.0222, 0.0789])
[rfa agg] iter:  0, prev_obj_val: 1.2980971336364746, obj_val: 1.2421735525131226, abs dis: 0.05592358112335205
[rfa agg] iter:  0, weight: tensor([0.0196, 0.0152, 0.0174, 0.0175, 0.0607, 0.0374, 0.0792, 0.0644, 0.1008,
        0.0848, 0.0236, 0.0807, 0.0378, 0.0478, 0.0816, 0.0441, 0.0381, 0.0323,
        0.0395, 0.0775])
[rfa agg] iter:  1, prev_obj_val: 1.2421735525131226, obj_val: 1.241363763809204, abs dis: 0.000809788703918457
[rfa agg] iter:  1, weight: tensor([0.0152, 0.0119, 0.0136, 0.0139, 0.0593, 0.0395, 0.0733, 0.0595, 0.0938,
        0.0801, 0.0280, 0.0817, 0.0349, 0.0502, 0.0786, 0.0550, 0.0442, 0.0457,
        0.0494, 0.0721])
[rfa agg] iter:  2, prev_obj_val: 1.241363763809204, obj_val: 1.2413530349731445, abs dis: 1.0728836059570312e-05
[rfa agg] iter:  2, weight: tensor([0.0149, 0.0116, 0.0133, 0.0136, 0.0593, 0.0397, 0.0721, 0.0587, 0.0923,
        0.0790, 0.0286, 0.0815, 0.0345, 0.0504, 0.0782, 0.0572, 0.0450, 0.0482,
        0.0512, 0.0710])
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0710, Accuracy: 9789/10000 (97.8900%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 7.6150, Accuracy: 41/8968 (0.4572%)
saving model
Done in 312.1286461353302 sec.
Server Epoch:21 choose agents : [41, 73, 51, 74, 99, 97, 37, 44, 52, 88, 25, 28, 8, 16, 6, 3, 23, 27, 86, 35].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0183, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0126, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0113, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0122, Accuracy: 388/606 (64.0264%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0111, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0105, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0103, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.34482268976221.
Norm before scaling: 16.375234820596848. Distance: 2.927457158844535
Total norm for 4 adversaries is: 16.375234820596848. distance: 2.927457158844535
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.8566, Accuracy: 5654/8968 (63.0464%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0242, Accuracy: 322/591 (54.4839%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0208, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0148, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0143, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0136, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 413/591 (69.8816%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0117, Accuracy: 406/591 (68.6971%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0107, Accuracy: 456/591 (77.1574%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0092, Accuracy: 499/591 (84.4332%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0087, Accuracy: 511/591 (86.4636%), train_poison_data_count: 195
Global model norm: 16.34482268976221.
Norm before scaling: 16.502509648748315. Distance: 3.5061226833572086
Total norm for 4 adversaries is: 16.502509648748315. distance: 3.5061226833572086
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.3379, Accuracy: 8102/8968 (90.3434%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0179, Accuracy: 345/568 (60.7394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0116, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0103, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0096, Accuracy: 419/568 (73.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0091, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0080, Accuracy: 431/568 (75.8803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0071, Accuracy: 470/568 (82.7465%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0057, Accuracy: 496/568 (87.3239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0054, Accuracy: 512/568 (90.1408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0049, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Global model norm: 16.34482268976221.
Norm before scaling: 16.431831804018287. Distance: 2.929800128043414
Total norm for 4 adversaries is: 16.431831804018287. distance: 2.929800128043414
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1839, Accuracy: 8457/8968 (94.3020%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0181, Accuracy: 359/557 (64.4524%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0075, Accuracy: 454/557 (81.5081%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0030, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.34482268976221.
Norm before scaling: 16.5515266198398. Distance: 3.090295886345049
Total norm for 4 adversaries is: 16.5515266198398. distance: 3.090295886345049
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0731, Accuracy: 8693/8968 (96.9335%)
___Train Local_Simple,  epoch  21, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0837, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0012, Accuracy: 475/487 (97.5359%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1895, Accuracy: 9368/10000 (93.6800%)
___Train Local_Simple,  epoch  21, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 850/860 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3881, Accuracy: 8981/10000 (89.8100%)
___Train Local_Simple,  epoch  21, local model 44, internal_epoch   1,  Average loss: 0.0014, Accuracy: 503/517 (97.2921%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1668, Accuracy: 9443/10000 (94.4300%)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1246, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  21, local model 88, internal_epoch   1,  Average loss: 0.0012, Accuracy: 520/530 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1322, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  21, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 639/647 (98.7635%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3742, Accuracy: 8827/10000 (88.2700%)
___Train Local_Simple,  epoch  21, local model 28, internal_epoch   1,  Average loss: 0.0010, Accuracy: 494/501 (98.6028%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1104, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/633 (96.9984%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1429, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  21, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 898/915 (98.1421%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0942, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 606/615 (98.5366%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1365, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 902/923 (97.7248%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1968, Accuracy: 9403/10000 (94.0300%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1004, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch  21, local model 27, internal_epoch   1,  Average loss: 0.0014, Accuracy: 459/471 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1472, Accuracy: 9525/10000 (95.2500%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0934, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch  21, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1510, Accuracy: 9520/10000 (95.2000%)
time spent on training: 314.9956262111664
[rfa agg] training data poison_ratio: 0.20932119354547912  data num: [606, 591, 568, 557, 377, 487, 860, 517, 253, 530, 647, 501, 633, 915, 615, 923, 293, 471, 250, 499]
[rfa agg] considering poison per batch poison_fraction: 0.06541287298296222
[rfa agg] init. name: [41, 73, 51, 74, 99, 97, 37, 44, 52, 88, 25, 28, 8, 16, 6, 3, 23, 27, 86, 35], weight: tensor([0.0546, 0.0533, 0.0512, 0.0502, 0.0340, 0.0439, 0.0775, 0.0466, 0.0228,
        0.0478, 0.0583, 0.0452, 0.0571, 0.0825, 0.0554, 0.0832, 0.0264, 0.0425,
        0.0225, 0.0450])
[rfa agg] iter:  0, prev_obj_val: 1.2392207384109497, obj_val: 1.1723707914352417, abs dis: 0.06684994697570801
[rfa agg] iter:  0, weight: tensor([0.0185, 0.0151, 0.0177, 0.0161, 0.0583, 0.0522, 0.0768, 0.0506, 0.0353,
        0.0613, 0.0608, 0.0629, 0.0677, 0.0821, 0.0643, 0.0632, 0.0452, 0.0539,
        0.0358, 0.0623])
[rfa agg] iter:  1, prev_obj_val: 1.1723707914352417, obj_val: 1.1710418462753296, abs dis: 0.0013289451599121094
[rfa agg] iter:  1, weight: tensor([0.0138, 0.0113, 0.0130, 0.0121, 0.0780, 0.0513, 0.0676, 0.0472, 0.0393,
        0.0579, 0.0558, 0.0710, 0.0632, 0.0774, 0.0622, 0.0549, 0.0591, 0.0547,
        0.0409, 0.0694])
[rfa agg] iter:  2, prev_obj_val: 1.1710418462753296, obj_val: 1.1710186004638672, abs dis: 2.3245811462402344e-05
[rfa agg] iter:  2, weight: tensor([0.0133, 0.0109, 0.0126, 0.0117, 0.0827, 0.0510, 0.0657, 0.0467, 0.0398,
        0.0564, 0.0545, 0.0729, 0.0617, 0.0763, 0.0614, 0.0537, 0.0622, 0.0546,
        0.0417, 0.0702])
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0652, Accuracy: 9785/10000 (97.8500%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 7.3364, Accuracy: 59/8968 (0.6579%)
saving model
Done in 326.7069933414459 sec.
Server Epoch:22 choose agents : [41, 73, 51, 74, 29, 48, 11, 43, 33, 12, 97, 15, 42, 20, 90, 56, 54, 24, 38, 32].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0177, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0141, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0108, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0102, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.33813987126824.
Norm before scaling: 16.415202170691884. Distance: 3.152446910583563
Total norm for 4 adversaries is: 16.415202170691884. distance: 3.152446910583563
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.8811, Accuracy: 4665/8968 (52.0183%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0223, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0192, Accuracy: 281/591 (47.5465%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0149, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0133, Accuracy: 373/591 (63.1134%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0134, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0130, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0127, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0125, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0127, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Global model norm: 16.33813987126824.
Norm before scaling: 16.426737579919248. Distance: 3.197470386359046
Total norm for 4 adversaries is: 16.426737579919248. distance: 3.197470386359046
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.6447, Accuracy: 6363/8968 (70.9523%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0172, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0118, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0101, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0102, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0093, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0093, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0082, Accuracy: 427/568 (75.1761%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0070, Accuracy: 457/568 (80.4577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0068, Accuracy: 485/568 (85.3873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0067, Accuracy: 491/568 (86.4437%), train_poison_data_count: 180
Global model norm: 16.33813987126824.
Norm before scaling: 16.395372137864467. Distance: 2.9831639573874034
Total norm for 4 adversaries is: 16.395372137864467. distance: 2.9831639573874034
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2303, Accuracy: 8453/8968 (94.2574%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0157, Accuracy: 386/557 (69.2998%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0072, Accuracy: 465/557 (83.4829%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.33813987126824.
Norm before scaling: 16.52270240681647. Distance: 2.9395009794173577
Total norm for 4 adversaries is: 16.52270240681647. distance: 2.9395009794173577
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0750, Accuracy: 8703/8968 (97.0450%)
___Train Local_Simple,  epoch  22, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 986/1002 (98.4032%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1915, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch  22, local model 48, internal_epoch   1,  Average loss: 0.0007, Accuracy: 441/448 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0716, Accuracy: 9781/10000 (97.8100%)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 631/645 (97.8295%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1513, Accuracy: 9487/10000 (94.8700%)
___Train Local_Simple,  epoch  22, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1000, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch  22, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 608/623 (97.5923%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1378, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1131/1160 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1908, Accuracy: 9352/10000 (93.5200%)
___Train Local_Simple,  epoch  22, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 479/487 (98.3573%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1499, Accuracy: 9518/10000 (95.1800%)
___Train Local_Simple,  epoch  22, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 394/401 (98.2544%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1040, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0743, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch  22, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 418/429 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2802, Accuracy: 9175/10000 (91.7500%)
___Train Local_Simple,  epoch  22, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 669/683 (97.9502%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2973, Accuracy: 9004/10000 (90.0400%)
___Train Local_Simple,  epoch  22, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 863/880 (98.0682%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0994, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch  22, local model 54, internal_epoch   1,  Average loss: 0.0009, Accuracy: 509/519 (98.0732%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2822, Accuracy: 9139/10000 (91.3900%)
___Train Local_Simple,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 367/379 (96.8338%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1030, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 869/895 (97.0950%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6144, Accuracy: 8184/10000 (81.8400%)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 952/977 (97.4411%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2044, Accuracy: 9356/10000 (93.5600%)
time spent on training: 327.2399880886078
[rfa agg] training data poison_ratio: 0.18584920761965742  data num: [606, 591, 568, 557, 1002, 448, 645, 408, 623, 1160, 487, 401, 236, 429, 683, 880, 519, 379, 895, 977]
[rfa agg] considering poison per batch poison_fraction: 0.058077877381142944
[rfa agg] init. name: [41, 73, 51, 74, 29, 48, 11, 43, 33, 12, 97, 15, 42, 20, 90, 56, 54, 24, 38, 32], weight: tensor([0.0485, 0.0473, 0.0455, 0.0446, 0.0802, 0.0359, 0.0516, 0.0327, 0.0499,
        0.0928, 0.0390, 0.0321, 0.0189, 0.0343, 0.0547, 0.0704, 0.0415, 0.0303,
        0.0716, 0.0782])
[rfa agg] iter:  0, prev_obj_val: 1.2835376262664795, obj_val: 1.240763783454895, abs dis: 0.04277384281158447
[rfa agg] iter:  0, weight: tensor([0.0166, 0.0160, 0.0167, 0.0164, 0.0832, 0.0629, 0.0598, 0.0517, 0.0569,
        0.0781, 0.0567, 0.0447, 0.0354, 0.0436, 0.0664, 0.0747, 0.0449, 0.0489,
        0.0593, 0.0672])
[rfa agg] iter:  1, prev_obj_val: 1.240763783454895, obj_val: 1.2401280403137207, abs dis: 0.0006357431411743164
[rfa agg] iter:  1, weight: tensor([0.0136, 0.0131, 0.0135, 0.0135, 0.0782, 0.0761, 0.0610, 0.0554, 0.0561,
        0.0703, 0.0624, 0.0489, 0.0434, 0.0425, 0.0654, 0.0720, 0.0430, 0.0561,
        0.0535, 0.0619])
[rfa agg] iter:  2, prev_obj_val: 1.2401280403137207, obj_val: 1.2401193380355835, abs dis: 8.702278137207031e-06
[rfa agg] iter:  2, weight: tensor([0.0133, 0.0128, 0.0133, 0.0133, 0.0772, 0.0785, 0.0611, 0.0559, 0.0558,
        0.0691, 0.0633, 0.0495, 0.0448, 0.0423, 0.0650, 0.0713, 0.0426, 0.0572,
        0.0526, 0.0610])
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0637, Accuracy: 9800/10000 (98.0000%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 7.8654, Accuracy: 25/8968 (0.2788%)
saving model
Done in 338.8063631057739 sec.
Server Epoch:23 choose agents : [41, 73, 51, 74, 62, 8, 35, 96, 27, 58, 86, 89, 17, 80, 63, 26, 90, 93, 79, 36].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0181, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0131, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0118, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0104, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0106, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Global model norm: 16.31787395017826.
Norm before scaling: 16.354745233429675. Distance: 2.915731734338888
Total norm for 4 adversaries is: 16.354745233429675. distance: 2.915731734338888
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.7157, Accuracy: 5826/8968 (64.9643%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0241, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0211, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0173, Accuracy: 297/591 (50.2538%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0147, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0142, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0128, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0125, Accuracy: 384/591 (64.9746%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0115, Accuracy: 416/591 (70.3892%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0105, Accuracy: 418/591 (70.7276%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0103, Accuracy: 451/591 (76.3113%), train_poison_data_count: 195
Global model norm: 16.31787395017826.
Norm before scaling: 16.46264674324784. Distance: 3.4285338944696675
Total norm for 4 adversaries is: 16.46264674324784. distance: 3.4285338944696675
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5078, Accuracy: 7417/8968 (82.7052%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0195, Accuracy: 319/568 (56.1620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0119, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0102, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0099, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0093, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0084, Accuracy: 431/568 (75.8803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0074, Accuracy: 450/568 (79.2254%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0060, Accuracy: 503/568 (88.5563%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0055, Accuracy: 509/568 (89.6127%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0054, Accuracy: 512/568 (90.1408%), train_poison_data_count: 180
Global model norm: 16.31787395017826.
Norm before scaling: 16.392407664914096. Distance: 3.169446344251525
Total norm for 4 adversaries is: 16.392407664914096. distance: 3.169446344251525
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1559, Accuracy: 8590/8968 (95.7850%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0176, Accuracy: 337/557 (60.5027%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0070, Accuracy: 475/557 (85.2783%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0032, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0026, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.31787395017826.
Norm before scaling: 16.52633876715817. Distance: 3.084011123666852
Total norm for 4 adversaries is: 16.52633876715817. distance: 3.084011123666852
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0513, Accuracy: 8796/8968 (98.0821%)
___Train Local_Simple,  epoch  23, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1051, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 609/633 (96.2085%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1739, Accuracy: 9438/10000 (94.3800%)
___Train Local_Simple,  epoch  23, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 492/499 (98.5972%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1425, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 657/672 (97.7679%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1351, Accuracy: 9585/10000 (95.8500%)
___Train Local_Simple,  epoch  23, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 463/471 (98.3015%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1259, Accuracy: 9581/10000 (95.8100%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0990, Accuracy: 9695/10000 (96.9500%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 246/250 (98.4000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0729, Accuracy: 9778/10000 (97.7800%)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 484/492 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1141, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 605/620 (97.5806%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1008, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  23, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1764, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  23, local model 63, internal_epoch   1,  Average loss: 0.0015, Accuracy: 866/889 (97.4128%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1045, Accuracy: 9684/10000 (96.8400%)
___Train Local_Simple,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 540/554 (97.4729%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0867, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0013, Accuracy: 668/683 (97.8038%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3070, Accuracy: 8930/10000 (89.3000%)
___Train Local_Simple,  epoch  23, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1646, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch  23, local model 79, internal_epoch   1,  Average loss: 0.0015, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0695, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch  23, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 986/1005 (98.1095%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3584, Accuracy: 8913/10000 (89.1300%)
time spent on training: 299.7642722129822
[rfa agg] training data poison_ratio: 0.21061224489795918  data num: [606, 591, 568, 557, 423, 633, 499, 672, 471, 276, 250, 492, 620, 431, 889, 554, 683, 623, 182, 1005]
[rfa agg] considering poison per batch poison_fraction: 0.06581632653061224
[rfa agg] init. name: [41, 73, 51, 74, 62, 8, 35, 96, 27, 58, 86, 89, 17, 80, 63, 26, 90, 93, 79, 36], weight: tensor([0.0550, 0.0536, 0.0515, 0.0505, 0.0384, 0.0574, 0.0453, 0.0610, 0.0427,
        0.0250, 0.0227, 0.0446, 0.0562, 0.0391, 0.0806, 0.0502, 0.0620, 0.0565,
        0.0165, 0.0912])
[rfa agg] iter:  0, prev_obj_val: 1.2543861865997314, obj_val: 1.183701753616333, abs dis: 0.07068443298339844
[rfa agg] iter:  0, weight: tensor([0.0196, 0.0161, 0.0170, 0.0169, 0.0597, 0.0637, 0.0615, 0.0660, 0.0555,
        0.0356, 0.0385, 0.0600, 0.0654, 0.0530, 0.0734, 0.0643, 0.0595, 0.0687,
        0.0287, 0.0768])
[rfa agg] iter:  1, prev_obj_val: 1.183701753616333, obj_val: 1.1821168661117554, abs dis: 0.0015848875045776367
[rfa agg] iter:  1, weight: tensor([0.0145, 0.0119, 0.0125, 0.0126, 0.0699, 0.0597, 0.0682, 0.0640, 0.0589,
        0.0382, 0.0484, 0.0598, 0.0653, 0.0567, 0.0650, 0.0663, 0.0540, 0.0715,
        0.0387, 0.0641])
[rfa agg] iter:  2, prev_obj_val: 1.1821168661117554, obj_val: 1.1820944547653198, abs dis: 2.2411346435546875e-05
[rfa agg] iter:  2, weight: tensor([0.0140, 0.0115, 0.0120, 0.0122, 0.0713, 0.0587, 0.0697, 0.0638, 0.0595,
        0.0385, 0.0498, 0.0591, 0.0652, 0.0571, 0.0633, 0.0663, 0.0531, 0.0721,
        0.0408, 0.0619])
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0602, Accuracy: 9813/10000 (98.1300%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 7.0526, Accuracy: 54/8968 (0.6021%)
saving model
Done in 311.34735226631165 sec.
Server Epoch:24 choose agents : [41, 73, 51, 74, 67, 87, 65, 30, 98, 25, 54, 52, 46, 6, 35, 17, 20, 77, 44, 8].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0180, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0136, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 438/606 (72.2772%), train_poison_data_count: 200
Global model norm: 16.30594617356608.
Norm before scaling: 16.342641760048025. Distance: 2.7823216805980886
Total norm for 4 adversaries is: 16.342641760048025. distance: 2.7823216805980886
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.8337, Accuracy: 5183/8968 (57.7944%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0237, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0213, Accuracy: 241/591 (40.7783%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0169, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0159, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0150, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0144, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0141, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0136, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0135, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0133, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Global model norm: 16.30594617356608.
Norm before scaling: 16.40696613020385. Distance: 3.4940083853452317
Total norm for 4 adversaries is: 16.40696613020385. distance: 3.4940083853452317
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5717, Accuracy: 7415/8968 (82.6829%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0153, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0117, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0100, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0087, Accuracy: 450/568 (79.2254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0077, Accuracy: 463/568 (81.5141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0063, Accuracy: 487/568 (85.7394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0049, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0033, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0032, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0031, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Global model norm: 16.30594617356608.
Norm before scaling: 16.404479071087568. Distance: 2.890500782540068
Total norm for 4 adversaries is: 16.404479071087568. distance: 2.890500782540068
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0926, Accuracy: 8726/8968 (97.3015%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0166, Accuracy: 373/557 (66.9659%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0075, Accuracy: 455/557 (81.6876%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.30594617356608.
Norm before scaling: 16.52201622876796. Distance: 3.044535986211674
Total norm for 4 adversaries is: 16.52201622876796. distance: 3.044535986211674
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0623, Accuracy: 8734/8968 (97.3907%)
___Train Local_Simple,  epoch  24, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 980/998 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1969, Accuracy: 9370/10000 (93.7000%)
___Train Local_Simple,  epoch  24, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 462/470 (98.2979%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0938, Accuracy: 9716/10000 (97.1600%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0913, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1182, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch  24, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 798/818 (97.5550%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2081, Accuracy: 9328/10000 (93.2800%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2514, Accuracy: 9181/10000 (91.8100%)
___Train Local_Simple,  epoch  24, local model 54, internal_epoch   1,  Average loss: 0.0018, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2360, Accuracy: 9251/10000 (92.5100%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0918, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  24, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2347, Accuracy: 9215/10000 (92.1500%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 605/615 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1311, Accuracy: 9580/10000 (95.8000%)
___Train Local_Simple,  epoch  24, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 496/499 (99.3988%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1436, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch  24, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 607/620 (97.9032%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0987, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  24, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2395, Accuracy: 9246/10000 (92.4600%)
___Train Local_Simple,  epoch  24, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 573/589 (97.2835%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1324, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  24, local model 44, internal_epoch   1,  Average loss: 0.0013, Accuracy: 506/517 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1398, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 618/633 (97.6303%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1257, Accuracy: 9629/10000 (96.2900%)
time spent on training: 301.5950951576233
[rfa agg] training data poison_ratio: 0.2035056967572305  data num: [606, 591, 568, 557, 998, 470, 371, 400, 818, 647, 519, 253, 710, 615, 499, 620, 429, 589, 517, 633]
[rfa agg] considering poison per batch poison_fraction: 0.06359553023663453
[rfa agg] init. name: [41, 73, 51, 74, 67, 87, 65, 30, 98, 25, 54, 52, 46, 6, 35, 17, 20, 77, 44, 8], weight: tensor([0.0531, 0.0518, 0.0498, 0.0488, 0.0875, 0.0412, 0.0325, 0.0351, 0.0717,
        0.0567, 0.0455, 0.0222, 0.0622, 0.0539, 0.0437, 0.0543, 0.0376, 0.0516,
        0.0453, 0.0555])
[rfa agg] iter:  0, prev_obj_val: 1.2293866872787476, obj_val: 1.1718246936798096, abs dis: 0.05756199359893799
[rfa agg] iter:  0, weight: tensor([0.0193, 0.0150, 0.0177, 0.0161, 0.0784, 0.0652, 0.0500, 0.0502, 0.0663,
        0.0591, 0.0460, 0.0398, 0.0589, 0.0679, 0.0617, 0.0620, 0.0465, 0.0568,
        0.0547, 0.0684])
[rfa agg] iter:  1, prev_obj_val: 1.1718246936798096, obj_val: 1.170998215675354, abs dis: 0.0008264780044555664
[rfa agg] iter:  1, weight: tensor([0.0151, 0.0117, 0.0137, 0.0127, 0.0711, 0.0706, 0.0570, 0.0539, 0.0623,
        0.0561, 0.0416, 0.0499, 0.0549, 0.0698, 0.0712, 0.0618, 0.0471, 0.0556,
        0.0549, 0.0688])
[rfa agg] iter:  2, prev_obj_val: 1.170998215675354, obj_val: 1.1709904670715332, abs dis: 7.748603820800781e-06
[rfa agg] iter:  2, weight: tensor([0.0148, 0.0115, 0.0134, 0.0124, 0.0699, 0.0707, 0.0580, 0.0544, 0.0617,
        0.0557, 0.0410, 0.0512, 0.0543, 0.0699, 0.0733, 0.0618, 0.0473, 0.0554,
        0.0548, 0.0686])
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0612, Accuracy: 9820/10000 (98.2000%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 7.0063, Accuracy: 55/8968 (0.6133%)
saving model
Done in 313.23187160491943 sec.
Server Epoch:25 choose agents : [41, 73, 51, 74, 78, 3, 39, 14, 32, 4, 30, 65, 23, 98, 88, 71, 2, 43, 25, 17].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0177, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0134, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0110, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0109, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0102, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0103, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Global model norm: 16.295668062630078.
Norm before scaling: 16.32108382122981. Distance: 2.8492378688178124
Total norm for 4 adversaries is: 16.32108382122981. distance: 2.8492378688178124
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7036, Accuracy: 6072/8968 (67.7074%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0216, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0184, Accuracy: 284/591 (48.0541%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0149, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0142, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0133, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0114, Accuracy: 416/591 (70.3892%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0093, Accuracy: 501/591 (84.7716%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0069, Accuracy: 520/591 (87.9865%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0055, Accuracy: 532/591 (90.0169%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0052, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Global model norm: 16.295668062630078.
Norm before scaling: 16.424008246314298. Distance: 3.431804585760056
Total norm for 4 adversaries is: 16.424008246314298. distance: 3.431804585760056
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1619, Accuracy: 8632/8968 (96.2533%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0162, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0113, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0089, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0084, Accuracy: 442/568 (77.8169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0071, Accuracy: 466/568 (82.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0063, Accuracy: 477/568 (83.9789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0046, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0035, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0031, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0028, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Global model norm: 16.295668062630078.
Norm before scaling: 16.387909205119314. Distance: 2.882764035362857
Total norm for 4 adversaries is: 16.387909205119314. distance: 2.882764035362857
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0961, Accuracy: 8640/8968 (96.3426%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0160, Accuracy: 369/557 (66.2478%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 483/557 (86.7145%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.295668062630078.
Norm before scaling: 16.51377155221987. Distance: 3.0017312140958334
Total norm for 4 adversaries is: 16.51377155221987. distance: 3.0017312140958334
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0577, Accuracy: 8732/8968 (97.3684%)
___Train Local_Simple,  epoch  25, local model 78, internal_epoch   1,  Average loss: 0.0011, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1345, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0010, Accuracy: 904/923 (97.9415%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1208, Accuracy: 9663/10000 (96.6300%)
___Train Local_Simple,  epoch  25, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 251/257 (97.6654%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0723, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 371/376 (98.6702%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0879, Accuracy: 9735/10000 (97.3500%)
___Train Local_Simple,  epoch  25, local model 32, internal_epoch   1,  Average loss: 0.0017, Accuracy: 953/977 (97.5435%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1366, Accuracy: 9555/10000 (95.5500%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 648/658 (98.4802%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1204, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch  25, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 394/400 (98.5000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1422, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch  25, local model 65, internal_epoch   1,  Average loss: 0.0007, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0851, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0918, Accuracy: 9694/10000 (96.9400%)
___Train Local_Simple,  epoch  25, local model 98, internal_epoch   1,  Average loss: 0.0009, Accuracy: 804/818 (98.2885%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3124, Accuracy: 9107/10000 (91.0700%)
___Train Local_Simple,  epoch  25, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 524/530 (98.8679%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0917, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  25, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1365/1384 (98.6272%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4355, Accuracy: 8721/10000 (87.2100%)
___Train Local_Simple,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 543/548 (99.0876%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1446, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 402/408 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1156, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 638/647 (98.6090%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2223, Accuracy: 9273/10000 (92.7300%)
___Train Local_Simple,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1061, Accuracy: 9673/10000 (96.7300%)
time spent on training: 304.60747361183167
[rfa agg] training data poison_ratio: 0.1961977186311787  data num: [606, 591, 568, 557, 303, 923, 257, 376, 977, 658, 400, 371, 293, 818, 530, 1384, 548, 408, 647, 620]
[rfa agg] considering poison per batch poison_fraction: 0.06131178707224335
[rfa agg] init. name: [41, 73, 51, 74, 78, 3, 39, 14, 32, 4, 30, 65, 23, 98, 88, 71, 2, 43, 25, 17], weight: tensor([0.0512, 0.0499, 0.0480, 0.0471, 0.0256, 0.0780, 0.0217, 0.0318, 0.0826,
        0.0556, 0.0338, 0.0313, 0.0248, 0.0691, 0.0448, 0.1169, 0.0463, 0.0345,
        0.0547, 0.0524])
[rfa agg] iter:  0, prev_obj_val: 1.2413958311080933, obj_val: 1.1885441541671753, abs dis: 0.05285167694091797
[rfa agg] iter:  0, weight: tensor([0.0179, 0.0145, 0.0167, 0.0156, 0.0386, 0.0701, 0.0393, 0.0524, 0.0715,
        0.0664, 0.0511, 0.0511, 0.0427, 0.0643, 0.0655, 0.0931, 0.0596, 0.0498,
        0.0593, 0.0603])
[rfa agg] iter:  1, prev_obj_val: 1.1885441541671753, obj_val: 1.187659740447998, abs dis: 0.0008844137191772461
[rfa agg] iter:  1, weight: tensor([0.0140, 0.0114, 0.0130, 0.0123, 0.0418, 0.0641, 0.0451, 0.0582, 0.0635,
        0.0683, 0.0566, 0.0598, 0.0519, 0.0616, 0.0717, 0.0807, 0.0582, 0.0521,
        0.0560, 0.0595])
[rfa agg] iter:  2, prev_obj_val: 1.187659740447998, obj_val: 1.1876457929611206, abs dis: 1.3947486877441406e-05
[rfa agg] iter:  2, weight: tensor([0.0137, 0.0111, 0.0127, 0.0120, 0.0422, 0.0630, 0.0456, 0.0591, 0.0622,
        0.0683, 0.0576, 0.0615, 0.0537, 0.0611, 0.0730, 0.0785, 0.0578, 0.0522,
        0.0554, 0.0593])
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0582, Accuracy: 9811/10000 (98.1100%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 7.0818, Accuracy: 43/8968 (0.4795%)
saving model
Saving model on epoch 25
Done in 316.4877758026123 sec.
Saving all the graphs.
This run has a label: Feb.18_08.40.09. Visdom environment: mnist_DBA

current path: saved_models/model_mnist_Feb.17_19.46.02
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43, 46, 37, 21, 35, 61, 64, 28, 67, 22, 82].
___adversary_clean___Train Local_Simple,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 579/591 (97.9695%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 555/568 (97.7113%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0015, ___adversary_clean___Accuracy: 544/557 (97.6661%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0236, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0148, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0133, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0118, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0119, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0114, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0109, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.720175537940122. Distance: 4.614811578047245
Total norm for 4 adversaries is: 16.720175537940122. distance: 4.614811578047245
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9039, Accuracy: 5500/8968 (61.3292%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0274, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0205, Accuracy: 280/591 (47.3773%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0208, Accuracy: 242/591 (40.9475%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0182, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0168, Accuracy: 297/591 (50.2538%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0161, Accuracy: 305/591 (51.6074%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0148, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0147, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0142, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0143, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.670376682613814. Distance: 4.478610171265424
Total norm for 4 adversaries is: 16.670376682613814. distance: 4.478610171265424
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8269, Accuracy: 6357/8968 (70.8854%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0251, Accuracy: 319/568 (56.1620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0142, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0122, Accuracy: 367/568 (64.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0121, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0114, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0111, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0105, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0105, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0107, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0104, Accuracy: 380/568 (66.9014%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.663060726452315. Distance: 4.622524939511549
Total norm for 4 adversaries is: 16.663060726452315. distance: 4.622524939511549
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5533, Accuracy: 7076/8968 (78.9028%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0239, Accuracy: 315/557 (56.5530%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0123, Accuracy: 363/557 (65.1706%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0068, Accuracy: 486/557 (87.2531%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0054, Accuracy: 495/557 (88.8689%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0049, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0038, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0030, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.844111451073097. Distance: 4.454075761990886
Total norm for 4 adversaries is: 16.844111451073097. distance: 4.454075761990886
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1683, Accuracy: 8260/8968 (92.1053%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1545, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0016, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0853, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 853/889 (95.9505%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1665, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 623/645 (96.5891%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2816, Accuracy: 9074/10000 (90.7400%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 670/686 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1550, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2867, Accuracy: 9062/10000 (90.6200%)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0019, Accuracy: 682/710 (96.0563%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3995, Accuracy: 8679/10000 (86.7900%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 837/860 (97.3256%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3147, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 304/312 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2001, Accuracy: 9383/10000 (93.8300%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2008, Accuracy: 9416/10000 (94.1600%)
___Train Local_Simple,  epoch  11, local model 61, internal_epoch   1,  Average loss: 0.0017, Accuracy: 673/699 (96.2804%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4396, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  11, local model 64, internal_epoch   1,  Average loss: 0.0022, Accuracy: 781/813 (96.0640%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5151, Accuracy: 8166/10000 (81.6600%)
___Train Local_Simple,  epoch  11, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 482/501 (96.2076%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1038, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  11, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2293, Accuracy: 9262/10000 (92.6200%)
___Train Local_Simple,  epoch  11, local model 22, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3431, Accuracy: 8993/10000 (89.9300%)
___Train Local_Simple,  epoch  11, local model 82, internal_epoch   1,  Average loss: 0.0016, Accuracy: 689/713 (96.6339%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2847, Accuracy: 9066/10000 (90.6600%)
time spent on training: 341.2599906921387
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.1862, Accuracy: 4230/10000 (42.3000%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.7700, Accuracy: 7445/8968 (83.0174%)
saving model
Done in 352.11024618148804 sec.
Server Epoch:12 choose agents : [41, 51, 73, 74, 57, 63, 77, 18, 43, 91, 42, 52, 28, 37, 96, 99, 80, 13, 98, 78].
___adversary_clean___Train Local_Simple,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0063, ___adversary_clean___Accuracy: 524/606 (86.4686%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0056, ___adversary_clean___Accuracy: 510/568 (89.7887%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0055, ___adversary_clean___Accuracy: 527/591 (89.1709%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0074, ___adversary_clean___Accuracy: 462/557 (82.9443%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0138, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0118, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0123, Accuracy: 333/606 (54.9505%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.455755851214054.
Norm before scaling: 16.590730841452274. Distance: 1.5641732221468394
Total norm for 4 adversaries is: 16.590730841452274. distance: 1.5641732221468394
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.7478, Accuracy: 5453/8968 (60.8051%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0117, Accuracy: 362/568 (63.7324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0087, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0077, Accuracy: 455/568 (80.1056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0063, Accuracy: 474/568 (83.4507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0048, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0035, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0028, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0019, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.455755851214054.
Norm before scaling: 16.66509076615368. Distance: 1.876272342048199
Total norm for 4 adversaries is: 16.66509076615368. distance: 1.876272342048199
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0685, Accuracy: 8773/8968 (97.8256%)
poison local model 73 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0149, Accuracy: 336/591 (56.8528%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0234, Accuracy: 320/591 (54.1455%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0187, Accuracy: 405/591 (68.5279%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0130, Accuracy: 391/591 (66.1591%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0100, Accuracy: 463/591 (78.3418%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0075, Accuracy: 510/591 (86.2944%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0053, Accuracy: 532/591 (90.0169%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0037, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0030, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0030, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Global model norm: 16.455755851214054.
Norm before scaling: 16.797232917698267. Distance: 2.6872460888525307
Total norm for 4 adversaries is: 16.797232917698267. distance: 2.6872460888525307
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0685, Accuracy: 8752/8968 (97.5914%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0108, Accuracy: 402/557 (72.1724%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 494/557 (88.6894%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.455755851214054.
Norm before scaling: 16.76710388543824. Distance: 2.2606047685354347
Total norm for 4 adversaries is: 16.76710388543824. distance: 2.2606047685354347
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0358, Accuracy: 8837/8968 (98.5393%)
___Train Local_Simple,  epoch  12, local model 57, internal_epoch   1,  Average loss: 0.0101, Accuracy: 257/343 (74.9271%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5240, Accuracy: 8243/10000 (82.4300%)
___Train Local_Simple,  epoch  12, local model 63, internal_epoch   1,  Average loss: 0.0062, Accuracy: 771/889 (86.7267%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4176, Accuracy: 8894/10000 (88.9400%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 468/589 (79.4567%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2251, Accuracy: 9338/10000 (93.3800%)
___Train Local_Simple,  epoch  12, local model 18, internal_epoch   1,  Average loss: 0.0107, Accuracy: 363/459 (79.0850%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3425, Accuracy: 6908/10000 (69.0800%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0089, Accuracy: 330/408 (80.8824%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9494, Accuracy: 7310/10000 (73.1000%)
___Train Local_Simple,  epoch  12, local model 91, internal_epoch   1,  Average loss: 0.0093, Accuracy: 191/256 (74.6094%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2519, Accuracy: 6029/10000 (60.2900%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0152, Accuracy: 157/236 (66.5254%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8753, Accuracy: 6671/10000 (66.7100%)
___Train Local_Simple,  epoch  12, local model 52, internal_epoch   1,  Average loss: 0.0110, Accuracy: 178/253 (70.3557%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9941, Accuracy: 6988/10000 (69.8800%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0102, Accuracy: 391/501 (78.0439%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5850, Accuracy: 8524/10000 (85.2400%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 793/860 (92.2093%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6132, Accuracy: 8205/10000 (82.0500%)
___Train Local_Simple,  epoch  12, local model 96, internal_epoch   1,  Average loss: 0.0069, Accuracy: 574/672 (85.4167%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2269, Accuracy: 7027/10000 (70.2700%)
___Train Local_Simple,  epoch  12, local model 99, internal_epoch   1,  Average loss: 0.0098, Accuracy: 275/377 (72.9443%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.6930, Accuracy: 6362/10000 (63.6200%)
___Train Local_Simple,  epoch  12, local model 80, internal_epoch   1,  Average loss: 0.0087, Accuracy: 338/431 (78.4223%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.6068, Accuracy: 6203/10000 (62.0300%)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0076, Accuracy: 599/734 (81.6076%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1586, Accuracy: 6381/10000 (63.8100%)
___Train Local_Simple,  epoch  12, local model 98, internal_epoch   1,  Average loss: 0.0067, Accuracy: 709/818 (86.6748%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2742, Accuracy: 6803/10000 (68.0300%)
___Train Local_Simple,  epoch  12, local model 78, internal_epoch   1,  Average loss: 0.0104, Accuracy: 224/303 (73.9274%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.9381, Accuracy: 5486/10000 (54.8600%)
time spent on training: 367.5472435951233
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.2038, Accuracy: 9381/10000 (93.8100%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 5.2312, Accuracy: 653/8968 (7.2814%)
saving model
Done in 378.54793190956116 sec.
Server Epoch:13 choose agents : [41, 74, 51, 73, 50, 67, 14, 36, 24, 7, 4, 80, 39, 26, 29, 42, 69, 95, 8, 25].
___adversary_clean___Train Local_Simple,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0024, ___adversary_clean___Accuracy: 579/606 (95.5446%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0029, ___adversary_clean___Accuracy: 527/557 (94.6140%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0022, ___adversary_clean___Accuracy: 545/568 (95.9507%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 572/591 (96.7851%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0156, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0143, Accuracy: 319/606 (52.6403%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0102, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Global model norm: 16.781490047165807.
Norm before scaling: 16.81617713621507. Distance: 2.768855907059379
Total norm for 4 adversaries is: 16.81617713621507. distance: 2.768855907059379
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.4187, Accuracy: 7114/8968 (79.3265%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0173, Accuracy: 345/557 (61.9390%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0093, Accuracy: 431/557 (77.3788%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0041, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0033, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.781490047165807.
Norm before scaling: 16.969303016713646. Distance: 3.0124398443143714
Total norm for 4 adversaries is: 16.969303016713646. distance: 3.0124398443143714
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0333, Accuracy: 8830/8968 (98.4612%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0152, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0057, Accuracy: 492/568 (86.6197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 530/568 (93.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0023, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0019, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.781490047165807.
Norm before scaling: 17.00779545388443. Distance: 3.157941459427238
Total norm for 4 adversaries is: 17.00779545388443. distance: 3.157941459427238
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0208, Accuracy: 8882/8968 (99.0410%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0120, Accuracy: 444/591 (75.1269%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 525/591 (88.8325%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0022, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0023, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0019, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0016, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0012, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0011, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Global model norm: 16.781490047165807.
Norm before scaling: 17.115334114916788. Distance: 3.3147001337411406
Total norm for 4 adversaries is: 17.115334114916788. distance: 3.3147001337411406
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0231, Accuracy: 8876/8968 (98.9741%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 452/474 (95.3586%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3422, Accuracy: 8961/10000 (89.6100%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0021, Accuracy: 956/998 (95.7916%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2771, Accuracy: 9082/10000 (90.8200%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 343/376 (91.2234%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2644, Accuracy: 9198/10000 (91.9800%)
___Train Local_Simple,  epoch  13, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 964/1005 (95.9204%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7882, Accuracy: 7937/10000 (79.3700%)
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0023, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2611, Accuracy: 9152/10000 (91.5200%)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0030, Accuracy: 393/418 (94.0191%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2853, Accuracy: 9177/10000 (91.7700%)
___Train Local_Simple,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0020, Accuracy: 633/658 (96.2006%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5148, Accuracy: 8342/10000 (83.4200%)
___Train Local_Simple,  epoch  13, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 422/431 (97.9118%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2384, Accuracy: 9264/10000 (92.6400%)
___Train Local_Simple,  epoch  13, local model 39, internal_epoch   1,  Average loss: 0.0019, Accuracy: 247/257 (96.1089%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2996, Accuracy: 9134/10000 (91.3400%)
___Train Local_Simple,  epoch  13, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 510/554 (92.0578%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2811, Accuracy: 9182/10000 (91.8200%)
___Train Local_Simple,  epoch  13, local model 29, internal_epoch   1,  Average loss: 0.0016, Accuracy: 971/1002 (96.9062%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4733, Accuracy: 8665/10000 (86.6500%)
___Train Local_Simple,  epoch  13, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 221/236 (93.6441%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4002, Accuracy: 8685/10000 (86.8500%)
___Train Local_Simple,  epoch  13, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 240/256 (93.7500%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6357, Accuracy: 7916/10000 (79.1600%)
___Train Local_Simple,  epoch  13, local model 95, internal_epoch   1,  Average loss: 0.0013, Accuracy: 588/602 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 3.0105, Accuracy: 6575/10000 (65.7500%)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 584/633 (92.2591%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6954, Accuracy: 8564/10000 (85.6400%)
___Train Local_Simple,  epoch  13, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 612/647 (94.5904%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4777, Accuracy: 8417/10000 (84.1700%)
time spent on training: 339.6262855529785
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.5445, Accuracy: 8277/10000 (82.7700%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.0439, Accuracy: 8825/8968 (98.4054%)
saving model
Done in 350.1290125846863 sec.
Server Epoch:14 choose agents : [51, 41, 74, 73, 10, 23, 7, 46, 65, 57, 83, 9, 64, 58, 12, 96, 90, 28, 33, 75].
___adversary_clean___Train Local_Simple,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0024, ___adversary_clean___Accuracy: 548/568 (96.4789%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0028, ___adversary_clean___Accuracy: 582/606 (96.0396%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0030, ___adversary_clean___Accuracy: 529/557 (94.9731%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0029, ___adversary_clean___Accuracy: 565/591 (95.6007%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0113, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0051, Accuracy: 505/568 (88.9085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0017, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0008, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.868180769156393.
Norm before scaling: 17.032421834685973. Distance: 1.8980110851241492
Total norm for 4 adversaries is: 17.032421834685973. distance: 1.8980110851241492
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0043, Accuracy: 8955/8968 (99.8550%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0065, Accuracy: 521/606 (85.9736%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.868180769156393.
Norm before scaling: 17.103942844848486. Distance: 1.9909103787846751
Total norm for 4 adversaries is: 17.103942844848486. distance: 1.9909103787846751
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0228, Accuracy: 8886/8968 (99.0856%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.868180769156393.
Norm before scaling: 17.10080050552276. Distance: 1.721512741502625
Total norm for 4 adversaries is: 17.10080050552276. distance: 1.721512741502625
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0012, Accuracy: 8963/8968 (99.9442%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0008, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0006, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.868180769156393.
Norm before scaling: 17.050172257881663. Distance: 1.6374348460040928
Total norm for 4 adversaries is: 17.050172257881663. distance: 1.6374348460040928
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0015, Accuracy: 8966/8968 (99.9777%)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 853/892 (95.6278%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8213, Accuracy: 7874/10000 (78.7400%)
___Train Local_Simple,  epoch  14, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 285/293 (97.2696%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5240, Accuracy: 8353/10000 (83.5300%)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 379/418 (90.6699%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3184, Accuracy: 9033/10000 (90.3300%)
___Train Local_Simple,  epoch  14, local model 46, internal_epoch   1,  Average loss: 0.0042, Accuracy: 656/710 (92.3944%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9524, Accuracy: 7412/10000 (74.1200%)
___Train Local_Simple,  epoch  14, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 345/371 (92.9919%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4591, Accuracy: 8519/10000 (85.1900%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 326/343 (95.0437%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2916, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  14, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 391/433 (90.3002%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2176, Accuracy: 9355/10000 (93.5500%)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 407/436 (93.3486%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3777, Accuracy: 8766/10000 (87.6600%)
___Train Local_Simple,  epoch  14, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 761/813 (93.6039%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3472, Accuracy: 8896/10000 (88.9600%)
___Train Local_Simple,  epoch  14, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 259/276 (93.8406%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4835, Accuracy: 8600/10000 (86.0000%)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 1099/1160 (94.7414%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2573, Accuracy: 9208/10000 (92.0800%)
___Train Local_Simple,  epoch  14, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 626/672 (93.1548%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6157, Accuracy: 8222/10000 (82.2200%)
___Train Local_Simple,  epoch  14, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 632/683 (92.5329%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8142, Accuracy: 7477/10000 (74.7700%)
___Train Local_Simple,  epoch  14, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 466/501 (93.0140%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3806, Accuracy: 8837/10000 (88.3700%)
___Train Local_Simple,  epoch  14, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 584/623 (93.7400%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9299, Accuracy: 7678/10000 (76.7800%)
___Train Local_Simple,  epoch  14, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 620/686 (90.3790%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3851, Accuracy: 8812/10000 (88.1200%)
time spent on training: 340.31658411026
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.1487, Accuracy: 9524/10000 (95.2400%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.1897, Accuracy: 8539/8968 (95.2163%)
saving model
Done in 350.8721640110016 sec.
Server Epoch:15 choose agents : [73, 74, 41, 51, 80, 23, 25, 12, 58, 19, 11, 13, 82, 50, 34, 14, 55, 53, 36, 6].
___adversary_clean___Train Local_Simple,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 580/591 (98.1387%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 534/557 (95.8707%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 586/606 (96.6997%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 551/568 (97.0070%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0080, Accuracy: 500/591 (84.6024%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0023, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0012, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0010, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 17.129694163035737.
Norm before scaling: 17.32627392333407. Distance: 2.6527502004134234
Total norm for 4 adversaries is: 17.32627392333407. distance: 2.6527502004134234
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0036, Accuracy: 8955/8968 (99.8550%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0014, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 17.129694163035737.
Norm before scaling: 17.304878843468085. Distance: 2.1836946358346996
Total norm for 4 adversaries is: 17.304878843468085. distance: 2.1836946358346996
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0018, Accuracy: 8958/8968 (99.8885%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0074, Accuracy: 515/606 (84.9835%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0019, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0016, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 17.129694163035737.
Norm before scaling: 17.71292669822796. Distance: 4.0416676367270234
Total norm for 4 adversaries is: 17.71292669822796. distance: 4.0416676367270234
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0168, Accuracy: 8905/8968 (99.2975%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0014, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0012, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 17.129694163035737.
Norm before scaling: 17.09398744407756. Distance: 1.0155201784474115
Total norm for 4 adversaries is: 17.09398744407756. distance: 1.0155201784474115
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  15, local model 80, internal_epoch   1,  Average loss: 0.0019, Accuracy: 418/431 (96.9838%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5110, Accuracy: 8639/10000 (86.3900%)
___Train Local_Simple,  epoch  15, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 287/293 (97.9522%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6087, Accuracy: 8343/10000 (83.4300%)
___Train Local_Simple,  epoch  15, local model 25, internal_epoch   1,  Average loss: 0.0027, Accuracy: 617/647 (95.3632%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9170, Accuracy: 7602/10000 (76.0200%)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0021, Accuracy: 1113/1160 (95.9483%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2336, Accuracy: 9266/10000 (92.6600%)
___Train Local_Simple,  epoch  15, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 261/276 (94.5652%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1684, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  15, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 195/205 (95.1220%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6510, Accuracy: 8240/10000 (82.4000%)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 623/645 (96.5891%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1950, Accuracy: 9351/10000 (93.5100%)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 719/734 (97.9564%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5042, Accuracy: 8665/10000 (86.6500%)
___Train Local_Simple,  epoch  15, local model 82, internal_epoch   1,  Average loss: 0.0020, Accuracy: 688/713 (96.4937%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2918, Accuracy: 9024/10000 (90.2400%)
___Train Local_Simple,  epoch  15, local model 50, internal_epoch   1,  Average loss: 0.0024, Accuracy: 456/474 (96.2025%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2436, Accuracy: 9235/10000 (92.3500%)
___Train Local_Simple,  epoch  15, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 402/413 (97.3366%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5476, Accuracy: 8508/10000 (85.0800%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 362/376 (96.2766%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3985, Accuracy: 8621/10000 (86.2100%)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 343/354 (96.8927%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2783, Accuracy: 9140/10000 (91.4000%)
___Train Local_Simple,  epoch  15, local model 53, internal_epoch   1,  Average loss: 0.0018, Accuracy: 717/739 (97.0230%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3926, Accuracy: 8907/10000 (89.0700%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 970/1005 (96.5174%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5618, Accuracy: 8302/10000 (83.0200%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 580/615 (94.3089%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1872, Accuracy: 9412/10000 (94.1200%)
time spent on training: 341.6510920524597
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.1971, Accuracy: 9464/10000 (94.6400%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.0169, Accuracy: 8906/8968 (99.3087%)
saving model
Done in 352.0901165008545 sec.
Server Epoch:16 choose agents : [73, 74, 51, 41, 43, 17, 2, 66, 6, 38, 37, 45, 81, 4, 24, 54, 10, 11, 80, 7].
___adversary_clean___Train Local_Simple,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0013, ___adversary_clean___Accuracy: 578/591 (97.8003%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 543/557 (97.4865%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 557/568 (98.0634%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 591/606 (97.5248%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 17.22656781462503.
Norm before scaling: 17.467891337628682. Distance: 2.245264474120218
Total norm for 4 adversaries is: 17.467891337628682. distance: 2.245264474120218
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0002, Accuracy: 8967/8968 (99.9888%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0029, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 17.22656781462503.
Norm before scaling: 17.344288420696667. Distance: 1.3539569349976786
Total norm for 4 adversaries is: 17.344288420696667. distance: 1.3539569349976786
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 17.22656781462503.
Norm before scaling: 17.27615452398822. Distance: 0.8360937097357304
Total norm for 4 adversaries is: 17.27615452398822. distance: 0.8360937097357304
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0011, Accuracy: 8962/8968 (99.9331%)
poison local model 41 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0025, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0016, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 17.22656781462503.
Norm before scaling: 17.357510553285625. Distance: 1.64671930376987
Total norm for 4 adversaries is: 17.357510553285625. distance: 1.64671930376987
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 43, internal_epoch   1,  Average loss: 0.0026, Accuracy: 391/408 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1695, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  16, local model 17, internal_epoch   1,  Average loss: 0.0024, Accuracy: 592/620 (95.4839%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2047, Accuracy: 9375/10000 (93.7500%)
___Train Local_Simple,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 533/548 (97.2628%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2034, Accuracy: 9375/10000 (93.7500%)
___Train Local_Simple,  epoch  16, local model 66, internal_epoch   1,  Average loss: 0.0020, Accuracy: 635/660 (96.2121%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5817, Accuracy: 8195/10000 (81.9500%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 594/615 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2273, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  16, local model 38, internal_epoch   1,  Average loss: 0.0019, Accuracy: 868/895 (96.9832%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4332, Accuracy: 8524/10000 (85.2400%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 839/860 (97.5581%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1712, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  16, local model 45, internal_epoch   1,  Average loss: 0.0020, Accuracy: 605/628 (96.3376%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3462, Accuracy: 8893/10000 (88.9300%)
___Train Local_Simple,  epoch  16, local model 81, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1194/1227 (97.3105%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2628, Accuracy: 9173/10000 (91.7300%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0021, Accuracy: 633/658 (96.2006%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3998, Accuracy: 8727/10000 (87.2700%)
___Train Local_Simple,  epoch  16, local model 24, internal_epoch   1,  Average loss: 0.0026, Accuracy: 362/379 (95.5145%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1932, Accuracy: 9390/10000 (93.9000%)
___Train Local_Simple,  epoch  16, local model 54, internal_epoch   1,  Average loss: 0.0027, Accuracy: 492/519 (94.7977%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2280, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 860/892 (96.4126%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5641, Accuracy: 8292/10000 (82.9200%)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0021, Accuracy: 620/645 (96.1240%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2885, Accuracy: 8995/10000 (89.9500%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0021, Accuracy: 417/431 (96.7517%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3966, Accuracy: 8781/10000 (87.8100%)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0031, Accuracy: 397/418 (94.9761%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3105, Accuracy: 9012/10000 (90.1200%)
time spent on training: 334.5248169898987
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.1349, Accuracy: 9583/10000 (95.8300%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.0008, Accuracy: 8965/8968 (99.9665%)
saving model
Done in 345.0249500274658 sec.
Server Epoch:17 choose agents : [74, 41, 51, 73, 93, 25, 34, 57, 69, 58, 2, 4, 1, 20, 49, 27, 43, 0, 45, 8].
___adversary_clean___Train Local_Simple,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 543/557 (97.4865%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0021, ___adversary_clean___Accuracy: 586/606 (96.6997%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 556/568 (97.8873%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 583/591 (98.6464%)
poison local model 74 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 17.36511212577175.
Norm before scaling: 17.404329204218936. Distance: 1.0330855477537477
Total norm for 4 adversaries is: 17.404329204218936. distance: 1.0330855477537477
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0018, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 17.36511212577175.
Norm before scaling: 17.335751780494604. Distance: 1.0159781208911522
Total norm for 4 adversaries is: 17.335751780494604. distance: 1.0159781208911522
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 17.36511212577175.
Norm before scaling: 17.33514443741429. Distance: 0.7922088665309778
Total norm for 4 adversaries is: 17.33514443741429. distance: 0.7922088665309778
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0008, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 17.36511212577175.
Norm before scaling: 17.31980328807172. Distance: 0.8728557949343395
Total norm for 4 adversaries is: 17.31980328807172. distance: 0.8728557949343395
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  17, local model 93, internal_epoch   1,  Average loss: 0.0007, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2675, Accuracy: 9143/10000 (91.4300%)
___Train Local_Simple,  epoch  17, local model 25, internal_epoch   1,  Average loss: 0.0023, Accuracy: 614/647 (94.8995%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4066, Accuracy: 8689/10000 (86.8900%)
___Train Local_Simple,  epoch  17, local model 34, internal_epoch   1,  Average loss: 0.0016, Accuracy: 401/413 (97.0944%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3744, Accuracy: 8974/10000 (89.7400%)
___Train Local_Simple,  epoch  17, local model 57, internal_epoch   1,  Average loss: 0.0027, Accuracy: 327/343 (95.3353%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2880, Accuracy: 9145/10000 (91.4500%)
___Train Local_Simple,  epoch  17, local model 69, internal_epoch   1,  Average loss: 0.0022, Accuracy: 242/256 (94.5312%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2183, Accuracy: 9296/10000 (92.9600%)
___Train Local_Simple,  epoch  17, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 262/276 (94.9275%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1388, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 519/548 (94.7080%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2018, Accuracy: 9401/10000 (94.0100%)
___Train Local_Simple,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 640/658 (97.2644%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2397, Accuracy: 9191/10000 (91.9100%)
___Train Local_Simple,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 716/760 (94.2105%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1859, Accuracy: 9417/10000 (94.1700%)
___Train Local_Simple,  epoch  17, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 410/429 (95.5711%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3360, Accuracy: 9043/10000 (90.4300%)
___Train Local_Simple,  epoch  17, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 495/506 (97.8261%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1675, Accuracy: 9443/10000 (94.4300%)
___Train Local_Simple,  epoch  17, local model 27, internal_epoch   1,  Average loss: 0.0022, Accuracy: 451/471 (95.7537%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2324, Accuracy: 9242/10000 (92.4200%)
___Train Local_Simple,  epoch  17, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2630, Accuracy: 9147/10000 (91.4700%)
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0020, Accuracy: 417/435 (95.8621%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3207, Accuracy: 9100/10000 (91.0000%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0016, Accuracy: 612/628 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2279, Accuracy: 9256/10000 (92.5600%)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 609/633 (96.2085%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3421, Accuracy: 8919/10000 (89.1900%)
time spent on training: 337.08093094825745
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.1454, Accuracy: 9562/10000 (95.6200%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 347.55477023124695 sec.
Server Epoch:18 choose agents : [51, 73, 41, 74, 62, 65, 54, 94, 68, 33, 58, 10, 13, 81, 37, 61, 57, 60, 92, 23].
___adversary_clean___Train Local_Simple,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 556/568 (97.8873%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 582/591 (98.4772%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 598/606 (98.6799%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 545/557 (97.8456%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.32855735906727.
Norm before scaling: 17.307967381043948. Distance: 0.5564702626583362
Total norm for 4 adversaries is: 17.307967381043948. distance: 0.5564702626583362
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0008, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 17.32855735906727.
Norm before scaling: 17.33700424838714. Distance: 0.9745296835569484
Total norm for 4 adversaries is: 17.33700424838714. distance: 0.9745296835569484
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 17.32855735906727.
Norm before scaling: 17.296396857099495. Distance: 0.5769677823425386
Total norm for 4 adversaries is: 17.296396857099495. distance: 0.5769677823425386
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.32855735906727.
Norm before scaling: 17.304217509136773. Distance: 0.7424982323930552
Total norm for 4 adversaries is: 17.304217509136773. distance: 0.7424982323930552
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 417/423 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1121, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch  18, local model 65, internal_epoch   1,  Average loss: 0.0018, Accuracy: 360/371 (97.0350%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1687, Accuracy: 9454/10000 (94.5400%)
___Train Local_Simple,  epoch  18, local model 54, internal_epoch   1,  Average loss: 0.0023, Accuracy: 493/519 (94.9904%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3344, Accuracy: 8953/10000 (89.5300%)
___Train Local_Simple,  epoch  18, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 142/150 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1787, Accuracy: 9454/10000 (94.5400%)
___Train Local_Simple,  epoch  18, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 480/494 (97.1660%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2723, Accuracy: 9050/10000 (90.5000%)
___Train Local_Simple,  epoch  18, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 600/623 (96.3082%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2519, Accuracy: 9150/10000 (91.5000%)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1727, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 866/892 (97.0852%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4798, Accuracy: 8320/10000 (83.2000%)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 711/734 (96.8665%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2368, Accuracy: 9274/10000 (92.7400%)
___Train Local_Simple,  epoch  18, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1205/1227 (98.2070%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3339, Accuracy: 8941/10000 (89.4100%)
___Train Local_Simple,  epoch  18, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 844/860 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3832, Accuracy: 8844/10000 (88.4400%)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 676/699 (96.7096%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1883, Accuracy: 9371/10000 (93.7100%)
___Train Local_Simple,  epoch  18, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 328/343 (95.6268%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1403, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  18, local model 60, internal_epoch   1,  Average loss: 0.0023, Accuracy: 321/338 (94.9704%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1275, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch  18, local model 92, internal_epoch   1,  Average loss: 0.0018, Accuracy: 901/937 (96.1580%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4309, Accuracy: 8632/10000 (86.3200%)
___Train Local_Simple,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1930, Accuracy: 9326/10000 (93.2600%)
time spent on training: 332.62623357772827
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.1150, Accuracy: 9635/10000 (96.3500%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 343.52799797058105 sec.
Server Epoch:19 choose agents : [51, 73, 74, 41, 99, 97, 37, 44, 52, 88, 25, 28, 8, 16, 6, 3, 23, 27, 86, 35].
___adversary_clean___Train Local_Simple,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 559/568 (98.4155%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 586/591 (99.1540%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 545/557 (97.8456%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 594/606 (98.0198%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.288246104482102.
Norm before scaling: 17.2688442629417. Distance: 0.5785627769608838
Total norm for 4 adversaries is: 17.2688442629417. distance: 0.5785627769608838
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 17.288246104482102.
Norm before scaling: 17.249217140014192. Distance: 0.380692626445137
Total norm for 4 adversaries is: 17.249217140014192. distance: 0.380692626445137
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 17.288246104482102.
Norm before scaling: 17.28244019974646. Distance: 0.726622097073237
Total norm for 4 adversaries is: 17.28244019974646. distance: 0.726622097073237
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 17.288246104482102.
Norm before scaling: 17.26744281295954. Distance: 0.7123268720196637
Total norm for 4 adversaries is: 17.26744281295954. distance: 0.7123268720196637
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  19, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/377 (98.6737%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1310, Accuracy: 9589/10000 (95.8900%)
___Train Local_Simple,  epoch  19, local model 97, internal_epoch   1,  Average loss: 0.0013, Accuracy: 475/487 (97.5359%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2001, Accuracy: 9342/10000 (93.4200%)
___Train Local_Simple,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 839/860 (97.5581%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2088, Accuracy: 9386/10000 (93.8600%)
___Train Local_Simple,  epoch  19, local model 44, internal_epoch   1,  Average loss: 0.0021, Accuracy: 498/517 (96.3250%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1954, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  19, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1749, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch  19, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 522/530 (98.4906%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2399, Accuracy: 9326/10000 (93.2600%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0015, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2440, Accuracy: 9222/10000 (92.2200%)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0020, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1214, Accuracy: 9618/10000 (96.1800%)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 602/633 (95.1027%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3127, Accuracy: 9040/10000 (90.4000%)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 893/915 (97.5956%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1257, Accuracy: 9603/10000 (96.0300%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0018, Accuracy: 591/615 (96.0976%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1911, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 892/923 (96.6414%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2226, Accuracy: 9306/10000 (93.0600%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 287/293 (97.9522%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1278, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  19, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 456/471 (96.8153%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1329, Accuracy: 9570/10000 (95.7000%)
___Train Local_Simple,  epoch  19, local model 86, internal_epoch   1,  Average loss: 0.0019, Accuracy: 241/250 (96.4000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1090, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  19, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1678, Accuracy: 9481/10000 (94.8100%)
time spent on training: 334.27506709098816
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0927, Accuracy: 9736/10000 (97.3600%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 344.6981704235077 sec.
Server Epoch:20 choose agents : [74, 51, 41, 73, 43, 33, 12, 97, 15, 42, 20, 90, 56, 54, 24, 38, 32, 62, 8, 35].
___adversary_clean___Train Local_Simple,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 550/557 (98.7433%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 563/568 (99.1197%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 596/606 (98.3498%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 586/591 (99.1540%)
poison local model 74 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 17.25389519540624.
Norm before scaling: 17.22911333155036. Distance: 0.4489648516094014
Total norm for 4 adversaries is: 17.22911333155036. distance: 0.4489648516094014
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.25389519540624.
Norm before scaling: 17.21724432646716. Distance: 0.5052459119473759
Total norm for 4 adversaries is: 17.21724432646716. distance: 0.5052459119473759
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 17.25389519540624.
Norm before scaling: 17.224729742357805. Distance: 0.617773719230344
Total norm for 4 adversaries is: 17.224729742357805. distance: 0.617773719230344
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 17.25389519540624.
Norm before scaling: 17.215365373167096. Distance: 0.6565827706724273
Total norm for 4 adversaries is: 17.215365373167096. distance: 0.6565827706724273
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2920, Accuracy: 9127/10000 (91.2700%)
___Train Local_Simple,  epoch  20, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2106, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1129/1160 (97.3276%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1823, Accuracy: 9442/10000 (94.4200%)
___Train Local_Simple,  epoch  20, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 477/487 (97.9466%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1896, Accuracy: 9341/10000 (93.4100%)
___Train Local_Simple,  epoch  20, local model 15, internal_epoch   1,  Average loss: 0.0014, Accuracy: 391/401 (97.5062%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1585, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0014, Accuracy: 229/236 (97.0339%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1553, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch  20, local model 20, internal_epoch   1,  Average loss: 0.0014, Accuracy: 417/429 (97.2028%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2158, Accuracy: 9337/10000 (93.3700%)
___Train Local_Simple,  epoch  20, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 660/683 (96.6325%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4939, Accuracy: 8265/10000 (82.6500%)
___Train Local_Simple,  epoch  20, local model 56, internal_epoch   1,  Average loss: 0.0016, Accuracy: 850/880 (96.5909%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1305, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch  20, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1678, Accuracy: 9445/10000 (94.4500%)
___Train Local_Simple,  epoch  20, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 367/379 (96.8338%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1551, Accuracy: 9498/10000 (94.9800%)
___Train Local_Simple,  epoch  20, local model 38, internal_epoch   1,  Average loss: 0.0013, Accuracy: 870/895 (97.2067%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8142, Accuracy: 8116/10000 (81.1600%)
___Train Local_Simple,  epoch  20, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 931/977 (95.2917%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2263, Accuracy: 9245/10000 (92.4500%)
___Train Local_Simple,  epoch  20, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1201, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 608/633 (96.0506%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1485, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 490/499 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2689, Accuracy: 9166/10000 (91.6600%)
time spent on training: 332.3498830795288
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0855, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 342.84744000434875 sec.
Server Epoch:21 choose agents : [41, 74, 73, 51, 80, 63, 58, 26, 90, 89, 93, 79, 36, 67, 87, 65, 30, 98, 25, 54].
___adversary_clean___Train Local_Simple,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 600/606 (99.0099%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 550/557 (98.7433%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 586/591 (99.1540%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 564/568 (99.2958%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 17.194760540323394.
Norm before scaling: 17.18058365812944. Distance: 0.6020655572196443
Total norm for 4 adversaries is: 17.18058365812944. distance: 0.6020655572196443
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.194760540323394.
Norm before scaling: 17.172846203484024. Distance: 0.5233577838377532
Total norm for 4 adversaries is: 17.172846203484024. distance: 0.5233577838377532
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 17.194760540323394.
Norm before scaling: 17.154569838891966. Distance: 0.44247314339296795
Total norm for 4 adversaries is: 17.154569838891966. distance: 0.44247314339296795
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 17.194760540323394.
Norm before scaling: 17.156846777815026. Distance: 0.5137112968605426
Total norm for 4 adversaries is: 17.156846777815026. distance: 0.5137112968605426
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  21, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 420/431 (97.4478%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5434, Accuracy: 8684/10000 (86.8400%)
___Train Local_Simple,  epoch  21, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 867/889 (97.5253%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0867, Accuracy: 9748/10000 (97.4800%)
___Train Local_Simple,  epoch  21, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1197, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  21, local model 26, internal_epoch   1,  Average loss: 0.0014, Accuracy: 539/554 (97.2924%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2271, Accuracy: 9356/10000 (93.5600%)
___Train Local_Simple,  epoch  21, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 663/683 (97.0717%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2470, Accuracy: 9201/10000 (92.0100%)
___Train Local_Simple,  epoch  21, local model 89, internal_epoch   1,  Average loss: 0.0008, Accuracy: 487/492 (98.9837%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1274, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 614/623 (98.5554%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2942, Accuracy: 9087/10000 (90.8700%)
___Train Local_Simple,  epoch  21, local model 79, internal_epoch   1,  Average loss: 0.0021, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0943, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 988/1005 (98.3085%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6289, Accuracy: 8329/10000 (83.2900%)
___Train Local_Simple,  epoch  21, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 964/998 (96.5932%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2120, Accuracy: 9298/10000 (92.9800%)
___Train Local_Simple,  epoch  21, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 464/470 (98.7234%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1564, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch  21, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1378, Accuracy: 9536/10000 (95.3600%)
___Train Local_Simple,  epoch  21, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1862, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch  21, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 791/818 (96.6993%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2301, Accuracy: 9248/10000 (92.4800%)
___Train Local_Simple,  epoch  21, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 629/647 (97.2179%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4528, Accuracy: 8635/10000 (86.3500%)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 500/519 (96.3391%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3303, Accuracy: 8973/10000 (89.7300%)
time spent on training: 331.7426497936249
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0810, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 342.16280794143677 sec.
Server Epoch:22 choose agents : [73, 41, 74, 51, 6, 35, 17, 20, 77, 44, 8, 78, 3, 39, 14, 32, 4, 30, 65, 23].
___adversary_clean___Train Local_Simple,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 585/591 (98.9848%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 599/606 (98.8449%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 551/557 (98.9228%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 559/568 (98.4155%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 17.145883565514712.
Norm before scaling: 17.104745735033777. Distance: 0.5567461415719402
Total norm for 4 adversaries is: 17.104745735033777. distance: 0.5567461415719402
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 17.145883565514712.
Norm before scaling: 17.11899522631494. Distance: 0.5365220621519787
Total norm for 4 adversaries is: 17.11899522631494. distance: 0.5365220621519787
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.145883565514712.
Norm before scaling: 17.115500829725775. Distance: 0.4313962080414367
Total norm for 4 adversaries is: 17.115500829725775. distance: 0.4313962080414367
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 17.145883565514712.
Norm before scaling: 17.11458521552916. Distance: 0.559799174163907
Total norm for 4 adversaries is: 17.11458521552916. distance: 0.559799174163907
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2099, Accuracy: 9340/10000 (93.4000%)
___Train Local_Simple,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0009, Accuracy: 489/499 (97.9960%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1325, Accuracy: 9578/10000 (95.7800%)
___Train Local_Simple,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1708, Accuracy: 9450/10000 (94.5000%)
___Train Local_Simple,  epoch  22, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 421/429 (98.1352%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2703, Accuracy: 9185/10000 (91.8500%)
___Train Local_Simple,  epoch  22, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 575/589 (97.6231%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1901, Accuracy: 9387/10000 (93.8700%)
___Train Local_Simple,  epoch  22, local model 44, internal_epoch   1,  Average loss: 0.0018, Accuracy: 500/517 (96.7118%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2480, Accuracy: 9226/10000 (92.2600%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 613/633 (96.8404%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1313, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch  22, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1752, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0013, Accuracy: 899/923 (97.3998%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1786, Accuracy: 9396/10000 (93.9600%)
___Train Local_Simple,  epoch  22, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0915, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 366/376 (97.3404%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1062, Accuracy: 9704/10000 (97.0400%)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0021, Accuracy: 938/977 (96.0082%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2239, Accuracy: 9283/10000 (92.8300%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 641/658 (97.4164%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1305, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  22, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 393/400 (98.2500%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1240, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0862, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch  22, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1075, Accuracy: 9653/10000 (96.5300%)
time spent on training: 334.59087085723877
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0706, Accuracy: 9797/10000 (97.9700%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 345.2830798625946 sec.
Server Epoch:23 choose agents : [41, 51, 74, 73, 43, 25, 17, 37, 46, 56, 30, 0, 33, 53, 65, 6, 24, 86, 35, 84].
___adversary_clean___Train Local_Simple,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 601/606 (99.1749%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 563/568 (99.1197%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 552/557 (99.1023%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 588/591 (99.4924%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 17.093325984514852.
Norm before scaling: 17.06771200872837. Distance: 0.5452458228852467
Total norm for 4 adversaries is: 17.06771200872837. distance: 0.5452458228852467
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.093325984514852.
Norm before scaling: 17.06339068760405. Distance: 0.6087818437820812
Total norm for 4 adversaries is: 17.06339068760405. distance: 0.6087818437820812
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.093325984514852.
Norm before scaling: 17.068037427054353. Distance: 0.4318723099951874
Total norm for 4 adversaries is: 17.068037427054353. distance: 0.4318723099951874
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 17.093325984514852.
Norm before scaling: 17.064499510817406. Distance: 0.5940333744235644
Total norm for 4 adversaries is: 17.064499510817406. distance: 0.5940333744235644
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  23, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1111, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch  23, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5560, Accuracy: 8242/10000 (82.4200%)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1391, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  23, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4297, Accuracy: 8735/10000 (87.3500%)
___Train Local_Simple,  epoch  23, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2675, Accuracy: 9148/10000 (91.4800%)
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0011, Accuracy: 862/880 (97.9545%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0997, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  23, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3216, Accuracy: 9040/10000 (90.4000%)
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 427/435 (98.1609%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1498, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch  23, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 605/623 (97.1108%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1034, Accuracy: 9649/10000 (96.4900%)
___Train Local_Simple,  epoch  23, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 720/739 (97.4290%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2854, Accuracy: 9131/10000 (91.3100%)
___Train Local_Simple,  epoch  23, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 363/371 (97.8437%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1740, Accuracy: 9421/10000 (94.2100%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 606/615 (98.5366%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1816, Accuracy: 9457/10000 (94.5700%)
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 369/379 (97.3615%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0966, Accuracy: 9692/10000 (96.9200%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0888, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  23, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1306, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  23, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1212/1246 (97.2713%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1728, Accuracy: 9473/10000 (94.7300%)
time spent on training: 343.1521751880646
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0892, Accuracy: 9725/10000 (97.2500%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 353.87852215766907 sec.
Server Epoch:24 choose agents : [51, 41, 74, 73, 76, 42, 25, 16, 95, 52, 59, 81, 77, 21, 10, 8, 40, 54, 46, 30].
___adversary_clean___Train Local_Simple,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 564/568 (99.2958%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 603/606 (99.5050%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 550/557 (98.7433%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 586/591 (99.1540%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.043233312896135.
Norm before scaling: 16.999727134758665. Distance: 0.40475923940705294
Total norm for 4 adversaries is: 16.999727134758665. distance: 0.40475923940705294
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 17.043233312896135.
Norm before scaling: 16.99714008285199. Distance: 0.3723802051955109
Total norm for 4 adversaries is: 16.99714008285199. distance: 0.3723802051955109
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.043233312896135.
Norm before scaling: 17.011260847023326. Distance: 0.3436003164034298
Total norm for 4 adversaries is: 17.011260847023326. distance: 0.3436003164034298
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 17.043233312896135.
Norm before scaling: 17.000547512437834. Distance: 0.5230038113063137
Total norm for 4 adversaries is: 17.000547512437834. distance: 0.5230038113063137
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  24, local model 76, internal_epoch   1,  Average loss: 0.0017, Accuracy: 74/78 (94.8718%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0882, Accuracy: 9737/10000 (97.3700%)
___Train Local_Simple,  epoch  24, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0730, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0008, Accuracy: 633/647 (97.8362%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1997, Accuracy: 9349/10000 (93.4900%)
___Train Local_Simple,  epoch  24, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 894/915 (97.7049%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0968, Accuracy: 9692/10000 (96.9200%)
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.7766, Accuracy: 8228/10000 (82.2800%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1070, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch  24, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 744/760 (97.8947%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2760, Accuracy: 9092/10000 (90.9200%)
___Train Local_Simple,  epoch  24, local model 81, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1213/1227 (98.8590%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3942, Accuracy: 8850/10000 (88.5000%)
___Train Local_Simple,  epoch  24, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 568/589 (96.4346%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1186, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  24, local model 21, internal_epoch   1,  Average loss: 0.0010, Accuracy: 306/312 (98.0769%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1077, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 838/892 (93.9462%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2771, Accuracy: 9051/10000 (90.5100%)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 619/633 (97.7883%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2018, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch  24, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 762/772 (98.7047%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1300, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  24, local model 54, internal_epoch   1,  Average loss: 0.0018, Accuracy: 499/519 (96.1464%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2083, Accuracy: 9360/10000 (93.6000%)
___Train Local_Simple,  epoch  24, local model 46, internal_epoch   1,  Average loss: 0.0036, Accuracy: 677/710 (95.3521%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4977, Accuracy: 8461/10000 (84.6100%)
___Train Local_Simple,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 391/400 (97.7500%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1245, Accuracy: 9617/10000 (96.1700%)
time spent on training: 349.798481464386
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0700, Accuracy: 9793/10000 (97.9300%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Done in 360.7076210975647 sec.
Server Epoch:25 choose agents : [41, 73, 74, 51, 11, 24, 43, 4, 23, 25, 97, 91, 57, 72, 15, 94, 95, 90, 69, 20].
___adversary_clean___Train Local_Simple,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 600/606 (99.0099%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 588/591 (99.4924%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 554/557 (99.4614%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0003, ___adversary_clean___Accuracy: 564/568 (99.2958%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.97986262792727.
Norm before scaling: 16.941545404518425. Distance: 0.42534520630996714
Total norm for 4 adversaries is: 16.941545404518425. distance: 0.42534520630996714
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.97986262792727.
Norm before scaling: 16.9262919486478. Distance: 0.34475837539114806
Total norm for 4 adversaries is: 16.9262919486478. distance: 0.34475837539114806
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.97986262792727.
Norm before scaling: 16.956164222103805. Distance: 0.40768158371542135
Total norm for 4 adversaries is: 16.956164222103805. distance: 0.40768158371542135
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.97986262792727.
Norm before scaling: 16.945769933890396. Distance: 0.48391584968837337
Total norm for 4 adversaries is: 16.945769933890396. distance: 0.48391584968837337
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1769, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  25, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 368/379 (97.0976%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1037, Accuracy: 9672/10000 (96.7200%)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1971, Accuracy: 9386/10000 (93.8600%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 645/658 (98.0243%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1816, Accuracy: 9372/10000 (93.7200%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1045, Accuracy: 9644/10000 (96.4400%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0022, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.3218, Accuracy: 6273/10000 (62.7300%)
___Train Local_Simple,  epoch  25, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 478/487 (98.1520%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2347, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch  25, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0782, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch  25, local model 57, internal_epoch   1,  Average loss: 0.0013, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1813, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch  25, local model 72, internal_epoch   1,  Average loss: 0.0010, Accuracy: 716/731 (97.9480%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3465, Accuracy: 8907/10000 (89.0700%)
___Train Local_Simple,  epoch  25, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 392/401 (97.7556%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1314, Accuracy: 9572/10000 (95.7200%)
___Train Local_Simple,  epoch  25, local model 94, internal_epoch   1,  Average loss: 0.0018, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1326, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  25, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.7096, Accuracy: 7851/10000 (78.5100%)
___Train Local_Simple,  epoch  25, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 668/683 (97.8038%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2725, Accuracy: 9074/10000 (90.7400%)
___Train Local_Simple,  epoch  25, local model 69, internal_epoch   1,  Average loss: 0.0016, Accuracy: 245/256 (95.7031%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1974, Accuracy: 9364/10000 (93.6400%)
___Train Local_Simple,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 422/429 (98.3683%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1824, Accuracy: 9448/10000 (94.4800%)
time spent on training: 354.8195855617523
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0608, Accuracy: 9815/10000 (98.1500%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
saving model
Saving model on epoch 25
Done in 365.5868239402771 sec.
Saving all the graphs.
This run has a label: Feb.17_19.46.02. Visdom environment: mnist_DBA

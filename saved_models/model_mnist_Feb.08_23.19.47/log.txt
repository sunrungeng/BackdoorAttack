current path: saved_models/model_mnist_Feb.08_23.19.47
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43].
___adversary_clean___Train Local_Simple,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 579/591 (97.9695%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 555/568 (97.7113%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0015, ___adversary_clean___Accuracy: 544/557 (97.6661%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0228, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0121, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0073, Accuracy: 534/606 (88.1188%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0045, Accuracy: 554/606 (91.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0042, Accuracy: 557/606 (91.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0032, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0032, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0027, Accuracy: 575/606 (94.8845%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0026, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0023, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.817401157415883. Distance: 4.714787113889329
Total norm for 4 adversaries is: 16.817401157415883. distance: 4.714787113889329
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0630, Accuracy: 8814/8968 (98.2828%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0261, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0135, Accuracy: 375/591 (63.4518%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0072, Accuracy: 498/591 (84.2640%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0060, Accuracy: 500/591 (84.6024%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0052, Accuracy: 522/591 (88.3249%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0041, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0034, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0031, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0027, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.80608123433533. Distance: 4.568520323359226
Total norm for 4 adversaries is: 16.80608123433533. distance: 4.568520323359226
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0515, Accuracy: 8852/8968 (98.7065%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0236, Accuracy: 337/568 (59.3310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0102, Accuracy: 454/568 (79.9296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0049, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0046, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0037, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0033, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0025, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0023, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0023, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0023, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.759785540899774. Distance: 4.586053746064474
Total norm for 4 adversaries is: 16.759785540899774. distance: 4.586053746064474
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0644, Accuracy: 8764/8968 (97.7252%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0240, Accuracy: 313/557 (56.1939%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0113, Accuracy: 381/557 (68.4022%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0053, Accuracy: 502/557 (90.1257%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0039, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0036, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0028, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0021, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.84416218042758. Distance: 4.542233539632727
Total norm for 4 adversaries is: 16.84416218042758. distance: 4.542233539632727
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0832, Accuracy: 8634/8968 (96.2756%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1545, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0016, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0853, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 853/889 (95.9505%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1665, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 623/645 (96.5891%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2816, Accuracy: 9074/10000 (90.7400%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 670/686 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1550, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2867, Accuracy: 9062/10000 (90.6200%)
time spent on training: 276.3379464149475

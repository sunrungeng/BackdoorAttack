current path: saved_models/model_mnist_Feb.17_23.19.14
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43, 46, 37, 21, 35, 61, 64, 28, 67, 22, 82].
___adversary_clean___Train Local_Simple,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 579/591 (97.9695%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 555/568 (97.7113%)
___adversary_clean___Train Local_Simple,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0015, ___adversary_clean___Accuracy: 544/557 (97.6661%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0236, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0148, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0133, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0118, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0119, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0114, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0109, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.72017645053752. Distance: 4.614804758424134
Total norm for 4 adversaries is: 16.72017645053752. distance: 4.614804758424134
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9041, Accuracy: 5498/8968 (61.3069%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0274, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0205, Accuracy: 280/591 (47.3773%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0208, Accuracy: 242/591 (40.9475%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0182, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0168, Accuracy: 297/591 (50.2538%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0161, Accuracy: 305/591 (51.6074%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0148, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0147, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0142, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0143, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.670373936642815. Distance: 4.4785718419389235
Total norm for 4 adversaries is: 16.670373936642815. distance: 4.4785718419389235
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8269, Accuracy: 6357/8968 (70.8854%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0251, Accuracy: 319/568 (56.1620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0142, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0122, Accuracy: 367/568 (64.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0121, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0114, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0111, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0105, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0105, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0107, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0104, Accuracy: 380/568 (66.9014%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.663060726452315. Distance: 4.622525352132048
Total norm for 4 adversaries is: 16.663060726452315. distance: 4.622525352132048
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5533, Accuracy: 7076/8968 (78.9028%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0239, Accuracy: 315/557 (56.5530%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0123, Accuracy: 363/557 (65.1706%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0068, Accuracy: 486/557 (87.2531%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0054, Accuracy: 495/557 (88.8689%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0049, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0038, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0030, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.844111451073097. Distance: 4.454075761990886
Total norm for 4 adversaries is: 16.844111451073097. distance: 4.454075761990886
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1683, Accuracy: 8260/8968 (92.1053%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1545, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0016, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0853, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 853/889 (95.9505%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1665, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 623/645 (96.5891%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2816, Accuracy: 9074/10000 (90.7400%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 670/686 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1550, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2867, Accuracy: 9062/10000 (90.6200%)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0019, Accuracy: 682/710 (96.0563%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3995, Accuracy: 8679/10000 (86.7900%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 837/860 (97.3256%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3147, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 304/312 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2001, Accuracy: 9383/10000 (93.8300%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2008, Accuracy: 9416/10000 (94.1600%)
___Train Local_Simple,  epoch  11, local model 61, internal_epoch   1,  Average loss: 0.0017, Accuracy: 673/699 (96.2804%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4396, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  11, local model 64, internal_epoch   1,  Average loss: 0.0022, Accuracy: 781/813 (96.0640%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5151, Accuracy: 8166/10000 (81.6600%)
___Train Local_Simple,  epoch  11, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 482/501 (96.2076%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1038, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  11, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2293, Accuracy: 9262/10000 (92.6200%)
___Train Local_Simple,  epoch  11, local model 22, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3431, Accuracy: 8993/10000 (89.9300%)
___Train Local_Simple,  epoch  11, local model 82, internal_epoch   1,  Average loss: 0.0016, Accuracy: 689/713 (96.6339%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2847, Accuracy: 9066/10000 (90.6600%)
time spent on training: 366.2198255062103
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.3651, Accuracy: 9297/10000 (92.9700%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 2.6044, Accuracy: 480/8968 (5.3524%)
saving model
Done in 376.5887997150421 sec.
Server Epoch:12 choose agents : [41, 51, 73, 74, 57, 63, 77, 18, 43, 91, 42, 52, 28, 37, 96, 99, 80, 13, 98, 78].
___adversary_clean___Train Local_Simple,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0026, ___adversary_clean___Accuracy: 582/606 (96.0396%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0018, ___adversary_clean___Accuracy: 555/568 (97.7113%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0019, ___adversary_clean___Accuracy: 575/591 (97.2927%)
___adversary_clean___Train Local_Simple,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0025, ___adversary_clean___Accuracy: 544/557 (97.6661%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0141, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0148, Accuracy: 360/606 (59.4059%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0100, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Global model norm: 16.399773647327994.
Norm before scaling: 16.480479397513744. Distance: 1.9374081374510126
Total norm for 4 adversaries is: 16.480479397513744. distance: 1.9374081374510126
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.0678, Accuracy: 4007/8968 (44.6811%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0128, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0106, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0099, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0092, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0084, Accuracy: 419/568 (73.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0077, Accuracy: 456/568 (80.2817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0070, Accuracy: 443/568 (77.9930%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0060, Accuracy: 500/568 (88.0282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0054, Accuracy: 509/568 (89.6127%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0049, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Global model norm: 16.399773647327994.
Norm before scaling: 16.49320057730467. Distance: 1.7307035058738804
Total norm for 4 adversaries is: 16.49320057730467. distance: 1.7307035058738804
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.3214, Accuracy: 7953/8968 (88.6820%)
poison local model 73 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0201, Accuracy: 319/591 (53.9763%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0201, Accuracy: 230/591 (38.9171%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0146, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0134, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0130, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0121, Accuracy: 389/591 (65.8206%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0110, Accuracy: 419/591 (70.8968%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0111, Accuracy: 404/591 (68.3587%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0114, Accuracy: 398/591 (67.3435%), train_poison_data_count: 195
Global model norm: 16.399773647327994.
Norm before scaling: 16.537700699722247. Distance: 2.3806450663647523
Total norm for 4 adversaries is: 16.537700699722247. distance: 2.3806450663647523
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.6291, Accuracy: 6214/8968 (69.2908%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0123, Accuracy: 374/557 (67.1454%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0061, Accuracy: 486/557 (87.2531%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0030, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.399773647327994.
Norm before scaling: 16.606207070889187. Distance: 2.249298622168033
Total norm for 4 adversaries is: 16.606207070889187. distance: 2.249298622168033
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0831, Accuracy: 8654/8968 (96.4987%)
___Train Local_Simple,  epoch  12, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 327/343 (95.3353%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1831, Accuracy: 9443/10000 (94.4300%)
___Train Local_Simple,  epoch  12, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 856/889 (96.2880%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1436, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0032, Accuracy: 567/589 (96.2649%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1712, Accuracy: 9488/10000 (94.8800%)
___Train Local_Simple,  epoch  12, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 431/459 (93.8998%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5966, Accuracy: 8572/10000 (85.7200%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0025, Accuracy: 390/408 (95.5882%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2573, Accuracy: 9214/10000 (92.1400%)
___Train Local_Simple,  epoch  12, local model 91, internal_epoch   1,  Average loss: 0.0025, Accuracy: 250/256 (97.6562%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2627, Accuracy: 9258/10000 (92.5800%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 225/236 (95.3390%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2538, Accuracy: 9222/10000 (92.2200%)
___Train Local_Simple,  epoch  12, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 243/253 (96.0474%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3129, Accuracy: 9130/10000 (91.3000%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0032, Accuracy: 480/501 (95.8084%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1795, Accuracy: 9430/10000 (94.3000%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 835/860 (97.0930%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2574, Accuracy: 9291/10000 (92.9100%)
___Train Local_Simple,  epoch  12, local model 96, internal_epoch   1,  Average loss: 0.0024, Accuracy: 652/672 (97.0238%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3990, Accuracy: 8911/10000 (89.1100%)
___Train Local_Simple,  epoch  12, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 367/377 (97.3475%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6248, Accuracy: 8134/10000 (81.3400%)
___Train Local_Simple,  epoch  12, local model 80, internal_epoch   1,  Average loss: 0.0023, Accuracy: 420/431 (97.4478%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7117, Accuracy: 8166/10000 (81.6600%)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 703/734 (95.7766%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5360, Accuracy: 8454/10000 (84.5400%)
___Train Local_Simple,  epoch  12, local model 98, internal_epoch   1,  Average loss: 0.0025, Accuracy: 783/818 (95.7213%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4950, Accuracy: 8498/10000 (84.9800%)
___Train Local_Simple,  epoch  12, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 292/303 (96.3696%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6466, Accuracy: 8098/10000 (80.9800%)
time spent on training: 328.543434381485
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.1106, Accuracy: 9706/10000 (97.0600%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 5.2575, Accuracy: 148/8968 (1.6503%)
saving model
Done in 339.7900037765503 sec.
Server Epoch:13 choose agents : [41, 74, 51, 73, 50, 67, 14, 36, 24, 7, 4, 80, 39, 26, 29, 42, 69, 95, 8, 25].
___adversary_clean___Train Local_Simple,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0016, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0015, ___adversary_clean___Accuracy: 542/557 (97.3070%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 556/568 (97.8873%)
___adversary_clean___Train Local_Simple,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0019, ___adversary_clean___Accuracy: 574/591 (97.1235%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0149, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0146, Accuracy: 329/606 (54.2904%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.502443074933066.
Norm before scaling: 16.517447754488757. Distance: 2.189276709412489
Total norm for 4 adversaries is: 16.517447754488757. distance: 2.189276709412489
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.9057, Accuracy: 4901/8968 (54.6499%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0164, Accuracy: 339/557 (60.8618%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0133, Accuracy: 337/557 (60.5027%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0105, Accuracy: 385/557 (69.1203%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0101, Accuracy: 391/557 (70.1975%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0095, Accuracy: 390/557 (70.0180%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0088, Accuracy: 422/557 (75.7630%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0078, Accuracy: 448/557 (80.4309%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0071, Accuracy: 473/557 (84.9192%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0065, Accuracy: 491/557 (88.1508%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0061, Accuracy: 488/557 (87.6122%), train_poison_data_count: 180
Global model norm: 16.502443074933066.
Norm before scaling: 16.545356140453826. Distance: 2.2213517099943063
Total norm for 4 adversaries is: 16.545356140453826. distance: 2.2213517099943063
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.4151, Accuracy: 7378/8968 (82.2703%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0147, Accuracy: 364/568 (64.0845%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0103, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0097, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0081, Accuracy: 450/568 (79.2254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0070, Accuracy: 464/568 (81.6901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0061, Accuracy: 485/568 (85.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0048, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0039, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0031, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0029, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Global model norm: 16.502443074933066.
Norm before scaling: 16.597370794350418. Distance: 2.368749826879168
Total norm for 4 adversaries is: 16.597370794350418. distance: 2.368749826879168
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1221, Accuracy: 8588/8968 (95.7627%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0122, Accuracy: 406/591 (68.6971%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 504/591 (85.2792%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0025, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0025, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0020, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0015, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0012, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0011, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0011, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Global model norm: 16.502443074933066.
Norm before scaling: 16.76683451048388. Distance: 2.870656090419981
Total norm for 4 adversaries is: 16.76683451048388. distance: 2.870656090419981
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1064, Accuracy: 8568/8968 (95.5397%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   1,  Average loss: 0.0023, Accuracy: 451/474 (95.1477%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2840, Accuracy: 9102/10000 (91.0200%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 977/998 (97.8958%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1562, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 367/376 (97.6064%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1153, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  13, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 983/1005 (97.8109%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7617, Accuracy: 8425/10000 (84.2500%)
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0019, Accuracy: 368/379 (97.0976%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1922, Accuracy: 9399/10000 (93.9900%)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 408/418 (97.6077%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2139, Accuracy: 9360/10000 (93.6000%)
___Train Local_Simple,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 637/658 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3957, Accuracy: 8705/10000 (87.0500%)
___Train Local_Simple,  epoch  13, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1618, Accuracy: 9520/10000 (95.2000%)
___Train Local_Simple,  epoch  13, local model 39, internal_epoch   1,  Average loss: 0.0017, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1445, Accuracy: 9550/10000 (95.5000%)
___Train Local_Simple,  epoch  13, local model 26, internal_epoch   1,  Average loss: 0.0018, Accuracy: 537/554 (96.9314%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1216, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  13, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 982/1002 (98.0040%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2770, Accuracy: 9200/10000 (92.0000%)
___Train Local_Simple,  epoch  13, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1274, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  13, local model 69, internal_epoch   1,  Average loss: 0.0025, Accuracy: 244/256 (95.3125%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2703, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  13, local model 95, internal_epoch   1,  Average loss: 0.0007, Accuracy: 595/602 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.8787, Accuracy: 7333/10000 (73.3300%)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 610/633 (96.3665%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3137, Accuracy: 9065/10000 (90.6500%)
___Train Local_Simple,  epoch  13, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 629/647 (97.2179%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3398, Accuracy: 8928/10000 (89.2800%)
time spent on training: 343.0438160896301
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.1365, Accuracy: 9643/10000 (96.4300%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 3.3309, Accuracy: 509/8968 (5.6757%)
saving model
Done in 353.620724439621 sec.
Server Epoch:14 choose agents : [51, 41, 74, 73, 10, 23, 7, 46, 65, 57, 83, 9, 64, 58, 12, 96, 90, 28, 33, 75].
___adversary_clean___Train Local_Simple,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 554/568 (97.5352%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0017, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 542/557 (97.3070%)
___adversary_clean___Train Local_Simple,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0013, ___adversary_clean___Accuracy: 576/591 (97.4619%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0136, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0110, Accuracy: 364/568 (64.0845%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0102, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0096, Accuracy: 408/568 (71.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0098, Accuracy: 390/568 (68.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0092, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0091, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0090, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0087, Accuracy: 408/568 (71.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0085, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Global model norm: 16.493108061411306.
Norm before scaling: 16.465638418693526. Distance: 1.6920114892384643
Total norm for 4 adversaries is: 16.465638418693526. distance: 1.6920114892384643
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5663, Accuracy: 6655/8968 (74.2083%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0141, Accuracy: 367/606 (60.5611%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0115, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0076, Accuracy: 469/606 (77.3927%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0060, Accuracy: 552/606 (91.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0048, Accuracy: 560/606 (92.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0029, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0023, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0016, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0014, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0014, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.493108061411306.
Norm before scaling: 16.615439053525076. Distance: 2.2328716635957533
Total norm for 4 adversaries is: 16.615439053525076. distance: 2.2328716635957533
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0779, Accuracy: 8682/8968 (96.8109%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0152, Accuracy: 333/557 (59.7846%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0086, Accuracy: 440/557 (78.9946%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0040, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.493108061411306.
Norm before scaling: 16.664888414249134. Distance: 2.3068400013391837
Total norm for 4 adversaries is: 16.664888414249134. distance: 2.3068400013391837
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0164, Accuracy: 8915/8968 (99.4090%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0094, Accuracy: 446/591 (75.4653%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0017, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.493108061411306.
Norm before scaling: 16.70487614329692. Distance: 2.4436616535266302
Total norm for 4 adversaries is: 16.70487614329692. distance: 2.4436616535266302
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0325, Accuracy: 8849/8968 (98.6731%)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 862/892 (96.6368%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4293, Accuracy: 8651/10000 (86.5100%)
___Train Local_Simple,  epoch  14, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1575, Accuracy: 9516/10000 (95.1600%)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0019, Accuracy: 409/418 (97.8469%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1192, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  14, local model 46, internal_epoch   1,  Average loss: 0.0018, Accuracy: 687/710 (96.7606%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2747, Accuracy: 9181/10000 (91.8100%)
___Train Local_Simple,  epoch  14, local model 65, internal_epoch   1,  Average loss: 0.0017, Accuracy: 360/371 (97.0350%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1837, Accuracy: 9400/10000 (94.0000%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0018, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1789, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch  14, local model 83, internal_epoch   1,  Average loss: 0.0023, Accuracy: 417/433 (96.3048%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1382, Accuracy: 9574/10000 (95.7400%)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0017, Accuracy: 422/436 (96.7890%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1358, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  14, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 787/813 (96.8020%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1771, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  14, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1769, Accuracy: 9507/10000 (95.0700%)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1131/1160 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1668, Accuracy: 9458/10000 (94.5800%)
___Train Local_Simple,  epoch  14, local model 96, internal_epoch   1,  Average loss: 0.0014, Accuracy: 655/672 (97.4702%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1852, Accuracy: 9444/10000 (94.4400%)
___Train Local_Simple,  epoch  14, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 660/683 (96.6325%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2992, Accuracy: 9032/10000 (90.3200%)
___Train Local_Simple,  epoch  14, local model 28, internal_epoch   1,  Average loss: 0.0018, Accuracy: 485/501 (96.8064%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1312, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  14, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2170, Accuracy: 9256/10000 (92.5600%)
___Train Local_Simple,  epoch  14, local model 75, internal_epoch   1,  Average loss: 0.0017, Accuracy: 659/686 (96.0641%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1795, Accuracy: 9498/10000 (94.9800%)
time spent on training: 342.81816697120667
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.1037, Accuracy: 9726/10000 (97.2600%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 2.9120, Accuracy: 930/8968 (10.3702%)
saving model
Done in 353.5900409221649 sec.
Server Epoch:15 choose agents : [73, 74, 41, 51, 80, 23, 25, 12, 58, 19, 11, 13, 82, 50, 34, 14, 55, 53, 36, 6].
___adversary_clean___Train Local_Simple,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 580/591 (98.1387%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0016, ___adversary_clean___Accuracy: 537/557 (96.4093%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 592/606 (97.6898%)
___adversary_clean___Train Local_Simple,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 555/568 (97.7113%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0188, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0161, Accuracy: 298/591 (50.4230%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0121, Accuracy: 393/591 (66.4975%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0110, Accuracy: 448/591 (75.8037%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0096, Accuracy: 468/591 (79.1878%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0073, Accuracy: 520/591 (87.9865%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0055, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0037, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0027, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0030, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Global model norm: 16.514003475566295.
Norm before scaling: 16.658257969960424. Distance: 2.46345638157094
Total norm for 4 adversaries is: 16.658257969960424. distance: 2.46345638157094
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0223, Accuracy: 8915/8968 (99.4090%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0145, Accuracy: 350/557 (62.8366%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0068, Accuracy: 464/557 (83.3034%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.514003475566295.
Norm before scaling: 16.698384025190414. Distance: 2.43722728279554
Total norm for 4 adversaries is: 16.698384025190414. distance: 2.43722728279554
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0374, Accuracy: 8814/8968 (98.2828%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0118, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0050, Accuracy: 532/606 (87.7888%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0022, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0016, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0014, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.514003475566295.
Norm before scaling: 16.73239075537698. Distance: 2.507027000930053
Total norm for 4 adversaries is: 16.73239075537698. distance: 2.507027000930053
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0134, Accuracy: 8912/8968 (99.3756%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 503/568 (88.5563%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0019, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0008, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.514003475566295.
Norm before scaling: 16.677076420334814. Distance: 1.8218062661031684
Total norm for 4 adversaries is: 16.677076420334814. distance: 1.8218062661031684
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0360, Accuracy: 8823/8968 (98.3831%)
___Train Local_Simple,  epoch  15, local model 80, internal_epoch   1,  Average loss: 0.0011, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2766, Accuracy: 9189/10000 (91.8900%)
___Train Local_Simple,  epoch  15, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1526, Accuracy: 9509/10000 (95.0900%)
___Train Local_Simple,  epoch  15, local model 25, internal_epoch   1,  Average loss: 0.0024, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3801, Accuracy: 8758/10000 (87.5800%)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1129/1160 (97.3276%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4233, Accuracy: 8709/10000 (87.0900%)
___Train Local_Simple,  epoch  15, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1546, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch  15, local model 19, internal_epoch   1,  Average loss: 0.0029, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1272, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1648, Accuracy: 9476/10000 (94.7600%)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 721/734 (98.2289%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2761, Accuracy: 9253/10000 (92.5300%)
___Train Local_Simple,  epoch  15, local model 82, internal_epoch   1,  Average loss: 0.0014, Accuracy: 697/713 (97.7560%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2854, Accuracy: 9015/10000 (90.1500%)
___Train Local_Simple,  epoch  15, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 460/474 (97.0464%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1574, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  15, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 409/413 (99.0315%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2194, Accuracy: 9332/10000 (93.3200%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1221, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 348/354 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1988, Accuracy: 9349/10000 (93.4900%)
___Train Local_Simple,  epoch  15, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 726/739 (98.2409%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2823, Accuracy: 9175/10000 (91.7500%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 985/1005 (98.0100%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4108, Accuracy: 8878/10000 (88.7800%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 595/615 (96.7480%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1753, Accuracy: 9433/10000 (94.3300%)
time spent on training: 333.0335257053375
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.1128, Accuracy: 9682/10000 (96.8200%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 1.3475, Accuracy: 4532/8968 (50.5352%)
saving model
Done in 343.8609139919281 sec.
Server Epoch:16 choose agents : [73, 74, 51, 41, 43, 17, 2, 66, 6, 38, 37, 45, 81, 4, 24, 54, 10, 11, 80, 7].
___adversary_clean___Train Local_Simple,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 580/591 (98.1387%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 545/557 (97.8456%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 561/568 (98.7676%)
___adversary_clean___Train Local_Simple,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 596/606 (98.3498%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0152, Accuracy: 375/591 (63.4518%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0086, Accuracy: 447/591 (75.6345%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0027, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0024, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0018, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.548227746581638.
Norm before scaling: 16.80434971766518. Distance: 2.7043124550978503
Total norm for 4 adversaries is: 16.80434971766518. distance: 2.7043124550978503
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0126, Accuracy: 8922/8968 (99.4871%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0110, Accuracy: 412/557 (73.9677%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0032, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.548227746581638.
Norm before scaling: 16.777044980605197. Distance: 2.286509890543494
Total norm for 4 adversaries is: 16.777044980605197. distance: 2.286509890543494
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0038, Accuracy: 8954/8968 (99.8439%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0080, Accuracy: 449/568 (79.0493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0021, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0008, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.548227746581638.
Norm before scaling: 16.826487341971625. Distance: 2.2499488188962404
Total norm for 4 adversaries is: 16.826487341971625. distance: 2.2499488188962404
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0111, Accuracy: 8929/8968 (99.5651%)
poison local model 41 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 537/606 (88.6139%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0027, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0014, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Global model norm: 16.548227746581638.
Norm before scaling: 16.771739004886967. Distance: 2.1791594491210606
Total norm for 4 adversaries is: 16.771739004886967. distance: 2.1791594491210606
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0159, Accuracy: 8903/8968 (99.2752%)
___Train Local_Simple,  epoch  16, local model 43, internal_epoch   1,  Average loss: 0.0018, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1174, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch  16, local model 17, internal_epoch   1,  Average loss: 0.0018, Accuracy: 599/620 (96.6129%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1644, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1619, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch  16, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 644/660 (97.5758%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3520, Accuracy: 8883/10000 (88.8300%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 595/615 (96.7480%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2916, Accuracy: 9162/10000 (91.6200%)
___Train Local_Simple,  epoch  16, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 871/895 (97.3184%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3383, Accuracy: 8832/10000 (88.3200%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1480, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  16, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 613/628 (97.6115%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2324, Accuracy: 9266/10000 (92.6600%)
___Train Local_Simple,  epoch  16, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1206/1227 (98.2885%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3271, Accuracy: 8983/10000 (89.8300%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 646/658 (98.1763%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4002, Accuracy: 8736/10000 (87.3600%)
___Train Local_Simple,  epoch  16, local model 24, internal_epoch   1,  Average loss: 0.0018, Accuracy: 363/379 (95.7784%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1373, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  16, local model 54, internal_epoch   1,  Average loss: 0.0016, Accuracy: 502/519 (96.7245%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2501, Accuracy: 9216/10000 (92.1600%)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 871/892 (97.6457%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3309, Accuracy: 8964/10000 (89.6400%)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 630/645 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2427, Accuracy: 9155/10000 (91.5500%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2641, Accuracy: 9240/10000 (92.4000%)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 409/418 (97.8469%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2008, Accuracy: 9370/10000 (93.7000%)
time spent on training: 329.625048160553
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.0946, Accuracy: 9738/10000 (97.3800%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.9975, Accuracy: 6126/8968 (68.3095%)
saving model
Done in 340.03164410591125 sec.
Server Epoch:17 choose agents : [74, 41, 51, 73, 93, 25, 34, 57, 69, 58, 2, 4, 1, 20, 49, 27, 43, 0, 45, 8].
___adversary_clean___Train Local_Simple,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0012, ___adversary_clean___Accuracy: 543/557 (97.4865%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 593/606 (97.8548%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 560/568 (98.5915%)
___adversary_clean___Train Local_Simple,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 583/591 (98.6464%)
poison local model 74 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0151, Accuracy: 357/557 (64.0934%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0060, Accuracy: 500/557 (89.7666%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0021, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.60571271653881.
Norm before scaling: 16.852171878469683. Distance: 2.5726744400062507
Total norm for 4 adversaries is: 16.852171878469683. distance: 2.5726744400062507
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0013, Accuracy: 8964/8968 (99.9554%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0088, Accuracy: 499/606 (82.3432%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0015, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0012, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.60571271653881.
Norm before scaling: 16.83715917841305. Distance: 2.4395239814381746
Total norm for 4 adversaries is: 16.83715917841305. distance: 2.4395239814381746
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0272, Accuracy: 8864/8968 (98.8403%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0066, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0022, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0010, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.60571271653881.
Norm before scaling: 16.85928901883775. Distance: 2.1162603959595994
Total norm for 4 adversaries is: 16.85928901883775. distance: 2.1162603959595994
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0064, Accuracy: 8941/8968 (99.6989%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0017, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0012, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.60571271653881.
Norm before scaling: 16.785340334544436. Distance: 1.8638009360278216
Total norm for 4 adversaries is: 16.785340334544436. distance: 1.8638009360278216
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0043, Accuracy: 8950/8968 (99.7993%)
___Train Local_Simple,  epoch  17, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2006, Accuracy: 9355/10000 (93.5500%)
___Train Local_Simple,  epoch  17, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3714, Accuracy: 8761/10000 (87.6100%)
___Train Local_Simple,  epoch  17, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 408/413 (98.7893%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3316, Accuracy: 9052/10000 (90.5200%)
___Train Local_Simple,  epoch  17, local model 57, internal_epoch   1,  Average loss: 0.0023, Accuracy: 329/343 (95.9184%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1897, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  17, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1691, Accuracy: 9462/10000 (94.6200%)
___Train Local_Simple,  epoch  17, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 264/276 (95.6522%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1224, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0021, Accuracy: 534/548 (97.4453%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1507, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2477, Accuracy: 9145/10000 (91.4500%)
___Train Local_Simple,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 736/760 (96.8421%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1562, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch  17, local model 20, internal_epoch   1,  Average loss: 0.0015, Accuracy: 417/429 (97.2028%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3017, Accuracy: 9083/10000 (90.8300%)
___Train Local_Simple,  epoch  17, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1280, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  17, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1596, Accuracy: 9505/10000 (95.0500%)
___Train Local_Simple,  epoch  17, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2566, Accuracy: 9158/10000 (91.5800%)
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0018, Accuracy: 419/435 (96.3218%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2008, Accuracy: 9368/10000 (93.6800%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 616/628 (98.0892%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2018, Accuracy: 9338/10000 (93.3800%)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 615/633 (97.1564%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1603, Accuracy: 9516/10000 (95.1600%)
time spent on training: 325.8289635181427
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.1002, Accuracy: 9738/10000 (97.3800%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.1936, Accuracy: 8341/8968 (93.0085%)
saving model
Done in 336.31937432289124 sec.
Server Epoch:18 choose agents : [51, 73, 41, 74, 62, 65, 54, 94, 68, 33, 58, 10, 13, 81, 37, 61, 57, 60, 92, 23].
___adversary_clean___Train Local_Simple,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 556/568 (97.8873%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 582/591 (98.4772%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 595/606 (98.1848%)
___adversary_clean___Train Local_Simple,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 547/557 (98.2047%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0072, Accuracy: 487/568 (85.7394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0023, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.654426861409288.
Norm before scaling: 16.899404553639698. Distance: 2.210107546472315
Total norm for 4 adversaries is: 16.899404553639698. distance: 2.210107546472315
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0009, Accuracy: 8965/8968 (99.9665%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 513/591 (86.8020%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0026, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0008, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Global model norm: 16.654426861409288.
Norm before scaling: 16.954039433863542. Distance: 2.482747726603792
Total norm for 4 adversaries is: 16.954039433863542. distance: 2.482747726603792
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 555/606 (91.5842%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0016, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.654426861409288.
Norm before scaling: 16.842555072700613. Distance: 1.8659268516807845
Total norm for 4 adversaries is: 16.842555072700613. distance: 1.8659268516807845
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0083, Accuracy: 8941/8968 (99.6989%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0026, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.654426861409288.
Norm before scaling: 16.70532645981234. Distance: 1.1109584200105924
Total norm for 4 adversaries is: 16.70532645981234. distance: 1.1109584200105924
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0004, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 62, internal_epoch   1,  Average loss: 0.0010, Accuracy: 415/423 (98.1087%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1227, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  18, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 360/371 (97.0350%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1189, Accuracy: 9625/10000 (96.2500%)
___Train Local_Simple,  epoch  18, local model 54, internal_epoch   1,  Average loss: 0.0017, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2160, Accuracy: 9392/10000 (93.9200%)
___Train Local_Simple,  epoch  18, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1244, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  18, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 482/494 (97.5709%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2211, Accuracy: 9186/10000 (91.8600%)
___Train Local_Simple,  epoch  18, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2196, Accuracy: 9242/10000 (92.4200%)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 269/276 (97.4638%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1411, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 874/892 (97.9821%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4009, Accuracy: 8724/10000 (87.2400%)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 724/734 (98.6376%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2372, Accuracy: 9283/10000 (92.8300%)
___Train Local_Simple,  epoch  18, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1202/1227 (97.9625%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2133, Accuracy: 9324/10000 (93.2400%)
___Train Local_Simple,  epoch  18, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1941, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 681/699 (97.4249%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1979, Accuracy: 9344/10000 (93.4400%)
___Train Local_Simple,  epoch  18, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1615, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch  18, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 329/338 (97.3373%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1097, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  18, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 913/937 (97.4386%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3869, Accuracy: 8814/10000 (88.1400%)
___Train Local_Simple,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1448, Accuracy: 9525/10000 (95.2500%)
time spent on training: 325.94589042663574
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.1022, Accuracy: 9690/10000 (96.9000%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.0794, Accuracy: 8731/8968 (97.3573%)
saving model
Done in 336.4597671031952 sec.
Server Epoch:19 choose agents : [51, 73, 74, 41, 99, 97, 37, 44, 52, 88, 25, 28, 8, 16, 6, 3, 23, 27, 86, 35].
___adversary_clean___Train Local_Simple,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 561/568 (98.7676%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 586/591 (99.1540%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 546/557 (98.0251%)
___adversary_clean___Train Local_Simple,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 597/606 (98.5149%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0061, Accuracy: 503/568 (88.5563%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0013, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.700330280989675.
Norm before scaling: 16.987241557487252. Distance: 2.2806379986614975
Total norm for 4 adversaries is: 16.987241557487252. distance: 2.2806379986614975
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0004, Accuracy: 8967/8968 (99.9888%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 543/591 (91.8782%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0014, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.700330280989675.
Norm before scaling: 16.948967124054068. Distance: 2.059336345581901
Total norm for 4 adversaries is: 16.948967124054068. distance: 2.059336345581901
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0016, Accuracy: 8962/8968 (99.9331%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0027, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0005, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.700330280989675.
Norm before scaling: 16.799194062292933. Distance: 1.2354992925193424
Total norm for 4 adversaries is: 16.799194062292933. distance: 1.2354992925193424
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0011, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.700330280989675.
Norm before scaling: 16.75711318470924. Distance: 1.093926660712099
Total norm for 4 adversaries is: 16.75711318470924. distance: 1.093926660712099
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0003, Accuracy: 8967/8968 (99.9888%)
___Train Local_Simple,  epoch  19, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 374/377 (99.2042%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1222, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  19, local model 97, internal_epoch   1,  Average loss: 0.0013, Accuracy: 474/487 (97.3306%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1968, Accuracy: 9345/10000 (93.4500%)
___Train Local_Simple,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1654, Accuracy: 9499/10000 (94.9900%)
___Train Local_Simple,  epoch  19, local model 44, internal_epoch   1,  Average loss: 0.0020, Accuracy: 496/517 (95.9381%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1794, Accuracy: 9418/10000 (94.1800%)
___Train Local_Simple,  epoch  19, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1453, Accuracy: 9568/10000 (95.6800%)
___Train Local_Simple,  epoch  19, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 524/530 (98.8679%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1629, Accuracy: 9507/10000 (95.0700%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2609, Accuracy: 9141/10000 (91.4100%)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 488/501 (97.4052%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1091, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 607/633 (95.8926%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2622, Accuracy: 9172/10000 (91.7200%)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0014, Accuracy: 893/915 (97.5956%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1048, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 596/615 (96.9106%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1677, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 888/923 (96.2080%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2161, Accuracy: 9382/10000 (93.8200%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1383, Accuracy: 9529/10000 (95.2900%)
___Train Local_Simple,  epoch  19, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1447, Accuracy: 9555/10000 (95.5500%)
___Train Local_Simple,  epoch  19, local model 86, internal_epoch   1,  Average loss: 0.0017, Accuracy: 240/250 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1006, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  19, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1574, Accuracy: 9525/10000 (95.2500%)
time spent on training: 325.81252217292786
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0845, Accuracy: 9760/10000 (97.6000%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.0463, Accuracy: 8833/8968 (98.4946%)
saving model
Done in 336.29974460601807 sec.
Server Epoch:20 choose agents : [74, 51, 41, 73, 43, 33, 12, 97, 15, 42, 20, 90, 56, 54, 24, 38, 32, 62, 8, 35].
___adversary_clean___Train Local_Simple,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 546/557 (98.0251%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 559/568 (98.4155%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 590/606 (97.3597%)
___adversary_clean___Train Local_Simple,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 583/591 (98.6464%)
poison local model 74 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0007, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.74306333015958.
Norm before scaling: 16.911853023991135. Distance: 1.6697011344420096
Total norm for 4 adversaries is: 16.911853023991135. distance: 1.6697011344420096
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0006, Accuracy: 8967/8968 (99.9888%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0013, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.74306333015958.
Norm before scaling: 16.827625377042303. Distance: 1.141246103988298
Total norm for 4 adversaries is: 16.827625377042303. distance: 1.141246103988298
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0018, Accuracy: 8962/8968 (99.9331%)
poison local model 41 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0020, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0009, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.74306333015958.
Norm before scaling: 16.87063022126026. Distance: 1.4774979953139078
Total norm for 4 adversaries is: 16.87063022126026. distance: 1.4774979953139078
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0020, Accuracy: 8961/8968 (99.9219%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0017, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.74306333015958.
Norm before scaling: 16.751606878380727. Distance: 1.109374408990407
Total norm for 4 adversaries is: 16.751606878380727. distance: 1.109374408990407
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 402/408 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3106, Accuracy: 9047/10000 (90.4700%)
___Train Local_Simple,  epoch  20, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 601/623 (96.4687%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2230, Accuracy: 9224/10000 (92.2400%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1126/1160 (97.0690%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2358, Accuracy: 9324/10000 (93.2400%)
___Train Local_Simple,  epoch  20, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 480/487 (98.5626%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1431, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch  20, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 391/401 (97.5062%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1332, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0015, Accuracy: 228/236 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1417, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  20, local model 20, internal_epoch   1,  Average loss: 0.0016, Accuracy: 415/429 (96.7366%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1965, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch  20, local model 90, internal_epoch   1,  Average loss: 0.0017, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3521, Accuracy: 8835/10000 (88.3500%)
___Train Local_Simple,  epoch  20, local model 56, internal_epoch   1,  Average loss: 0.0013, Accuracy: 858/880 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1232, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch  20, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 506/519 (97.4952%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1907, Accuracy: 9370/10000 (93.7000%)
___Train Local_Simple,  epoch  20, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 370/379 (97.6253%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1464, Accuracy: 9540/10000 (95.4000%)
___Train Local_Simple,  epoch  20, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 870/895 (97.2067%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5891, Accuracy: 8383/10000 (83.8300%)
___Train Local_Simple,  epoch  20, local model 32, internal_epoch   1,  Average loss: 0.0019, Accuracy: 939/977 (96.1105%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3282, Accuracy: 8954/10000 (89.5400%)
___Train Local_Simple,  epoch  20, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 417/423 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1538, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 613/633 (96.8404%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1326, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2052, Accuracy: 9354/10000 (93.5400%)
time spent on training: 327.2841215133667
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0783, Accuracy: 9761/10000 (97.6100%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.0167, Accuracy: 8921/8968 (99.4759%)
saving model
Done in 337.8507890701294 sec.
Server Epoch:21 choose agents : [41, 74, 73, 51, 80, 63, 58, 26, 90, 89, 93, 79, 36, 67, 87, 65, 30, 98, 25, 54].
___adversary_clean___Train Local_Simple,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0010, ___adversary_clean___Accuracy: 597/606 (98.5149%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 548/557 (98.3842%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 583/591 (98.6464%)
___adversary_clean___Train Local_Simple,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 559/568 (98.4155%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 557/606 (91.9142%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0010, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.759863838607757.
Norm before scaling: 16.954632529458856. Distance: 1.8779375588921097
Total norm for 4 adversaries is: 16.954632529458856. distance: 1.8779375588921097
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0063, Accuracy: 8946/8968 (99.7547%)
poison local model 74 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.759863838607757.
Norm before scaling: 16.823324016288556. Distance: 1.1165722840310468
Total norm for 4 adversaries is: 16.823324016288556. distance: 1.1165722840310468
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0013, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.759863838607757.
Norm before scaling: 16.79055749654912. Distance: 1.0148645928924402
Total norm for 4 adversaries is: 16.79055749654912. distance: 1.0148645928924402
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.759863838607757.
Norm before scaling: 16.736193076425902. Distance: 0.7442836273638455
Total norm for 4 adversaries is: 16.736193076425902. distance: 0.7442836273638455
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  21, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2458, Accuracy: 9219/10000 (92.1900%)
___Train Local_Simple,  epoch  21, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 866/889 (97.4128%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0866, Accuracy: 9749/10000 (97.4900%)
___Train Local_Simple,  epoch  21, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1086, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch  21, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/554 (97.2924%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1343, Accuracy: 9597/10000 (95.9700%)
___Train Local_Simple,  epoch  21, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 663/683 (97.0717%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2574, Accuracy: 9140/10000 (91.4000%)
___Train Local_Simple,  epoch  21, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 487/492 (98.9837%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1352, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1486, Accuracy: 9546/10000 (95.4600%)
___Train Local_Simple,  epoch  21, local model 79, internal_epoch   1,  Average loss: 0.0020, Accuracy: 175/182 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0880, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 991/1005 (98.6070%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6230, Accuracy: 8358/10000 (83.5800%)
___Train Local_Simple,  epoch  21, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 971/998 (97.2946%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2621, Accuracy: 9212/10000 (92.1200%)
___Train Local_Simple,  epoch  21, local model 87, internal_epoch   1,  Average loss: 0.0010, Accuracy: 462/470 (98.2979%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1307, Accuracy: 9600/10000 (96.0000%)
___Train Local_Simple,  epoch  21, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 363/371 (97.8437%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1294, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  21, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 387/400 (96.7500%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1779, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  21, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 796/818 (97.3105%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3295, Accuracy: 8938/10000 (89.3800%)
___Train Local_Simple,  epoch  21, local model 25, internal_epoch   1,  Average loss: 0.0014, Accuracy: 630/647 (97.3725%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3840, Accuracy: 8775/10000 (87.7500%)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0016, Accuracy: 502/519 (96.7245%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2781, Accuracy: 9073/10000 (90.7300%)
time spent on training: 333.4715874195099
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0744, Accuracy: 9781/10000 (97.8100%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.0107, Accuracy: 8932/8968 (99.5986%)
saving model
Done in 343.91246724128723 sec.
Server Epoch:22 choose agents : [73, 41, 74, 51, 6, 35, 17, 20, 77, 44, 8, 78, 3, 39, 14, 32, 4, 30, 65, 23].
___adversary_clean___Train Local_Simple,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0013, ___adversary_clean___Accuracy: 585/591 (98.9848%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 599/606 (98.8449%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0009, ___adversary_clean___Accuracy: 548/557 (98.3842%)
___adversary_clean___Train Local_Simple,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 560/568 (98.5915%)
poison local model 73 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0023, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0008, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.763931174630084.
Norm before scaling: 17.187879079626416. Distance: 2.7248052929952826
Total norm for 4 adversaries is: 17.187879079626416. distance: 2.7248052929952826
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.763931174630084.
Norm before scaling: 16.790570219352755. Distance: 0.8982368245123352
Total norm for 4 adversaries is: 16.790570219352755. distance: 0.8982368245123352
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0002, Accuracy: 8967/8968 (99.9888%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0012, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.763931174630084.
Norm before scaling: 16.780939933995334. Distance: 0.8454273998982336
Total norm for 4 adversaries is: 16.780939933995334. distance: 0.8454273998982336
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0005, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.763931174630084.
Norm before scaling: 16.737926174034282. Distance: 0.6132995699922207
Total norm for 4 adversaries is: 16.737926174034282. distance: 0.6132995699922207
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2292, Accuracy: 9263/10000 (92.6300%)
___Train Local_Simple,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 490/499 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1212, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 602/620 (97.0968%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1503, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  22, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 420/429 (97.9021%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2432, Accuracy: 9206/10000 (92.0600%)
___Train Local_Simple,  epoch  22, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1735, Accuracy: 9406/10000 (94.0600%)
___Train Local_Simple,  epoch  22, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 500/517 (96.7118%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1415, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 615/633 (97.1564%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1257, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  22, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1412, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0014, Accuracy: 897/923 (97.1831%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1408, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  22, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 251/257 (97.6654%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0978, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 368/376 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1093, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0020, Accuracy: 938/977 (96.0082%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1935, Accuracy: 9368/10000 (93.6800%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 641/658 (97.4164%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1363, Accuracy: 9571/10000 (95.7100%)
___Train Local_Simple,  epoch  22, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 393/400 (98.2500%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1401, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0848, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  22, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1230, Accuracy: 9578/10000 (95.7800%)
time spent on training: 329.0260057449341
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0707, Accuracy: 9799/10000 (97.9900%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.0030, Accuracy: 8956/8968 (99.8662%)
saving model
Done in 339.61896324157715 sec.
Server Epoch:23 choose agents : [41, 51, 74, 73, 43, 25, 17, 37, 46, 56, 30, 0, 33, 53, 65, 6, 24, 86, 35, 84].
___adversary_clean___Train Local_Simple,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0014, ___adversary_clean___Accuracy: 595/606 (98.1848%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 561/568 (98.7676%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 548/557 (98.3842%)
___adversary_clean___Train Local_Simple,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 584/591 (98.8156%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.777730732585866.
Norm before scaling: 16.835148980954624. Distance: 0.972279119340458
Total norm for 4 adversaries is: 16.835148980954624. distance: 0.972279119340458
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0005, Accuracy: 8966/8968 (99.9777%)
poison local model 51 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.777730732585866.
Norm before scaling: 16.7532136026383. Distance: 0.6302861068487766
Total norm for 4 adversaries is: 16.7532136026383. distance: 0.6302861068487766
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.777730732585866.
Norm before scaling: 16.773572134997625. Distance: 0.687264987485173
Total norm for 4 adversaries is: 16.773572134997625. distance: 0.687264987485173
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0008, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.777730732585866.
Norm before scaling: 16.757909928329834. Distance: 0.8085873737175943
Total norm for 4 adversaries is: 16.757909928329834. distance: 0.8085873737175943
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  23, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 404/408 (99.0196%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1475, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  23, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3478, Accuracy: 8888/10000 (88.8800%)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 603/620 (97.2581%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1114, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  23, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 842/860 (97.9070%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5036, Accuracy: 8541/10000 (85.4100%)
___Train Local_Simple,  epoch  23, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 692/710 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2108, Accuracy: 9332/10000 (93.3200%)
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 865/880 (98.2955%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1061, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch  23, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 391/400 (97.7500%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2403, Accuracy: 9299/10000 (92.9900%)
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 424/435 (97.4713%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1338, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  23, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1460, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  23, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 723/739 (97.8349%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2936, Accuracy: 9106/10000 (91.0600%)
___Train Local_Simple,  epoch  23, local model 65, internal_epoch   1,  Average loss: 0.0007, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1085, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 607/615 (98.6992%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1819, Accuracy: 9443/10000 (94.4300%)
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 369/379 (97.3615%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1002, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0860, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch  23, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/499 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1170, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch  23, local model 84, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1215/1246 (97.5120%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1765, Accuracy: 9454/10000 (94.5400%)
time spent on training: 345.3058485984802
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0691, Accuracy: 9797/10000 (97.9700%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.0009, Accuracy: 8965/8968 (99.9665%)
saving model
Done in 356.6132893562317 sec.
Server Epoch:24 choose agents : [51, 41, 74, 73, 76, 42, 25, 16, 95, 52, 59, 81, 77, 21, 10, 8, 40, 54, 46, 30].
___adversary_clean___Train Local_Simple,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 559/568 (98.4155%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0006, ___adversary_clean___Accuracy: 598/606 (98.6799%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0011, ___adversary_clean___Accuracy: 548/557 (98.3842%)
___adversary_clean___Train Local_Simple,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0007, ___adversary_clean___Accuracy: 585/591 (98.9848%)
poison local model 51 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.768606299468136.
Norm before scaling: 16.75871118656699. Distance: 0.6299714728360477
Total norm for 4 adversaries is: 16.75871118656699. distance: 0.6299714728360477
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 41 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.768606299468136.
Norm before scaling: 16.75282924158353. Distance: 0.5919682975235274
Total norm for 4 adversaries is: 16.75282924158353. distance: 0.5919682975235274
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.768606299468136.
Norm before scaling: 16.75184735032043. Distance: 0.5790403182531063
Total norm for 4 adversaries is: 16.75184735032043. distance: 0.5790403182531063
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.768606299468136.
Norm before scaling: 16.7278186196373. Distance: 0.738699416157022
Total norm for 4 adversaries is: 16.7278186196373. distance: 0.738699416157022
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  24, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0852, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch  24, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0755, Accuracy: 9766/10000 (97.6600%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0008, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2329, Accuracy: 9244/10000 (92.4400%)
___Train Local_Simple,  epoch  24, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 899/915 (98.2514%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0816, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5465, Accuracy: 8536/10000 (85.3600%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0944, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  24, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 742/760 (97.6316%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2638, Accuracy: 9122/10000 (91.2200%)
___Train Local_Simple,  epoch  24, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1216/1227 (99.1035%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3107, Accuracy: 9117/10000 (91.1700%)
___Train Local_Simple,  epoch  24, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1008, Accuracy: 9684/10000 (96.8400%)
___Train Local_Simple,  epoch  24, local model 21, internal_epoch   1,  Average loss: 0.0012, Accuracy: 305/312 (97.7564%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1226, Accuracy: 9591/10000 (95.9100%)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 853/892 (95.6278%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1913, Accuracy: 9390/10000 (93.9000%)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 620/633 (97.9463%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1920, Accuracy: 9375/10000 (93.7500%)
___Train Local_Simple,  epoch  24, local model 40, internal_epoch   1,  Average loss: 0.0008, Accuracy: 760/772 (98.4456%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1266, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  24, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2069, Accuracy: 9344/10000 (93.4400%)
___Train Local_Simple,  epoch  24, local model 46, internal_epoch   1,  Average loss: 0.0030, Accuracy: 686/710 (96.6197%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2845, Accuracy: 9082/10000 (90.8200%)
___Train Local_Simple,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 392/400 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1540, Accuracy: 9522/10000 (95.2200%)
time spent on training: 368.0952949523926
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0631, Accuracy: 9806/10000 (98.0600%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.0002, Accuracy: 8967/8968 (99.9888%)
saving model
Done in 379.1298909187317 sec.
Server Epoch:25 choose agents : [41, 73, 74, 51, 11, 24, 43, 4, 23, 25, 97, 91, 57, 72, 15, 94, 95, 90, 69, 20].
___adversary_clean___Train Local_Simple,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 597/606 (98.5149%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0005, ___adversary_clean___Accuracy: 585/591 (98.9848%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0008, ___adversary_clean___Accuracy: 548/557 (98.3842%)
___adversary_clean___Train Local_Simple,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0004, ___adversary_clean___Accuracy: 563/568 (99.1197%)
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.744911445754852.
Norm before scaling: 16.72978425301246. Distance: 0.617171492550091
Total norm for 4 adversaries is: 16.72978425301246. distance: 0.617171492550091
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.744911445754852.
Norm before scaling: 16.712409355471273. Distance: 0.5631858035845105
Total norm for 4 adversaries is: 16.712409355471273. distance: 0.5631858035845105
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.744911445754852.
Norm before scaling: 16.72766902137509. Distance: 0.6218256207131563
Total norm for 4 adversaries is: 16.72766902137509. distance: 0.6218256207131563
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.744911445754852.
Norm before scaling: 16.708951385304957. Distance: 0.6050272408571237
Total norm for 4 adversaries is: 16.708951385304957. distance: 0.6050272408571237
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 627/645 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2433, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch  25, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 368/379 (97.0976%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1229, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2339, Accuracy: 9253/10000 (92.5300%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 647/658 (98.3283%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2155, Accuracy: 9265/10000 (92.6500%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0998, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 633/647 (97.8362%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.5412, Accuracy: 7187/10000 (71.8700%)
___Train Local_Simple,  epoch  25, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 477/487 (97.9466%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1960, Accuracy: 9351/10000 (93.5100%)
___Train Local_Simple,  epoch  25, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0719, Accuracy: 9785/10000 (97.8500%)
___Train Local_Simple,  epoch  25, local model 57, internal_epoch   1,  Average loss: 0.0012, Accuracy: 334/343 (97.3761%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2102, Accuracy: 9315/10000 (93.1500%)
___Train Local_Simple,  epoch  25, local model 72, internal_epoch   1,  Average loss: 0.0009, Accuracy: 718/731 (98.2216%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3609, Accuracy: 8802/10000 (88.0200%)
___Train Local_Simple,  epoch  25, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 391/401 (97.5062%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1099, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  25, local model 94, internal_epoch   1,  Average loss: 0.0013, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1027, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch  25, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5283, Accuracy: 8244/10000 (82.4400%)
___Train Local_Simple,  epoch  25, local model 90, internal_epoch   1,  Average loss: 0.0014, Accuracy: 668/683 (97.8038%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2809, Accuracy: 9007/10000 (90.0700%)
___Train Local_Simple,  epoch  25, local model 69, internal_epoch   1,  Average loss: 0.0014, Accuracy: 248/256 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1313, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 423/429 (98.6014%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1720, Accuracy: 9459/10000 (94.5900%)
time spent on training: 362.2729523181915
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0583, Accuracy: 9817/10000 (98.1700%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
saving model
Saving model on epoch 25
Done in 372.8521020412445 sec.
Saving all the graphs.
This run has a label: Feb.17_23.19.14. Visdom environment: mnist_DBA
